<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Produce a genotype accumulation curve — genotype_curve • poppr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Produce a genotype accumulation curve — genotype_curve" />
<meta property="og:description" content="Genotype accumulation curves are useful for determining the minimum number of
loci necessary to discriminate between individuals in a population. This 
function will randomly sample loci without replacement and count the number 
of multilocus genotypes observed." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poppr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Produce a genotype accumulation curve</h1>
    <small class="dont-index">Source: <a href='https://github.com/grunwaldlab/poppr/blob/master/R/visualizations.r'><code>R/visualizations.r</code></a></small>
    <div class="hidden name"><code>genotype_curve.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Genotype accumulation curves are useful for determining the minimum number of
loci necessary to discriminate between individuals in a population. This 
function will randomly sample loci without replacement and count the number 
of multilocus genotypes observed.</p>
    </div>

    <pre class="usage"><span class='fu'>genotype_curve</span><span class='op'>(</span>
  <span class='va'>gen</span>,
  sample <span class='op'>=</span> <span class='fl'>100</span>,
  maxloci <span class='op'>=</span> <span class='fl'>0L</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  thresh <span class='op'>=</span> <span class='fl'>1</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  drop <span class='op'>=</span> <span class='cn'>TRUE</span>,
  dropna <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gen</th>
      <td><p>a <code><a href='genclone-class.html'>genclone</a></code>, <code>genind</code>, or
<code><a href='https://rdrr.io/pkg/pegas/man/read.loci.html'>loci</a></code> object.</p></td>
    </tr>
    <tr>
      <th>sample</th>
      <td><p>an <code>integer</code> defining the number of times loci will be 
resampled without replacement.</p></td>
    </tr>
    <tr>
      <th>maxloci</th>
      <td><p>the maximum number of loci to sample. By default, 
<code>maxloci = 0</code>, which indicates that n - 1 loci are to be used. Note 
that this will always take min(n - 1, maxloci)</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>if <code>FALSE</code> (default), Progress of the iterations will be 
displayed. If <code>TRUE</code>, nothing is printed to screen as the function 
runs.</p></td>
    </tr>
    <tr>
      <th>thresh</th>
      <td><p>a number from 0 to 1. This will draw a line at that fraction of
multilocus genotypes, rounded. Defaults to 1, which will draw a line at the
maximum number of observable genotypes.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>if <code>TRUE</code> (default), the genotype curve will be plotted via 
ggplot2. If <code>FALSE</code>, the resulting matrix will be visibly returned.</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p>if <code>TRUE</code> (default), monomorphic loci will be removed before
analysis as these loci affect the shape of the curve.</p></td>
    </tr>
    <tr>
      <th>dropna</th>
      <td><p>if <code>TRUE</code> (default) and <code>drop = TRUE</code>, NAs will be
ignored when determining if a locus is monomorphic. When <code>FALSE</code>,
presence of NAs will result in the locus being retained. This argument has
no effect when <code>drop = FALSE</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>(invisibly by deafuls) a matrix of integers showing the results of
  each randomization. Columns represent the number of loci sampled and rows 
  represent an independent sample.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Internally, this function works by converting the data into a 
  <code><a href='https://rdrr.io/pkg/pegas/man/read.loci.html'>loci</a></code> object, which represents genotypes as a data 
  frame of factors. Random samples are taken of 1 to n-1 columns of the 
  matrix and the number of unique rows are counted to determine the number of
  multilocus genotypes in that random sample. This function does not take 
  into account any definitions of MLGs via <code><a href='mlg.filter.html'>mlg.filter</a></code> or 
  <code><a href='mll.custom.html'>mll.custom</a></code>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Zhian N. Kamvar</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>nancycats</span><span class='op'>)</span>
<span class='va'>nan_geno</span> <span class='op'>&lt;-</span> <span class='fu'>genotype_curve</span><span class='op'>(</span><span class='va'>nancycats</span><span class='op'>)</span>
</div><div class='img'><img src='genotype_curve-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># \dontrun{</span>

<span class='co'># Marker Type Comparison --------------------------------------------------</span>
<span class='co'># With AFLP data, it is often necessary to include more markers for resolution</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Aeut</span><span class='op'>)</span>
<span class='va'>Ageno</span> <span class='op'>&lt;-</span> <span class='fu'>genotype_curve</span><span class='op'>(</span><span class='va'>Aeut</span><span class='op'>)</span>
</div><div class='img'><img src='genotype_curve-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Many microsatellite data sets have hypervariable markers</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>microbov</span><span class='op'>)</span>
<span class='va'>mgeno</span> <span class='op'>&lt;-</span> <span class='fu'>geotype_curve</span><span class='op'>(</span><span class='va'>microbov</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in geotype_curve(microbov): could not find function "geotype_curve"</span></div><div class='input'>
<span class='co'># Adding a trendline ------------------------------------------------------</span>

<span class='co'># Trendlines: you can add a smoothed trendline with geom_smooth()</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://ggplot2.tidyverse.org'>"ggplot2"</a></span><span class='op'>)</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/last_plot.html'>last_plot</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</span></div><div class='img'><img src='genotype_curve-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Producing Figures for Publication ---------------------------------------</span>

<span class='co'># This data set has been pre filtered</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span>
<span class='va'>mongeno</span> <span class='op'>&lt;-</span> <span class='fu'>genotype_curve</span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span>
</div><div class='img'><img src='genotype_curve-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Here, we add a curve and a title for publication</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/last_plot.html'>last_plot</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>mytitle</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Genotype Accumulation Curve for "</span>, 
                            <span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>italic</a></span><span class='op'>(</span><span class='st'>"M. fructicola"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span>, family <span class='op'>=</span> <span class='st'>"serif"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='va'>mytitle</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</span></div><div class='img'><img src='genotype_curve-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


