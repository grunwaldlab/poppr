<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform bootstrap statistics, calculate, and plot confidence intervals. — diversity_ci • poppr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform bootstrap statistics, calculate, and plot confidence intervals. — diversity_ci" />
<meta property="og:description" content="This function is for calculating bootstrap statistics and their confidence 
intervals. It is important to note that the calculation of confidence 
intervals is not perfect (See Details). Please be cautious when interpreting 
the results." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poppr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.9.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform bootstrap statistics, calculate, and plot confidence intervals.</h1>
    <small class="dont-index">Source: <a href='https://github.com/grunwaldlab/poppr/blob/master/R/bootstraping.R'><code>R/bootstraping.R</code></a></small>
    <div class="hidden name"><code>diversity_ci.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is for calculating bootstrap statistics and their confidence 
intervals. It is important to note that the calculation of confidence 
intervals is not perfect (See Details). Please be cautious when interpreting 
the results.</p>
    </div>

    <pre class="usage"><span class='fu'>diversity_ci</span><span class='op'>(</span>
  <span class='va'>tab</span>,
  n <span class='op'>=</span> <span class='fl'>1000</span>,
  n.boot <span class='op'>=</span> <span class='fl'>1L</span>,
  ci <span class='op'>=</span> <span class='fl'>95</span>,
  total <span class='op'>=</span> <span class='cn'>TRUE</span>,
  rarefy <span class='op'>=</span> <span class='cn'>FALSE</span>,
  n.rare <span class='op'>=</span> <span class='fl'>10</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  raw <span class='op'>=</span> <span class='cn'>TRUE</span>,
  center <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tab</th>
      <td><p>a [genind()], [genclone()],
[snpclone()], OR a matrix produced from 
[poppr::mlg.table()].</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>an integer defining the number of bootstrap replicates (defaults to 
1000).</p></td>
    </tr>
    <tr>
      <th>n.boot</th>
      <td><p>an integer specifying the number of samples to be drawn in each
bootstrap replicate. If `n.boot` &lt; 2 (default), the number of samples 
drawn for each bootstrap replicate will be equal to the number of samples
in the data set. See Details.</p></td>
    </tr>
    <tr>
      <th>ci</th>
      <td><p>the percent for confidence interval.</p></td>
    </tr>
    <tr>
      <th>total</th>
      <td><p>argument to be passed on to [poppr::mlg.table()] if 
`tab` is a genind object.</p></td>
    </tr>
    <tr>
      <th>rarefy</th>
      <td><p>if `TRUE`, bootstrapping will be performed on the smallest
population size or the value of `n.rare`, whichever is larger. 
Defaults to `FALSE`, indicating that bootstrapping will be performed 
respective to each population size.</p></td>
    </tr>
    <tr>
      <th>n.rare</th>
      <td><p>an integer specifying the smallest size at which to resample 
data. This is only used if `rarefy = TRUE`.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>If `TRUE` (default), boxplots will be produced for each 
population, grouped by statistic. Colored dots will indicate the observed 
value.This plot can be retrieved by using `p &lt;- last_plot()` from the 
<span class="pkg">ggplot2</span> package.</p></td>
    </tr>
    <tr>
      <th>raw</th>
      <td><p>if `TRUE` (default) a list containing three elements will be 
returned</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>if `TRUE` (default), the confidence interval will be 
centered around the observed statistic. Otherwise, if `FALSE`, the 
confidence interval will be bias-corrected normal CI as reported from 
[boot::boot.ci()]</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>parameters to be passed on to [boot::boot()] and 
[diversity_stats()]</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>raw = TRUE</h3>


<p>- **obs** a matrix with observed statistics in columns,
  populations in rows
   - **est** a matrix with estimated statistics in columns,
  populations in rows
   - **CI** an array of 3 dimensions giving the lower and upper
  bound, the index measured, and the population.
   - **boot** a list containing the output of
  [boot::boot()] for each population.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>raw = FALSE</h3>
<p>a data frame with the statistic observations,
estimates, and confidence intervals in columns, and populations in rows. Note
that the confidence intervals are converted to characters and rounded to
three decimal places.</p>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Bootstrapping</h3>
<p>For details on the bootstrapping procedures, see 
  [diversity_boot()]. Default bootstrapping is performed by 
  sampling <strong>N</strong> samples from a multinomial distribution weighted by the
  relative multilocus genotype abundance per population where <strong>N</strong> is
  equal to the number of samples in the data set. If <strong>n.boot</strong> &gt; 2,
  then <strong>n.boot</strong> samples are taken at each bootstrap replicate. When
  `rarefy = TRUE`, then samples are taken at the smallest population
  size without replacement. This will provide confidence intervals for all
  but the smallest population.</p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Confidence intervals</h3>
<p>Confidence intervals are derived from the function 
  [boot::norm.ci()]. This function will attempt to correct for bias
  between the observed value and the bootstrapped estimate. When `center
  = TRUE` (default), the confidence interval is calculated from the
  bootstrapped distribution and centered around the bias-corrected estimate
  as prescribed in Marcon (2012). This method can lead to undesirable
  properties, such as the confidence interval lying outside of the maximum
  possible value. For rarefaction, the confidence interval is simply
  determined by calculating the percentiles from the bootstrapped
  distribution. If you want to calculate your own confidence intervals, you
  can use the results of the permutations stored in the `$boot` element
  of the output.</p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Rarefaction</h3>
<p>Rarefaction in the sense of this function is simply sampling a subset of 
  the data at size **n.rare**. The estimates derived from this method
  have straightforward interpretations and allow you to compare diversity
  across populations since you are controlling for sample size.</p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Plotting</h3>
<p>Results are plotted as boxplots with point
  estimates. If there is no rarefaction applied, confidence intervals are
  displayed around the point estimates. The boxplots represent the actual
  values from the bootstrapping and will often appear below the estimates and
  confidence intervals.</p>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Confidence interval calculation</h3>
<p>Almost all of the statistics 
  supplied here have a maximum when all genotypes are equally represented. 
  This means that bootstrapping the samples will always be downwardly biased.
  In many cases, the confidence intervals from the bootstrapped distribution 
  will fall outside of the observed statistic. The reported confidence 
  intervals here are reported by assuming the variance of the bootstrapped 
  distribution is the same as the variance around the observed statistic. As
  different statistics have different properties, there will not always be
  one clear method for calculating confidence intervals. A suggestion for
  correction in Shannon's index is to center the CI around the observed
  statistic (Marcon, 2012), but there are theoretical limitations to this.
  For details, see &lt;http://stats.stackexchange.com/q/156235/49413&gt;.</p>

<p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>User-defined functions</h3>
<p>While it is possible to use custom functions with this, there are three
  important things to remember when using these functions:</p>  
<p>1. The function must return a single value. 
    2. The function must allow for both matrix and vector inputs 
    3. The function name cannot match or partially match any arguments 
    from [boot::boot()]</p>   
<p>Anonymous functions are okay <br />(e.g. `function(x)
  vegan::rarefy(t(as.matrix(x)), 10)`).</p>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition 
of Shannon’s Entropy and a Confidence Interval for Beta Diversity.
*Oikos* 121(4): 516-522.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>[diversity_boot()] [diversity_stats()]
  [poppr()] [boot::boot()] [boot::norm.ci()]
  [boot::boot.ci()]</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Zhian N. Kamvar</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://grunwaldlab.github.io/poppr/'>poppr</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Pinf</span><span class='op'>)</span>
<span class='fu'>diversity_ci</span><span class='op'>(</span><span class='va'>Pinf</span>, n <span class='op'>=</span> <span class='fl'>100L</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Confidence Intervals have been centered around observed statistic.</span>
#&gt; <span class='message'>Please see ?diversity_ci for details.</span></div><div class='img'><img src='diversity_ci-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; $obs
#&gt;                Index
#&gt; Pop                    H        G    lambda       E.5
#&gt;   South America 3.267944 23.29032 0.9570637 0.8825297
#&gt;   North America 3.687013 34.90909 0.9713542 0.8711297
#&gt;   Total         4.188215 57.78125 0.9826933 0.8748360
#&gt; 
#&gt; $est
#&gt;                Index
#&gt; Pop                    H        G    lambda       E.5
#&gt;   South America 2.810714 14.50911 0.9293629 0.8545902
#&gt;   North America 3.197910 21.22096 0.9521007 0.8553062
#&gt;   Total         3.723559 35.49926 0.9715603 0.8504923
#&gt; 
#&gt; $CI
#&gt; , , Pop = South America
#&gt; 
#&gt;         Index
#&gt; CI              H        G    lambda       E.5
#&gt;   2.5 %  3.015398 18.99547 0.9339777 0.7946645
#&gt;   97.5 % 3.520490 27.58517 0.9801498 0.9703949
#&gt; 
#&gt; , , Pop = North America
#&gt; 
#&gt;         Index
#&gt; CI              H        G    lambda       E.5
#&gt;   2.5 %  3.508988 29.77002 0.9587624 0.7726727
#&gt;   97.5 % 3.865038 40.04816 0.9839460 0.9695868
#&gt; 
#&gt; , , Pop = Total
#&gt; 
#&gt;         Index
#&gt; CI              H        G    lambda       E.5
#&gt;   2.5 %  4.053701 51.09567 0.9770752 0.7956329
#&gt;   97.5 % 4.322728 64.46683 0.9883115 0.9540391
#&gt; 
#&gt; 
#&gt; $boot
#&gt; $boot$`South America`
#&gt; 
#&gt; PARAMETRIC BOOTSTRAP
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", 
#&gt;     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;       original      bias    std. error
#&gt; t1*  3.2679442 -0.45723059  0.12885234
#&gt; t2* 23.2903226 -8.78121073  2.19128951
#&gt; t3*  0.9570637 -0.02770083  0.01177882
#&gt; t4*  0.8825297 -0.02793955  0.04483001
#&gt; 
#&gt; $boot$`North America`
#&gt; 
#&gt; PARAMETRIC BOOTSTRAP
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", 
#&gt;     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;       original       bias    std. error
#&gt; t1*  3.6870132  -0.48910283 0.090830659
#&gt; t2* 34.9090909 -13.68813373 2.622024383
#&gt; t3*  0.9713542  -0.01925347 0.006424512
#&gt; t4*  0.8711297  -0.01582350 0.050234108
#&gt; 
#&gt; $boot$Total
#&gt; 
#&gt; PARAMETRIC BOOTSTRAP
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", 
#&gt;     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;       original       bias    std. error
#&gt; t1*  4.1882146  -0.46465576 0.068630576
#&gt; t2* 57.7812500 -22.28198749 3.411071183
#&gt; t3*  0.9826933  -0.01113304 0.002866475
#&gt; t4*  0.8748360  -0.02434370 0.040410486
#&gt; 
#&gt; </div><div class='input'><span class='co'># \dontrun{</span>
<span class='co'># With pretty results</span>
<span class='fu'>diversity_ci</span><span class='op'>(</span><span class='va'>Pinf</span>, n <span class='op'>=</span> <span class='fl'>100L</span>, raw <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Confidence Intervals have been centered around observed statistic.</span>
#&gt; <span class='message'>Please see ?diversity_ci for details.</span></div><div class='img'><img src='diversity_ci-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;                  H H.est           H.ci    G G.est             G.ci lambda
#&gt; South America 3.27  2.84 (3.065, 3.471) 23.3  14.8 (19.394, 27.186)  0.957
#&gt; North America 3.69  3.18 (3.492, 3.882) 34.9  20.9  (29.778, 40.04)  0.971
#&gt; Total         4.19  3.71 (4.024, 4.353) 57.8  35.0 (49.827, 65.736)  0.983
#&gt;               lambda.est      lambda.ci   E.5 E.5.est         E.5.ci
#&gt; South America      0.931 (0.938, 0.976) 0.883   0.851 (0.787, 0.978)
#&gt; North America      0.951 (0.956, 0.986) 0.871   0.857 (0.781, 0.961)
#&gt; Total              0.971 (0.976, 0.989) 0.875   0.849 (0.794, 0.955)</div><div class='input'>
<span class='co'># This can be done in a parallel fasion (OSX uses "multicore", Windows uses "snow")</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='fu'>diversity_ci</span><span class='op'>(</span><span class='va'>Pinf</span>, <span class='fl'>10000L</span>, parallel <span class='op'>=</span> <span class='st'>"multicore"</span>, ncpus <span class='op'>=</span> <span class='fl'>4L</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Confidence Intervals have been centered around observed statistic.</span>
#&gt; <span class='message'>Please see ?diversity_ci for details.</span></div><div class='img'><img src='diversity_ci-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   8.048   2.562   6.821 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='fu'>diversity_ci</span><span class='op'>(</span><span class='va'>Pinf</span>, <span class='fl'>10000L</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Confidence Intervals have been centered around observed statistic.</span>
#&gt; <span class='message'>Please see ?diversity_ci for details.</span></div><div class='img'><img src='diversity_ci-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   6.286   0.222   6.906 </div><div class='input'>
<span class='co'># We often get many requests for a clonal fraction statistic. As this is </span>
<span class='co'># simply the number of observed MLGs over the number of samples, we </span>
<span class='co'># recommended that people calculate it themselves. With this function, you</span>
<span class='co'># can add it in:</span>

<span class='va'>CF</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span>
 <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/drop.html'>drop</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
 <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span>
   <span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
 <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
   <span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
 <span class='op'>}</span>
 <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Show pretty results</span>

<span class='fu'>diversity_ci</span><span class='op'>(</span><span class='va'>Pinf</span>, <span class='fl'>1000L</span>, CF <span class='op'>=</span> <span class='va'>CF</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, raw <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Confidence Intervals have been centered around observed statistic.</span>
#&gt; <span class='message'>Please see ?diversity_ci for details.</span></div><div class='img'><img src='diversity_ci-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;                  H H.est           H.ci    G G.est             G.ci lambda
#&gt; South America 3.27  2.84 (3.043, 3.493) 23.3  15.0 (19.182, 27.399)  0.957
#&gt; North America 3.69  3.18  (3.49, 3.884) 34.9  20.9  (29.449, 40.37)  0.971
#&gt; Total         4.19  3.71 (4.039, 4.337) 57.8  35.2 (50.814, 64.748)  0.983
#&gt;               lambda.est      lambda.ci   E.5 E.5.est         E.5.ci    CF
#&gt; South America      0.932 (0.937, 0.977) 0.883   0.856 (0.792, 0.973) 0.763
#&gt; North America      0.951 (0.958, 0.985) 0.871   0.852 (0.777, 0.965) 0.896
#&gt; Total              0.971 (0.977, 0.989) 0.875   0.850 (0.804, 0.945) 0.837
#&gt;               CF.est          CF.ci
#&gt; South America  0.528 (0.665, 0.862)
#&gt; North America  0.583 (0.808, 0.984)
#&gt; Total          0.558 (0.771, 0.903)</div><div class='input'><span class='fu'>diversity_ci</span><span class='op'>(</span><span class='va'>Pinf</span>, <span class='fl'>1000L</span>, CF <span class='op'>=</span> <span class='va'>CF</span>, rarefy <span class='op'>=</span> <span class='cn'>TRUE</span>, raw <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Samples for rarefaction: 38</span></div><div class='img'><img src='diversity_ci-6.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;                  H H.est           H.ci    G G.est             G.ci lambda
#&gt; South America 3.27  3.27           &lt;NA&gt; 23.3  23.3             &lt;NA&gt;  0.957
#&gt; North America 3.69  3.48 (3.405, 3.565) 34.9  29.5 (25.786, 34.381)  0.971
#&gt; Total         4.19  3.50 (3.355, 3.601) 57.8  31.5   (25.786, 36.1)  0.983
#&gt;               lambda.est      lambda.ci   E.5 E.5.est         E.5.ci    CF
#&gt; South America      0.957           &lt;NA&gt; 0.883   0.883           &lt;NA&gt; 0.763
#&gt; North America      0.966 (0.961, 0.971) 0.871   0.904 (0.851, 0.972) 0.896
#&gt; Total              0.968 (0.961, 0.972) 0.875   0.944 (0.873, 0.985) 0.837
#&gt;               CF.est          CF.ci
#&gt; South America  0.763           &lt;NA&gt;
#&gt; North America  0.906 (0.868, 0.947)
#&gt; Total          0.909 (0.816, 0.974)</div><div class='input'><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


