<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate a dendrogram with bootstrap support using any distance applicable 
to genind or genclone objects. — aboot • poppr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Calculate a dendrogram with bootstrap support using any distance applicable 
to genind or genclone objects. — aboot" />

<meta property="og:description" content="Calculate a dendrogram with bootstrap support using any distance applicable 
to genind or genclone objects." />
<meta name="twitter:card" content="summary" />
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">poppr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate a dendrogram with bootstrap support using any distance applicable 
to genind or genclone objects.</h1>
    <small>Source: <a href='https:/github.com/grunwaldlab/poppr/blob/master/R/bootstraping.R'><code>R/bootstraping.R</code></a></small>
    </div>

    
    <p>Calculate a dendrogram with bootstrap support using any distance applicable 
to genind or genclone objects.</p>
    

    <pre class="usage"><span class='fu'>aboot</span>(<span class='no'>x</span>, <span class='kw'>strata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='st'>"upgma"</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='st'>"nei.dist"</span>,
  <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>cutoff</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>showtree</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>missing</span> <span class='kw'>=</span> <span class='st'>"mean"</span>,
  <span class='kw'>mcutoff</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>root</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a genind, genpop,
<a href='genclone-class.html'>genclone</a>, genlight, <a href='genclone-class.html'>snpclone</a> or
matrix, object.</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>a formula specifying the strata to be used to convert x to a
genclone object if x is a genind object. Defaults to NULL. See details.</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>a text string or function that can calculate a tree from a 
distance matrix. Defaults to "upgma". Note that you must load the package 
with the function for it to work.</p></td>
    </tr>
    <tr>
      <th>distance</th>
      <td><p>a character or function defining the distance to be applied 
to x. Defaults to <code><a href='genetic_distance.html'>nei.dist</a></code>.</p></td>
    </tr>
    <tr>
      <th>sample</th>
      <td><p>An integer representing the number of bootstrap replicates 
Default is 100.</p></td>
    </tr>
    <tr>
      <th>cutoff</th>
      <td><p>An integer from 0 to 100 setting the cutoff value to return the
bootstrap values on the nodes. Default is 0.</p></td>
    </tr>
    <tr>
      <th>showtree</th>
      <td><p>If <code>TRUE</code> (Default), a dendrogram will be plotted. If 
<code>FALSE</code>, nothing will be plotted.</p></td>
    </tr>
    <tr>
      <th>missing</th>
      <td><p>any method to be used by <code><a href='missingno.html'>missingno</a></code>: "mean" 
(default), "zero", "loci", "genotype", or "ignore".</p></td>
    </tr>
    <tr>
      <th>mcutoff</th>
      <td><p>a value between 0 (default) and 1 defining the percentage of 
tolerable missing data if the <code>missing</code> parameter is set to "loci" or 
"genotype". This should only be set if the distance metric can handle 
missing data.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>if <code>FALSE</code> (default), a progress bar will be printed to 
screen.</p></td>
    </tr>
    <tr>
      <th>root</th>
      <td><p>is the tree rooted? This is a parameter passed off to 
<code><a href='http://www.rdocumentation.org/packages/ape/topics/boot.phylo'>boot.phylo</a></code>. If the <code>tree</code> parameter returns a 
rooted tree (like UPGMA), this should be <code>TRUE</code>, otherwise (like 
neighbor-joining), it should be false. When set to <code>NULL</code> (default), 
the tree is considered rooted if <code><a href='http://www.rdocumentation.org/packages/ape/topics/is.ultrametric'>is.ultrametric</a></code> is true.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>any parameters to be passed off to the distance method.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code><a href='http://www.rdocumentation.org/packages/ape/topics/read.tree'>phylo</a></code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function utilizes an internal class called 
  <code><a href='bootgen-class.html'>bootgen</a></code> that allows bootstrapping of objects that 
  inherit the genind class. This is necessary due to the fact that columns in
  the genind matrix are defined as alleles and are thus interrelated. This 
  function will specifically bootstrap loci so that results are biologically 
  relevant. With this function, the user can also define a custom distance to
  be performed on the genind or genclone object.</p>  
<p></p><h3>the strata argument</h3>
    There is an argument called <code>strata</code>. This argument is useful for when
  you want to bootstrap by populations from a <code><a href='http://www.rdocumentation.org/packages/adegenet/topics/new.genind'>genind</a></code>
  object. When you specify strata, the genind object will be converted to
  <code><a href='http://www.rdocumentation.org/packages/adegenet/topics/new.genpop'>genpop</a></code> with the specified strata.
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code><a href='genetic_distance.html'>prevosti.dist</a></code> and <code><a href='diss.dist.html'>diss.dist</a></code> are exactly the
  same, but <code><a href='diss.dist.html'>diss.dist</a></code> scales better for large numbers of 
  individuals (n &gt; 125) at the cost of required memory.</p><h3>missing 
  data</h3>
Missing data is not allowed by many of the distances. Thus, one of 
  the first steps of this function is to treat missing data by setting it to 
  the average allele frequency in the data set. If you are using a distance 
  that can handle missing data (Prevosti's distance), you can set 
  <code>missing = "ignore"</code> to allow the distance function to handle any 
  missing data. See <code><a href='missingno.html'>missingno</a></code> for details on missing 
  data.<h3>Bruvo's Distance</h3>
While calculation of Bruvo's distance 
  is possible with this function, it is optimized in the function 
  <code><a href='bruvo.boot.html'>bruvo.boot</a></code>.
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='genetic_distance.html'>nei.dist</a></code> <code><a href='genetic_distance.html'>edwards.dist</a></code> 
  <code><a href='genetic_distance.html'>rogers.dist</a></code> <code><a href='genetic_distance.html'>reynolds.dist</a></code> 
  <code><a href='genetic_distance.html'>prevosti.dist</a></code> <code><a href='diss.dist.html'>diss.dist</a></code> 
  <code><a href='bruvo.boot.html'>bruvo.boot</a></code> <code><a href='http://www.rdocumentation.org/packages/ape/topics/boot.phylo'>boot.phylo</a></code> 
  <code><a href='http://www.rdocumentation.org/packages/adegenet/topics/dist.genpop'>dist.genpop</a></code> <code>dist</code>
  <code><a href='coercion-methods.html'>bootgen2genind</a></code> <code><a href='bootgen-class.html'>bootgen</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>data</span>(<span class='no'>nancycats</span>)
<span class='no'>nan9</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='popsub.html'>popsub</a></span>(<span class='no'>nancycats</span>, <span class='fl'>9</span>)

<span class='fu'>set.seed</span>(<span class='fl'>9999</span>)
<span class='co'># Generate a tree using nei's distance</span>
<span class='no'>neinan</span> <span class='kw'>&lt;-</span> <span class='fu'>aboot</span>(<span class='no'>nan9</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='no'>nei.dist</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Infinite values detected.</span></div><div class='output co'>#&gt; Running bootstraps:       100 / 100
#&gt; Calculating bootstrap values... done.</div><div class='img'><img src='aboot-1.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='fu'>set.seed</span>(<span class='fl'>9999</span>)
<span class='co'># Generate a tree using custom distance</span>
<span class='no'>bindist</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>dist</span>(<span class='fu'>tab</span>(<span class='no'>x</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"binary"</span>)
<span class='no'>binnan</span> <span class='kw'>&lt;-</span> <span class='fu'>aboot</span>(<span class='no'>nan9</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='no'>bindist</span>)</div><div class='output co'>#&gt; Running bootstraps:       100 / 100
#&gt; Calculating bootstrap values... done.</div><div class='img'><img src='aboot-2.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># Distances from other packages.</span>
<span class='co'>#</span>
<span class='co'># Sometimes, distance functions from other packages will have the constraint</span>
<span class='co'># that the incoming data MUST be genind. Internally, aboot uses the </span>
<span class='co'># bootgen class ( class?bootgen ) to shuffle loci, and will throw an error</span>
<span class='co'># The function bootgen2genind helps fix that. Here's an example of a function</span>
<span class='co'># that expects a genind class from above</span>
<span class='no'>bindist</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>){
  <span class='fu'>stopifnot</span>(<span class='fu'>is.genind</span>(<span class='no'>x</span>))
  <span class='fu'>dist</span>(<span class='fu'>tab</span>(<span class='no'>x</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"binary"</span>)
}
<span class='co'>#</span>
<span class='co'># Fails:</span>
<span class='co'># aboot(nan9, dist = bindist)</span>
<span class='co'>## Error: is.genind(x) is not TRUE</span>
<span class='co'>#</span>
<span class='co'># Add bootgen2genind to get it working!</span>
<span class='co'># Works:</span>
<span class='fu'>aboot</span>(<span class='no'>nan9</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='coercion-methods.html'>bootgen2genind</a></span>(<span class='no'>x</span>) <span class='kw'>%&gt;%</span> <span class='no'>bindist</span>)

<span class='co'># AFLP data</span>
<span class='fu'>data</span>(<span class='no'>Aeut</span>)

<span class='co'># Nei's distance</span>
<span class='no'>anei</span> <span class='kw'>&lt;-</span> <span class='fu'>aboot</span>(<span class='no'>Aeut</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='no'>nei.dist</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>cutoff</span> <span class='kw'>=</span> <span class='fl'>50</span>)

<span class='co'># Rogers' distance</span>
<span class='no'>arog</span> <span class='kw'>&lt;-</span> <span class='fu'>aboot</span>(<span class='no'>Aeut</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='no'>rogers.dist</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>cutoff</span> <span class='kw'>=</span> <span class='fl'>50</span>)

<span class='co'># This can also be run on genpop objects</span>
<span class='fu'>strata</span>(<span class='no'>Aeut</span>) <span class='kw'>&lt;-</span> <span class='fu'>other</span>(<span class='no'>Aeut</span>)$<span class='no'>population_hierarchy</span>[-<span class='fl'>1</span>]
<span class='no'>Aeut.gc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='coercion-methods.html'>as.genclone</a></span>(<span class='no'>Aeut</span>)
<span class='fu'>setPop</span>(<span class='no'>Aeut.gc</span>) <span class='kw'>&lt;-</span> ~<span class='no'>Pop</span>/<span class='no'>Subpop</span>
<span class='no'>Aeut.pop</span> <span class='kw'>&lt;-</span> <span class='fu'>genind2genpop</span>(<span class='no'>Aeut.gc</span>)
<span class='fu'>set.seed</span>(<span class='fl'>5000</span>)
<span class='fu'>aboot</span>(<span class='no'>Aeut.pop</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>1000</span>) <span class='co'># compare to Grunwald et al. 2006</span>

<span class='co'># You can also use the strata argument to convert to genpop inside the function.</span>
<span class='fu'>set.seed</span>(<span class='fl'>5000</span>)
<span class='fu'>aboot</span>(<span class='no'>Aeut.gc</span>, <span class='kw'>strata</span> <span class='kw'>=</span> ~<span class='no'>Pop</span>/<span class='no'>Subpop</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>1000</span>)

<span class='co'># And genlight objects </span>
<span class='co'># From glSim:</span>
<span class='co'>## 1,000 non structured SNPs, 100 structured SNPs</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>glSim</span>(<span class='fl'>100</span>, <span class='fl'>1e3</span>, <span class='kw'>n.snp.struc</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>ploid</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='fu'>aboot</span>(<span class='no'>x</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='no'>bitwise.dist</span>)

<span class='co'># Utilizing other tree methods</span>

<span class='fu'>library</span>(<span class='st'>"ape"</span>)

<span class='fu'>aboot</span>(<span class='no'>Aeut.pop</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='no'>fastme.bal</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>1000</span>)

<span class='co'># Utilizing options in other tree methods</span>

<span class='no'>myFastME</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='http://www.rdocumentation.org/packages/ape/topics/fastme'>fastme.bal</a></span>(<span class='no'>x</span>, <span class='kw'>nni</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>spr</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>tbr</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>aboot</span>(<span class='no'>Aeut.pop</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='no'>myFastME</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>1000</span>)

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

