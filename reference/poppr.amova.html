<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform Analysis of Molecular Variance (AMOVA) on genind or genclone objects. — poppr.amova • poppr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform Analysis of Molecular Variance (AMOVA) on genind or genclone objects. — poppr.amova" />
<meta property="og:description" content="This function simplifies the process necessary for performing AMOVA in R. It
gives user the choice of utilizing either the ade4 or the pegas
implementation of AMOVA. See ade4::amova() (ade4) and pegas::amova()
(pegas) for details on the specific implementation." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poppr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.9.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform Analysis of Molecular Variance (AMOVA) on genind or genclone objects.</h1>
    <small class="dont-index">Source: <a href='https://github.com/grunwaldlab/poppr/blob/master/R/amova.r'><code>R/amova.r</code></a></small>
    <div class="hidden name"><code>poppr.amova.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function simplifies the process necessary for performing AMOVA in R. It
gives user the choice of utilizing either the <span class="pkg">ade4</span> or the <span class="pkg">pegas</span>
implementation of AMOVA. See <code><a href='https://rdrr.io/pkg/ade4/man/amova.html'>ade4::amova()</a></code> (ade4) and <code><a href='https://rdrr.io/pkg/pegas/man/amova.html'>pegas::amova()</a></code>
(pegas) for details on the specific implementation.</p>
    </div>

    <pre class="usage"><span class='fu'>poppr.amova</span><span class='op'>(</span>
  <span class='va'>x</span>,
  hier <span class='op'>=</span> <span class='cn'>NULL</span>,
  clonecorrect <span class='op'>=</span> <span class='cn'>FALSE</span>,
  within <span class='op'>=</span> <span class='cn'>TRUE</span>,
  dist <span class='op'>=</span> <span class='cn'>NULL</span>,
  squared <span class='op'>=</span> <span class='cn'>TRUE</span>,
  freq <span class='op'>=</span> <span class='cn'>TRUE</span>,
  correction <span class='op'>=</span> <span class='st'>"quasieuclid"</span>,
  sep <span class='op'>=</span> <span class='st'>"_"</span>,
  filter <span class='op'>=</span> <span class='cn'>FALSE</span>,
  threshold <span class='op'>=</span> <span class='fl'>0</span>,
  algorithm <span class='op'>=</span> <span class='st'>"farthest_neighbor"</span>,
  threads <span class='op'>=</span> <span class='fl'>1L</span>,
  missing <span class='op'>=</span> <span class='st'>"loci"</span>,
  cutoff <span class='op'>=</span> <span class='fl'>0.05</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ade4"</span>, <span class='st'>"pegas"</span><span class='op'>)</span>,
  nperm <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a genind, <a href='genclone-class.html'>genclone</a>, genlight, or <a href='genclone-class.html'>snpclone</a> object</p></td>
    </tr>
    <tr>
      <th>hier</th>
      <td><p>a hierarchical <a href='https://rdrr.io/r/stats/formula.html'>formula</a> that defines your population
hierarchy. (e.g.: <code>~Population/Subpopulation</code>). <strong>See Details below</strong>.</p></td>
    </tr>
    <tr>
      <th>clonecorrect</th>
      <td><p><code>logical</code> if <code>TRUE</code>, the data set will be clone corrected
with respect to the lowest level of the hierarchy. The default is set to
<code>FALSE</code>. See <code><a href='clonecorrect.html'>clonecorrect()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>within</th>
      <td><p><code>logical</code>. When this is set to <code>TRUE</code> (Default), variance
within individuals are calculated as well. If this is set to <code>FALSE</code>, The
lowest level of the hierarchy will be the sample level. See Details below.</p></td>
    </tr>
    <tr>
      <th>dist</th>
      <td><p>an optional distance matrix calculated on your data. If this is
set to <code>NULL</code> (default), the raw pairwise distances will be calculated via
<code><a href='https://rdrr.io/r/stats/dist.html'>dist()</a></code>.</p></td>
    </tr>
    <tr>
      <th>squared</th>
      <td><p>if a distance matrix is supplied, this indicates whether or
not it represents squared distances.</p></td>
    </tr>
    <tr>
      <th>freq</th>
      <td><p><code>logical</code>. If <code>within = FALSE</code>, the parameter rho is calculated
(Ronfort et al. 1998; Meirmans and Liu 2018). By setting <code>freq = TRUE</code>,
(default) allele counts will be converted to frequencies before the
distance is calculated, otherwise, the distance will be calculated on
allele counts, which can bias results in mixed-ploidy data sets. Note that
this option has no effect for haploid or presence/absence data sets.</p></td>
    </tr>
    <tr>
      <th>correction</th>
      <td><p>a <code>character</code> defining the correction method for
non-euclidean distances. Options are <code><a href='https://rdrr.io/pkg/ade4/man/quasieuclid.html'>ade4::quasieuclid()</a></code> (Default),
<code><a href='https://rdrr.io/pkg/ade4/man/lingoes.html'>ade4::lingoes()</a></code>, and <code><a href='https://rdrr.io/pkg/ade4/man/cailliez.html'>ade4::cailliez()</a></code>. See Details below.</p></td>
    </tr>
    <tr>
      <th>sep</th>
      <td><p>Deprecated. As of poppr version 2, this argument serves no
purpose.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p><code>logical</code> When set to <code>TRUE</code>, mlg.filter will be run to
determine genotypes from the distance matrix. It defaults to <code>FALSE</code>. You
can set the parameters with <code>algorithm</code> and <code>threshold</code> arguments. Note
that this will not be performed when <code>within = TRUE</code>. Note that the
threshold should be the number of allowable substitutions if you don't
supply a distance matrix.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>a number indicating the minimum distance two MLGs must be
separated by to be considered different. Defaults to 0, which will reflect
the original (naive) MLG definition.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>determines the type of clustering to be done.</p><dl>
  <dt>"farthest_neighbor"</dt><dd><p><em> (default) </em>merges clusters based on the 
  maximum distance between points in either cluster. This is the strictest of
  the three.</p></dd>
  <dt>"nearest_neighbor"</dt><dd><p>merges clusters based on the minimum distance
  between points in either cluster. This is the loosest of the three.</p></dd>
  <dt>"average_neighbor"</dt><dd><p>merges clusters based on the average distance
  between every pair of points between clusters.</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>threads</th>
      <td><p><code>integer</code> When using filtering or genlight objects, this
parameter specifies the number of parallel processes passed to
<code><a href='mlg.filter.html'>mlg.filter()</a></code> and/or <code><a href='bitwise.dist.html'>bitwise.dist()</a></code>.</p></td>
    </tr>
    <tr>
      <th>missing</th>
      <td><p>specify method of correcting for missing data utilizing
options given in the function <code><a href='missingno.html'>missingno()</a></code>. Default is <code>"loci"</code>. This only
applies to genind or genclone objects.</p></td>
    </tr>
    <tr>
      <th>cutoff</th>
      <td><p>specify the level at which missing data should be
removed/modified. See <code><a href='missingno.html'>missingno()</a></code> for details. This only applies to
genind or genclone objects.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p><code>logical</code> If <code>FALSE</code> (Default), messages regarding any
corrections will be printed to the screen. If <code>TRUE</code>, no messages will be
printed.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Which method for calculating AMOVA should be used? Choices
refer to package implementations: "ade4" (default) or "pegas". See details
for differences.</p></td>
    </tr>
    <tr>
      <th>nperm</th>
      <td><p>the number of permutations passed to the pegas implementation of
amova.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of class <code>amova</code> from the ade4 or pegas package. See
<code><a href='https://rdrr.io/pkg/ade4/man/amova.html'>ade4::amova()</a></code> or <code><a href='https://rdrr.io/pkg/pegas/man/amova.html'>pegas::amova()</a></code> for details.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The poppr implementation of AMOVA is a very detailed wrapper for the
ade4 implementation. The output is an <code><a href='https://rdrr.io/pkg/ade4/man/amova.html'>ade4::amova()</a></code> class list that
contains the results in the first four elements. The inputs are contained
in the last three elements. The inputs required for the ade4 implementation
are:</p><ol>
<li><p>a distance matrix on all unique genotypes (haplotypes)</p></li>
<li><p>a data frame defining the hierarchy of the distance matrix</p></li>
<li><p>a genotype (haplotype) frequency table.</p></li>
</ol>

<p>All of this data can be constructed from a genind or
genlight object, but can be daunting for a novice R user.
<em>This function automates the entire process</em>. Since there are many
variables regarding genetic data, some points need to be highlighted:</p>
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>On Hierarchies:</h3>
<p>The hierarchy is defined by different
population strata that separate your data hierarchically. These strata are
defined in the <strong>strata</strong> slot of genind,
genlight, <a href='genclone-class.html'>genclone</a>, and
<a href='genclone-class.html'>snpclone</a> objects. They are useful for defining the
population factor for your data. See the function <code>strata()</code> for details on
how to properly define these strata.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>On Within Individual Variance:</h3>
<p>Heterozygosities within
genotypes are sources of variation from within individuals and can be
quantified in AMOVA. When <code>within = TRUE</code>, poppr will split genotypes into
haplotypes with the function <code><a href='make_haplotypes.html'>make_haplotypes()</a></code> and use those to calculate
within-individual variance. No estimation of phase is made. This acts much
like the default settings for AMOVA in the Arlequin software package.
Within individual variance will not be calculated for haploid individuals
or dominant markers as the haplotypes cannot be split further. Setting
<code>within = FALSE</code> uses the euclidean distance of the allele frequencies
within each individual. <strong>Note:</strong> <code>within = TRUE</code> is incompatible with
<code>filter = TRUE</code>. In this case, <code>within</code> will be set to <code>FALSE</code></p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>On Euclidean Distances:</h3>
<p>With the <span class="pkg">ade4</span> implementation of
AMOVA (utilized by <span class="pkg">poppr</span>), distances must be Euclidean (due to the
nature of the calculations). Unfortunately, many genetic distance measures
are not always euclidean and must be corrected for before being analyzed.
Poppr automates this with three methods implemented in <span class="pkg">ade4</span>,
<code>quasieuclid()</code>, <code>lingoes()</code>, and <code>cailliez()</code>. The correction of these
distances should not adversely affect the outcome of the analysis.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>On Filtering:</h3>
<p>Filtering multilocus genotypes is performed by
<code><a href='mlg.filter.html'>mlg.filter()</a></code>. This can necessarily only be done AMOVA tests that do not
account for within-individual variance. The distance matrix used to
calculate the amova is derived from using <code><a href='mlg.filter.html'>mlg.filter()</a></code> with the option
<code>stats = "distance"</code>, which reports the distance between multilocus
genotype clusters. One useful way to utilize this feature is to correct for
genotypes that have equivalent distance due to missing data. (See example
below.)</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>On Methods:</h3>
<p>Both <span class="pkg">ade4</span> and <span class="pkg">pegas</span> have
implementations of AMOVA, both of which are appropriately called "amova".
The ade4 version is faster, but there have been questions raised as to the
validity of the code utilized. The pegas version is slower, but careful
measures have been implemented as to the accuracy of the method. It must be
noted that there appears to be a bug regarding permuting analyses where
within individual variance is accounted for (<code>within = TRUE</code>) in the pegas
implementation. If you want to perform permutation analyses on the pegas
implementation, you must set <code>within = FALSE</code>. In addition, while clone
correction is implemented for both methods, filtering is only implemented
for the ade4 version.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>On Polyploids:</h3>
<p>As of <span class="pkg">poppr</span> version 2.7.0, this
function is able to calculate phi statistics for within-individual variance
for polyploid data with <strong>full dosage information</strong>. When a data set does
not contain full dosage information for all samples, then the resulting
pseudo-haplotypes will contain missing data, which would result in an
incorrect estimate of variance.</p>
<p>Instead, the AMOVA will be performed on the distance matrix derived from
allele counts or allele frequencies, depending on the <code>freq</code> option. This
has been shown to be robust to estimates with mixed ploidy (Ronfort et al.
1998; Meirmans and Liu 2018). If you wish to brute-force your way to
estimating AMOVA using missing values, you can split your haplotypes with
the <code><a href='make_haplotypes.html'>make_haplotypes()</a></code> function.</p>
<p>One strategy for addressing ambiguous dosage in your polyploid data set
would be to convert your data to <span class="pkg">polysat</span>'s <code>genambig</code> class with the
<code><a href='bootgen2genind.html'>as.genambig()</a></code>, estimate allele frequencies with <code><a href='https://rdrr.io/pkg/polysat/man/deSilvaFreq.html'>polysat::deSilvaFreq()</a></code>,
and use these frequencies to randomly sample alleles to fill in the
ambiguous alleles.</p>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Excoffier, L., Smouse, P.E. and Quattro, J.M. (1992) Analysis of
molecular variance inferred from metric distances among DNA haplotypes:
application to human mitochondrial DNA restriction data. <em>Genetics</em>,
<strong>131</strong>, 479-491.</p>
<p>Ronfort, J., Jenczewski, E., Bataillon, T., and Rousset, F. (1998). Analysis
of population structure in autotetraploid species. <em>Genetics</em>, <strong>150</strong>,
921–930.</p>
<p>Meirmans, P., Liu, S. (2018) Analysis of Molecular Variance (AMOVA) for
Autopolyploids <em>Submitted</em>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/ade4/man/amova.html'>ade4::amova()</a></code>, <code><a href='https://rdrr.io/pkg/pegas/man/amova.html'>pegas::amova()</a></code>, <code><a href='clonecorrect.html'>clonecorrect()</a></code>, <code><a href='diss.dist.html'>diss.dist()</a></code>,
<code><a href='missingno.html'>missingno()</a></code>, <code><a href='https://rdrr.io/pkg/ade4/man/is.euclid.html'>ade4::is.euclid()</a></code>, <code>strata()</code>, <code><a href='make_haplotypes.html'>make_haplotypes()</a></code>,
<code><a href='bootgen2genind.html'>as.genambig()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Aeut</span><span class='op'>)</span>
<span class='fu'>strata</span><span class='op'>(</span><span class='va'>Aeut</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'>other</span><span class='op'>(</span><span class='va'>Aeut</span><span class='op'>)</span><span class='op'>$</span><span class='va'>population_hierarchy</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
<span class='va'>agc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bootgen2genind.html'>as.genclone</a></span><span class='op'>(</span><span class='va'>Aeut</span><span class='op'>)</span>
<span class='va'>agc</span>
</div><div class='output co'>#&gt; 
#&gt; This is a genclone object
#&gt; -------------------------
#&gt; Genotype information:
#&gt; 
#&gt;    119 original multilocus genotypes 
#&gt;    187 diploid individuals
#&gt;     56 dominant loci
#&gt; 
#&gt; Population information:
#&gt; 
#&gt;      2 strata - Pop, Subpop
#&gt;      2 populations defined - Athena, Mt. Vernon</div><div class='input'><span class='va'>amova.result</span> <span class='op'>&lt;-</span> <span class='fu'>poppr.amova</span><span class='op'>(</span><span class='va'>agc</span>, <span class='op'>~</span><span class='va'>Pop</span><span class='op'>/</span><span class='va'>Subpop</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'> No missing values detected.</span></div><div class='input'><span class='va'>amova.result</span>
</div><div class='output co'>#&gt; $call
#&gt; ade4::amova(samples = xtab, distances = xdist, structures = xstruct)
#&gt; 
#&gt; $results
#&gt;                             Df    Sum Sq     Mean Sq
#&gt; Between Pop                  1 1051.2345 1051.234516
#&gt; Between samples Within Pop  16  273.4575   17.091091
#&gt; Within samples             169  576.5059    3.411277
#&gt; Total                      186 1901.1979   10.221494
#&gt; 
#&gt; $componentsofcovariance
#&gt;                                            Sigma          %
#&gt; Variations  Between Pop                11.063446  70.006786
#&gt; Variations  Between samples Within Pop  1.328667   8.407483
#&gt; Variations  Within samples              3.411277  21.585732
#&gt; Total variations                       15.803391 100.000000
#&gt; 
#&gt; $statphi
#&gt;                         Phi
#&gt; Phi-samples-total 0.7841427
#&gt; Phi-samples-Pop   0.2803128
#&gt; Phi-Pop-total     0.7000679
#&gt; </div><div class='input'><span class='va'>amova.test</span> <span class='op'>&lt;-</span> <span class='fu'>randtest</span><span class='op'>(</span><span class='va'>amova.result</span><span class='op'>)</span> <span class='co'># Test for significance</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>amova.test</span><span class='op'>)</span>
</div><div class='img'><img src='poppr.amova-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>amova.test</span>
</div><div class='output co'>#&gt; class: krandtest lightkrandtest 
#&gt; Monte-Carlo tests
#&gt; Call: randtest.amova(xtest = amova.result)
#&gt; 
#&gt; Number of tests:   3 
#&gt; 
#&gt; Adjustment method for multiple comparisons:   none 
#&gt; Permutation number:   99 
#&gt;                         Test       Obs   Std.Obs   Alter Pvalue
#&gt; 1  Variations within samples  3.411277 -28.82359    less   0.01
#&gt; 2 Variations between samples  1.328667  20.76983 greater   0.01
#&gt; 3     Variations between Pop 11.063446  10.20109 greater   0.01
#&gt; </div><div class='input'>
<span class='co'># \dontrun{</span>

<span class='co'># You can get the same results with the pegas implementation</span>
<span class='va'>amova.pegas</span> <span class='op'>&lt;-</span> <span class='fu'>poppr.amova</span><span class='op'>(</span><span class='va'>agc</span>, <span class='op'>~</span><span class='va'>Pop</span><span class='op'>/</span><span class='va'>Subpop</span>, method <span class='op'>=</span> <span class='st'>"pegas"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'> No missing values detected.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Zero distance(s)</span></div><div class='input'><span class='va'>amova.pegas</span>
</div><div class='output co'>#&gt; 
#&gt; 	Analysis of Molecular Variance
#&gt; 
#&gt; Call: pegas::amova(formula = hier, data = hierdf, nperm = nperm, is.squared = FALSE)
#&gt; 
#&gt;              SSD         MSD  df
#&gt; Pop    1051.2345 1051.234516   1
#&gt; Subpop  273.4575   17.091091  16
#&gt; Error   576.5059    3.411277 169
#&gt; Total  1901.1979   10.221494 186
#&gt; 
#&gt; Variance components:
#&gt;       Pop    Subpop     Error 
#&gt; 11.063446  1.328667  3.411277 
#&gt; 
#&gt; Phi-statistics:
#&gt;    Pop.in.GLOBAL (Phi_CT) Subpop.in.GLOBAL (Phi_ST)    Subpop.in.Pop (Phi_SC) 
#&gt;                 0.7000679                 0.7841427                 0.2803128 
#&gt; 
#&gt; Variance coefficients:
#&gt;        a        b        c 
#&gt; 10.29589 11.16949 93.36898 
#&gt; </div><div class='input'><span class='va'>amova.pegas</span><span class='op'>$</span><span class='va'>varcomp</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>amova.pegas</span><span class='op'>$</span><span class='va'>varcomp</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        Pop     Subpop      Error 
#&gt; 0.70006786 0.08407483 0.21585732 </div><div class='input'>
<span class='co'># Clone correction is possible</span>
<span class='va'>amova.cc.result</span> <span class='op'>&lt;-</span> <span class='fu'>poppr.amova</span><span class='op'>(</span><span class='va'>agc</span>, <span class='op'>~</span><span class='va'>Pop</span><span class='op'>/</span><span class='va'>Subpop</span>, clonecorrect <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'> No missing values detected.</span></div><div class='input'><span class='va'>amova.cc.result</span>
</div><div class='output co'>#&gt; $call
#&gt; ade4::amova(samples = xtab, distances = xdist, structures = xstruct)
#&gt; 
#&gt; $results
#&gt;                             Df    Sum Sq    Mean Sq
#&gt; Between Pop                  1  741.9872 741.987234
#&gt; Between samples Within Pop  16  185.6877  11.605483
#&gt; Within samples             123  520.1123   4.228555
#&gt; Total                      140 1447.7872  10.341337
#&gt; 
#&gt; $componentsofcovariance
#&gt;                                             Sigma          %
#&gt; Variations  Between Pop                10.4131525  66.777680
#&gt; Variations  Between samples Within Pop  0.9520545   6.105355
#&gt; Variations  Within samples              4.2285550  27.116965
#&gt; Total variations                       15.5937620 100.000000
#&gt; 
#&gt; $statphi
#&gt;                         Phi
#&gt; Phi-samples-total 0.7288303
#&gt; Phi-samples-Pop   0.1837727
#&gt; Phi-Pop-total     0.6677768
#&gt; </div><div class='input'><span class='va'>amova.cc.test</span> <span class='op'>&lt;-</span> <span class='fu'>randtest</span><span class='op'>(</span><span class='va'>amova.cc.result</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>amova.cc.test</span><span class='op'>)</span>
</div><div class='img'><img src='poppr.amova-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>amova.cc.test</span>
</div><div class='output co'>#&gt; class: krandtest lightkrandtest 
#&gt; Monte-Carlo tests
#&gt; Call: randtest.amova(xtest = amova.cc.result)
#&gt; 
#&gt; Number of tests:   3 
#&gt; 
#&gt; Adjustment method for multiple comparisons:   none 
#&gt; Permutation number:   99 
#&gt;                         Test        Obs    Std.Obs   Alter Pvalue
#&gt; 1  Variations within samples  4.2285550 -20.171106    less   0.01
#&gt; 2 Variations between samples  0.9520545   9.802126 greater   0.01
#&gt; 3     Variations between Pop 10.4131525   9.237767 greater   0.01
#&gt; </div><div class='input'>

<span class='co'># Example with filtering</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span>
<span class='fu'>splitStrata</span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='op'>~</span><span class='va'>Tree</span><span class='op'>/</span><span class='va'>Year</span><span class='op'>/</span><span class='va'>Symptom</span>
<span class='fu'>poppr.amova</span><span class='op'>(</span><span class='va'>monpop</span>, <span class='op'>~</span><span class='va'>Symptom</span><span class='op'>/</span><span class='va'>Year</span><span class='op'>)</span> <span class='co'># gets a warning of zero distances</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'> No loci with missing values above 5% found.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Zero distance(s)</span></div><div class='output co'>#&gt; <span class='message'>Distance matrix is non-euclidean.</span></div><div class='output co'>#&gt; <span class='message'>Using quasieuclid correction method. See ?quasieuclid for details.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Zero distance(s)</span></div><div class='output co'>#&gt; $call
#&gt; ade4::amova(samples = xtab, distances = xdist, structures = xstruct)
#&gt; 
#&gt; $results
#&gt;                                 Df     Sum Sq    Mean Sq
#&gt; Between Symptom                  1   17.62137  17.621372
#&gt; Between samples Within Symptom   4  444.47746 111.119364
#&gt; Within samples                 688 4880.09229   7.093157
#&gt; Total                          693 5342.19112   7.708789
#&gt; 
#&gt; $componentsofcovariance
#&gt;                                                 Sigma          %
#&gt; Variations  Between Symptom                -0.3380505  -4.369677
#&gt; Variations  Between samples Within Symptom  0.9811742  12.682763
#&gt; Variations  Within samples                  7.0931574  91.686913
#&gt; Total variations                            7.7362812 100.000000
#&gt; 
#&gt; $statphi
#&gt;                             Phi
#&gt; Phi-samples-total    0.08313087
#&gt; Phi-samples-Symptom  0.12151770
#&gt; Phi-Symptom-total   -0.04369677
#&gt; </div><div class='input'><span class='fu'>poppr.amova</span><span class='op'>(</span><span class='va'>monpop</span>, <span class='op'>~</span><span class='va'>Symptom</span><span class='op'>/</span><span class='va'>Year</span>, filter <span class='op'>=</span> <span class='cn'>TRUE</span>, threshold <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='co'># no warning</span>
</div><div class='output co'>#&gt; <span class='message'>Filtering ...</span></div><div class='output co'>#&gt; <span class='message'>Original multilocus genotypes   ... 264</span></div><div class='output co'>#&gt; <span class='message'>Contracted multilocus genotypes ... 236</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'> No loci with missing values above 5% found.</span></div><div class='output co'>#&gt; <span class='message'>Distance matrix is non-euclidean.</span></div><div class='output co'>#&gt; <span class='message'>Using quasieuclid correction method. See ?quasieuclid for details.</span></div><div class='output co'>#&gt; $call
#&gt; ade4::amova(samples = xtab, distances = xdist, structures = xstruct)
#&gt; 
#&gt; $results
#&gt;                                 Df     Sum Sq    Mean Sq
#&gt; Between Symptom                  1   18.13215  18.132145
#&gt; Between samples Within Symptom   4  452.34660 113.086650
#&gt; Within samples                 688 5002.62587   7.271259
#&gt; Total                          693 5473.10462   7.897698
#&gt; 
#&gt; $componentsofcovariance
#&gt;                                                 Sigma          %
#&gt; Variations  Between Symptom                -0.3430635  -4.328197
#&gt; Variations  Between samples Within Symptom  0.9980498  12.591711
#&gt; Variations  Within samples                  7.2712585  91.736486
#&gt; Total variations                            7.9262448 100.000000
#&gt; 
#&gt; $statphi
#&gt;                             Phi
#&gt; Phi-samples-total    0.08263514
#&gt; Phi-samples-Symptom  0.12069326
#&gt; Phi-Symptom-total   -0.04328197
#&gt; </div><div class='input'>

<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


