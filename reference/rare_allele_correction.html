<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Correcting rare allele frequencies — rare_allele_correction • poppr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Correcting rare allele frequencies — rare_allele_correction" />
<meta property="og:description" content="The following is a set of arguments for use in rraf, 
pgen, and psex to correct rare allele frequencies
that were lost in estimating round-robin allele frequencies." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poppr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Correcting rare allele frequencies</h1>
    <small class="dont-index">Source: <a href='https://github.com/grunwaldlab/poppr/blob/master/R/round_robin.R'><code>R/round_robin.R</code></a></small>
    <div class="hidden name"><code>rare_allele_correction.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The following is a set of arguments for use in <code><a href='rraf.html'>rraf</a></code>, 
<code><a href='pgen.html'>pgen</a></code>, and <code><a href='psex.html'>psex</a></code> to correct rare allele frequencies
that were lost in estimating round-robin allele frequencies.</p>
    </div>


    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>e</th>
      <td><p>a numeric epsilon value to use for all missing allele frequencies.</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>the unit by which to take the reciprocal. <code>div = "sample"</code> will
be 1/(n samples), <code>d = "mlg"</code> will be 1/(n mlg), and <code>d = 
"rrmlg"</code> will be 1/(n mlg at that locus). This is overridden by <code>e</code>.</p></td>
    </tr>
    <tr>
      <th>mul</th>
      <td><p>a multiplier for div. Default is <code>mul = 1</code>. This parameter 
is overridden by <code>e</code></p></td>
    </tr>
    <tr>
      <th>sum_to_one</th>
      <td><p>when <code>TRUE</code>, the original frequencies will be reduced 
so that all allele frequencies will sum to one. <strong>Default: 
<code>FALSE</code></strong></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>By default (<code>d = "sample", e = NULL, sum_to_one = FALSE, mul =
1</code>), this will add 1/(n samples) to all zero-value alleles. The basic formula
is <strong>1/(d * m)</strong> unless <strong>e</strong> is specified. If <code>sum_to_one = 
TRUE</code>, then the frequencies will be scaled as x/sum(x) AFTER correction, 
indicating that the allele frequencies will be reduced. See the examples for 
details. The general pattern of correction is that the value of the MAF will 
be <em>rrmlg &gt; mlg &gt; sample</em></p>
    <h2 class="hasAnchor" id="motivation"><a class="anchor" href="#motivation"></a>Motivation</h2>

    


<p>When <a href='rraf.html'>calculating allele frequencies from a round-robin
approach</a>, rare alleles are often lost resulting in zero-valued allele
frequencies (Arnaud-Haond et al. 2007, Parks and Werth 1993). This can be
problematic when calculating values for <code><a href='pgen.html'>pgen</a></code> and
<code><a href='psex.html'>psex</a></code> because frequencies of zero will result in undefined
values for samples that contain those rare alleles. The solution to this
problem is to give an estimate for the frequency of those rare alleles, but
the question of HOW to do that arises. These arguments provide a way to
define how rare alleles are to be estimated/corrected.</p>
    <h2 class="hasAnchor" id="using-these-arguments"><a class="anchor" href="#using-these-arguments"></a>Using these arguments</h2>

    


<p>These arguments are for use in the functions <code><a href='rraf.html'>rraf</a></code>, 
<code><a href='pgen.html'>pgen</a></code>, and <code><a href='psex.html'>psex</a></code>. They will replace the dots (...) 
that appear at the end of the function call. For example, if you want to set 
the minor allele frequencies to a specific value (let's say 0.001),
regardless of locus, you can insert <code>e = 0.001</code> along with any other 
arguments (note, position is not specific):</p><pre>
<span class='fu'><a href='pgen.html'>pgen</a></span>(<span class='no'>my_data</span>, <span class='kw'>e</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='psex.html'>psex</a></span>(<span class='no'>my_data</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"multiple"</span>, <span class='kw'>e</span> <span class='kw'>=</span> <span class='fl'>0.001</span>)</pre>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Arnaud-Haond, S., Duarte, C. M., Alberto, F., &amp; Serrão, E. A. 2007.
Standardizing methods to address clonality in population studies.
<em>Molecular Ecology</em>, 16(24), 5115-5139.</p>
<p>Parks, J. C., &amp; Werth, C. R. 1993. A study of spatial features of clones in a
population of bracken fern, <em>Pteridium aquilinum</em> (Dennstaedtiaceae).
<em>American Journal of Botany</em>, 537-544.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rraf.html'>rraf</a></code>, 
  <code><a href='pgen.html'>pgen</a></code>, 
  <code><a href='psex.html'>psex</a></code>, 
  <code><a href='rrmlg.html'>rrmlg</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontrun{</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>Pram</span>)
<span class='co'>#-------------------------------------</span>

<span class='co'># If you set correction = FALSE, you'll notice the zero-valued alleles</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; $PrMS6A1
#&gt; PrMS6A1.165 PrMS6A1.168 
#&gt;   0.5360825   0.4639175 
#&gt; 
#&gt; $Pr9C3A1
#&gt; Pr9C3A1.216 Pr9C3A1.226 
#&gt;   0.5357143   0.4642857 
#&gt; 
#&gt; $PrMS39A1
#&gt; PrMS39A1.130 PrMS39A1.213 PrMS39A1.214 PrMS39A1.242 PrMS39A1.246 PrMS39A1.250 
#&gt;  0.500000000  0.000000000  0.007575758  0.000000000  0.121212121  0.363636364 
#&gt; PrMS39A1.254 
#&gt;  0.007575758 
#&gt; 
#&gt; $PrMS45A1
#&gt; PrMS45A1.154 PrMS45A1.166 PrMS45A1.186 
#&gt;    0.0000000    0.5057471    0.4942529 
#&gt; 
#&gt; $PrMS43A1
#&gt; PrMS43A1.213 PrMS43A1.281 PrMS43A1.285 PrMS43A1.345 PrMS43A1.349 PrMS43A1.357 
#&gt;   0.00000000   0.00000000   0.00000000   0.00000000   0.00000000   0.00000000 
#&gt; PrMS43A1.360 PrMS43A1.364 PrMS43A1.368 PrMS43A1.372 PrMS43A1.376 PrMS43A1.380 
#&gt;   0.00000000   0.00000000   0.07692308   0.11538462   0.15384615   0.03846154 
#&gt; PrMS43A1.384 PrMS43A1.388 PrMS43A1.465 PrMS43A1.469 PrMS43A1.473 PrMS43A1.477 
#&gt;   0.11538462   0.00000000   0.00000000   0.00000000   0.00000000   0.00000000 
#&gt; PrMS43A1.481 PrMS43A1.485 PrMS43A1.489 PrMS43A1.493 PrMS43A1.497 PrMS43A1.505 
#&gt;   0.07692308   0.38461538   0.03846154   0.00000000   0.00000000   0.00000000 
#&gt; </div><div class='input'>
<span class='co'># By default, however, the data will be corrected by 1/n</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>)</div><div class='output co'>#&gt; $PrMS6A1
#&gt; PrMS6A1.165 PrMS6A1.168 
#&gt;   0.5360825   0.4639175 
#&gt; 
#&gt; $Pr9C3A1
#&gt; Pr9C3A1.216 Pr9C3A1.226 
#&gt;   0.5357143   0.4642857 
#&gt; 
#&gt; $PrMS39A1
#&gt; PrMS39A1.130 PrMS39A1.213 PrMS39A1.214 PrMS39A1.242 PrMS39A1.246 PrMS39A1.250 
#&gt;  0.500000000  0.001371742  0.007575758  0.001371742  0.121212121  0.363636364 
#&gt; PrMS39A1.254 
#&gt;  0.007575758 
#&gt; 
#&gt; $PrMS45A1
#&gt; PrMS45A1.154 PrMS45A1.166 PrMS45A1.186 
#&gt;  0.001371742  0.505747126  0.494252874 
#&gt; 
#&gt; $PrMS43A1
#&gt; PrMS43A1.213 PrMS43A1.281 PrMS43A1.285 PrMS43A1.345 PrMS43A1.349 PrMS43A1.357 
#&gt;  0.001371742  0.001371742  0.001371742  0.001371742  0.001371742  0.001371742 
#&gt; PrMS43A1.360 PrMS43A1.364 PrMS43A1.368 PrMS43A1.372 PrMS43A1.376 PrMS43A1.380 
#&gt;  0.001371742  0.001371742  0.076923077  0.115384615  0.153846154  0.038461538 
#&gt; PrMS43A1.384 PrMS43A1.388 PrMS43A1.465 PrMS43A1.469 PrMS43A1.473 PrMS43A1.477 
#&gt;  0.115384615  0.001371742  0.001371742  0.001371742  0.001371742  0.001371742 
#&gt; PrMS43A1.481 PrMS43A1.485 PrMS43A1.489 PrMS43A1.493 PrMS43A1.497 PrMS43A1.505 
#&gt;  0.076923077  0.384615385  0.038461538  0.001371742  0.001371742  0.001371742 
#&gt; </div><div class='input'>
<span class='co'># Of course, this is a diploid organism, we might want to set 1/2n</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>)</div><div class='output co'>#&gt; $PrMS6A1
#&gt; PrMS6A1.165 PrMS6A1.168 
#&gt;   0.5360825   0.4639175 
#&gt; 
#&gt; $Pr9C3A1
#&gt; Pr9C3A1.216 Pr9C3A1.226 
#&gt;   0.5357143   0.4642857 
#&gt; 
#&gt; $PrMS39A1
#&gt; PrMS39A1.130 PrMS39A1.213 PrMS39A1.214 PrMS39A1.242 PrMS39A1.246 PrMS39A1.250 
#&gt; 0.5000000000 0.0006858711 0.0075757576 0.0006858711 0.1212121212 0.3636363636 
#&gt; PrMS39A1.254 
#&gt; 0.0075757576 
#&gt; 
#&gt; $PrMS45A1
#&gt; PrMS45A1.154 PrMS45A1.166 PrMS45A1.186 
#&gt; 0.0006858711 0.5057471264 0.4942528736 
#&gt; 
#&gt; $PrMS43A1
#&gt; PrMS43A1.213 PrMS43A1.281 PrMS43A1.285 PrMS43A1.345 PrMS43A1.349 PrMS43A1.357 
#&gt; 0.0006858711 0.0006858711 0.0006858711 0.0006858711 0.0006858711 0.0006858711 
#&gt; PrMS43A1.360 PrMS43A1.364 PrMS43A1.368 PrMS43A1.372 PrMS43A1.376 PrMS43A1.380 
#&gt; 0.0006858711 0.0006858711 0.0769230769 0.1153846154 0.1538461538 0.0384615385 
#&gt; PrMS43A1.384 PrMS43A1.388 PrMS43A1.465 PrMS43A1.469 PrMS43A1.473 PrMS43A1.477 
#&gt; 0.1153846154 0.0006858711 0.0006858711 0.0006858711 0.0006858711 0.0006858711 
#&gt; PrMS43A1.481 PrMS43A1.485 PrMS43A1.489 PrMS43A1.493 PrMS43A1.497 PrMS43A1.505 
#&gt; 0.0769230769 0.3846153846 0.0384615385 0.0006858711 0.0006858711 0.0006858711 
#&gt; </div><div class='input'>
<span class='co'># To set MAF = 1/2mlg</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='st'>"mlg"</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>)</div><div class='output co'>#&gt; $PrMS6A1
#&gt; PrMS6A1.165 PrMS6A1.168 
#&gt;   0.5360825   0.4639175 
#&gt; 
#&gt; $Pr9C3A1
#&gt; Pr9C3A1.216 Pr9C3A1.226 
#&gt;   0.5357143   0.4642857 
#&gt; 
#&gt; $PrMS39A1
#&gt; PrMS39A1.130 PrMS39A1.213 PrMS39A1.214 PrMS39A1.242 PrMS39A1.246 PrMS39A1.250 
#&gt;  0.500000000  0.005102041  0.007575758  0.005102041  0.121212121  0.363636364 
#&gt; PrMS39A1.254 
#&gt;  0.007575758 
#&gt; 
#&gt; $PrMS45A1
#&gt; PrMS45A1.154 PrMS45A1.166 PrMS45A1.186 
#&gt;  0.005102041  0.505747126  0.494252874 
#&gt; 
#&gt; $PrMS43A1
#&gt; PrMS43A1.213 PrMS43A1.281 PrMS43A1.285 PrMS43A1.345 PrMS43A1.349 PrMS43A1.357 
#&gt;  0.005102041  0.005102041  0.005102041  0.005102041  0.005102041  0.005102041 
#&gt; PrMS43A1.360 PrMS43A1.364 PrMS43A1.368 PrMS43A1.372 PrMS43A1.376 PrMS43A1.380 
#&gt;  0.005102041  0.005102041  0.076923077  0.115384615  0.153846154  0.038461538 
#&gt; PrMS43A1.384 PrMS43A1.388 PrMS43A1.465 PrMS43A1.469 PrMS43A1.473 PrMS43A1.477 
#&gt;  0.115384615  0.005102041  0.005102041  0.005102041  0.005102041  0.005102041 
#&gt; PrMS43A1.481 PrMS43A1.485 PrMS43A1.489 PrMS43A1.493 PrMS43A1.497 PrMS43A1.505 
#&gt;  0.076923077  0.384615385  0.038461538  0.005102041  0.005102041  0.005102041 
#&gt; </div><div class='input'>
<span class='co'># Another way to think about this is, since these allele frequencies were</span>
<span class='co'># derived at each locus with different sample sizes, it's only appropriate to</span>
<span class='co'># correct based on those sample sizes.</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='st'>"rrmlg"</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>)</div><div class='output co'>#&gt; $PrMS6A1
#&gt; PrMS6A1.165 PrMS6A1.168 
#&gt;   0.5360825   0.4639175 
#&gt; 
#&gt; $Pr9C3A1
#&gt; Pr9C3A1.216 Pr9C3A1.226 
#&gt;   0.5357143   0.4642857 
#&gt; 
#&gt; $PrMS39A1
#&gt; PrMS39A1.130 PrMS39A1.213 PrMS39A1.214 PrMS39A1.242 PrMS39A1.246 PrMS39A1.250 
#&gt;  0.500000000  0.007575758  0.007575758  0.007575758  0.121212121  0.363636364 
#&gt; PrMS39A1.254 
#&gt;  0.007575758 
#&gt; 
#&gt; $PrMS45A1
#&gt; PrMS45A1.154 PrMS45A1.166 PrMS45A1.186 
#&gt;  0.005747126  0.505747126  0.494252874 
#&gt; 
#&gt; $PrMS43A1
#&gt; PrMS43A1.213 PrMS43A1.281 PrMS43A1.285 PrMS43A1.345 PrMS43A1.349 PrMS43A1.357 
#&gt;   0.03846154   0.03846154   0.03846154   0.03846154   0.03846154   0.03846154 
#&gt; PrMS43A1.360 PrMS43A1.364 PrMS43A1.368 PrMS43A1.372 PrMS43A1.376 PrMS43A1.380 
#&gt;   0.03846154   0.03846154   0.07692308   0.11538462   0.15384615   0.03846154 
#&gt; PrMS43A1.384 PrMS43A1.388 PrMS43A1.465 PrMS43A1.469 PrMS43A1.473 PrMS43A1.477 
#&gt;   0.11538462   0.03846154   0.03846154   0.03846154   0.03846154   0.03846154 
#&gt; PrMS43A1.481 PrMS43A1.485 PrMS43A1.489 PrMS43A1.493 PrMS43A1.497 PrMS43A1.505 
#&gt;   0.07692308   0.38461538   0.03846154   0.03846154   0.03846154   0.03846154 
#&gt; </div><div class='input'>
<span class='co'># If we were going to use these frequencies for simulations, we might want to</span>
<span class='co'># ensure that they all sum to one. </span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='st'>"mlg"</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>, <span class='kw'>sum_to_one</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; $PrMS6A1
#&gt; PrMS6A1.165 PrMS6A1.168 
#&gt;   0.5360825   0.4639175 
#&gt; 
#&gt; $Pr9C3A1
#&gt; Pr9C3A1.216 Pr9C3A1.226 
#&gt;   0.5357143   0.4642857 
#&gt; 
#&gt; $PrMS39A1
#&gt; PrMS39A1.130 PrMS39A1.213 PrMS39A1.214 PrMS39A1.242 PrMS39A1.246 PrMS39A1.250 
#&gt;  0.494949495  0.005050505  0.007499235  0.005050505  0.119987756  0.359963269 
#&gt; PrMS39A1.254 
#&gt;  0.007499235 
#&gt; 
#&gt; $PrMS45A1
#&gt; PrMS45A1.154 PrMS45A1.166 PrMS45A1.186 
#&gt;  0.005076142  0.503179882  0.491743976 
#&gt; 
#&gt; $PrMS43A1
#&gt; PrMS43A1.213 PrMS43A1.281 PrMS43A1.285 PrMS43A1.345 PrMS43A1.349 PrMS43A1.357 
#&gt;  0.004716981  0.004716981  0.004716981  0.004716981  0.004716981  0.004716981 
#&gt; PrMS43A1.360 PrMS43A1.364 PrMS43A1.368 PrMS43A1.372 PrMS43A1.376 PrMS43A1.380 
#&gt;  0.004716981  0.004716981  0.071117562  0.106676343  0.142235123  0.035558781 
#&gt; PrMS43A1.384 PrMS43A1.388 PrMS43A1.465 PrMS43A1.469 PrMS43A1.473 PrMS43A1.477 
#&gt;  0.106676343  0.004716981  0.004716981  0.004716981  0.004716981  0.004716981 
#&gt; PrMS43A1.481 PrMS43A1.485 PrMS43A1.489 PrMS43A1.493 PrMS43A1.497 PrMS43A1.505 
#&gt;  0.071117562  0.355587808  0.035558781  0.004716981  0.004716981  0.004716981 
#&gt; </div><div class='input'>
<span class='co'>#-------------------------------------</span>
<span class='co'># When we calculate these frequencies based on population, they are heavily</span>
<span class='co'># influenced by the number of observed mlgs. </span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='st'>"rrmlg"</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>)</div><div class='output co'>#&gt;               PrMS6A1.165 PrMS6A1.168 Pr9C3A1.216 Pr9C3A1.226 PrMS39A1.130
#&gt; Nursery_CA      0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; Nursery_OR      0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; JHallCr_OR      0.6166667   0.3833333   0.6166667   0.3833333          0.5
#&gt; NFChetHigh_OR   0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; Coast_OR        0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; HunterCr_OR     0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; Winchuck_OR     0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; ChetcoMain_OR   0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; PistolRSF_OR    0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt;               PrMS39A1.213 PrMS39A1.214 PrMS39A1.242 PrMS39A1.246 PrMS39A1.250
#&gt; Nursery_CA      0.02500000   0.02500000   0.02500000   0.35000000   0.15000000
#&gt; Nursery_OR      0.03571429   0.03571429   0.03571429   0.07142857   0.35714286
#&gt; JHallCr_OR      0.01923077   0.01923077   0.01923077   0.01923077   0.48076923
#&gt; NFChetHigh_OR   0.02000000   0.02000000   0.02000000   0.04000000   0.42000000
#&gt; Coast_OR        0.04545455   0.04545455   0.04545455   0.40909091   0.09090909
#&gt; HunterCr_OR     0.16666667   0.16666667   0.16666667   0.33333333   0.16666667
#&gt; Winchuck_OR     0.06250000   0.06250000   0.06250000   0.06250000   0.50000000
#&gt; ChetcoMain_OR   0.10000000   0.10000000   0.10000000   0.20000000   0.20000000
#&gt; PistolRSF_OR    0.25000000   0.25000000   0.25000000   0.25000000   0.50000000
#&gt;               PrMS39A1.254 PrMS45A1.154 PrMS45A1.166 PrMS45A1.186 PrMS43A1.213
#&gt; Nursery_CA      0.02500000   0.01666667     0.500000     0.500000   0.16666667
#&gt; Nursery_OR      0.03571429   0.02631579     0.500000     0.500000   0.12500000
#&gt; JHallCr_OR      0.01923077   0.01851852     0.537037     0.462963   0.07142857
#&gt; NFChetHigh_OR   0.02000000   0.01612903     0.500000     0.500000   0.05555556
#&gt; Coast_OR        0.04545455   0.04166667     0.500000     0.500000   0.25000000
#&gt; HunterCr_OR     0.16666667   0.12500000     0.500000     0.500000   0.25000000
#&gt; Winchuck_OR     0.06250000   0.06250000     0.500000     0.500000   0.16666667
#&gt; ChetcoMain_OR   0.10000000   0.07142857     0.500000     0.500000   0.16666667
#&gt; PistolRSF_OR    0.25000000   0.25000000     0.500000     0.500000   0.50000000
#&gt;               PrMS43A1.281 PrMS43A1.285 PrMS43A1.345 PrMS43A1.349 PrMS43A1.357
#&gt; Nursery_CA      0.16666667   0.16666667   0.16666667   0.16666667   0.16666667
#&gt; Nursery_OR      0.12500000   0.12500000   0.12500000   0.12500000   0.12500000
#&gt; JHallCr_OR      0.07142857   0.07142857   0.07142857   0.07142857   0.07142857
#&gt; NFChetHigh_OR   0.05555556   0.05555556   0.05555556   0.05555556   0.05555556
#&gt; Coast_OR        0.25000000   0.25000000   0.25000000   0.25000000   0.25000000
#&gt; HunterCr_OR     0.25000000   0.25000000   0.25000000   0.25000000   0.25000000
#&gt; Winchuck_OR     0.16666667   0.16666667   0.16666667   0.16666667   0.16666667
#&gt; ChetcoMain_OR   0.16666667   0.16666667   0.16666667   0.16666667   0.16666667
#&gt; PistolRSF_OR    0.50000000   0.50000000   0.50000000   0.50000000   0.50000000
#&gt;               PrMS43A1.360 PrMS43A1.364 PrMS43A1.368 PrMS43A1.372 PrMS43A1.376
#&gt; Nursery_CA      0.16666667   0.16666667   0.16666667   0.33333333   0.16666667
#&gt; Nursery_OR      0.12500000   0.12500000   0.12500000   0.25000000   0.12500000
#&gt; JHallCr_OR      0.07142857   0.07142857   0.07142857   0.07142857   0.42857143
#&gt; NFChetHigh_OR   0.05555556   0.05555556   0.11111111   0.05555556   0.05555556
#&gt; Coast_OR        0.25000000   0.25000000   0.25000000   0.25000000   0.25000000
#&gt; HunterCr_OR     0.25000000   0.25000000   0.50000000   0.25000000   0.25000000
#&gt; Winchuck_OR     0.16666667   0.16666667   0.16666667   0.16666667   0.33333333
#&gt; ChetcoMain_OR   0.16666667   0.16666667   0.16666667   0.16666667   0.50000000
#&gt; PistolRSF_OR    0.50000000   0.50000000   0.50000000   0.50000000   0.50000000
#&gt;               PrMS43A1.380 PrMS43A1.384 PrMS43A1.388 PrMS43A1.465 PrMS43A1.469
#&gt; Nursery_CA      0.16666667   0.16666667   0.16666667   0.16666667   0.16666667
#&gt; Nursery_OR      0.12500000   0.12500000   0.12500000   0.12500000   0.12500000
#&gt; JHallCr_OR      0.07142857   0.07142857   0.07142857   0.07142857   0.07142857
#&gt; NFChetHigh_OR   0.11111111   0.16666667   0.05555556   0.05555556   0.05555556
#&gt; Coast_OR        0.25000000   0.25000000   0.25000000   0.25000000   0.25000000
#&gt; HunterCr_OR     0.25000000   0.25000000   0.25000000   0.25000000   0.25000000
#&gt; Winchuck_OR     0.16666667   0.16666667   0.16666667   0.16666667   0.16666667
#&gt; ChetcoMain_OR   0.16666667   0.16666667   0.16666667   0.16666667   0.16666667
#&gt; PistolRSF_OR    0.50000000   0.50000000   0.50000000   0.50000000   0.50000000
#&gt;               PrMS43A1.473 PrMS43A1.477 PrMS43A1.481 PrMS43A1.485 PrMS43A1.489
#&gt; Nursery_CA      0.16666667   0.16666667   0.16666667    0.3333333   0.16666667
#&gt; Nursery_OR      0.12500000   0.12500000   0.12500000    0.3750000   0.12500000
#&gt; JHallCr_OR      0.07142857   0.07142857   0.07142857    0.4285714   0.07142857
#&gt; NFChetHigh_OR   0.05555556   0.05555556   0.16666667    0.2777778   0.05555556
#&gt; Coast_OR        0.25000000   0.25000000   0.25000000    0.2500000   0.25000000
#&gt; HunterCr_OR     0.25000000   0.25000000   0.25000000    0.2500000   0.25000000
#&gt; Winchuck_OR     0.16666667   0.16666667   0.50000000    0.1666667   0.16666667
#&gt; ChetcoMain_OR   0.16666667   0.16666667   0.16666667    0.1666667   0.16666667
#&gt; PistolRSF_OR    0.50000000   0.50000000   0.50000000    0.5000000   0.50000000
#&gt;               PrMS43A1.493 PrMS43A1.497 PrMS43A1.505
#&gt; Nursery_CA      0.16666667   0.16666667   0.16666667
#&gt; Nursery_OR      0.12500000   0.12500000   0.12500000
#&gt; JHallCr_OR      0.07142857   0.07142857   0.07142857
#&gt; NFChetHigh_OR   0.05555556   0.05555556   0.05555556
#&gt; Coast_OR        0.25000000   0.25000000   0.25000000
#&gt; HunterCr_OR     0.50000000   0.25000000   0.25000000
#&gt; Winchuck_OR     0.16666667   0.16666667   0.16666667
#&gt; ChetcoMain_OR   0.16666667   0.16666667   0.16666667
#&gt; PistolRSF_OR    0.50000000   0.50000000   0.50000000</div><div class='input'>
<span class='co'># This can be fixed by specifying a specific value</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>e</span> <span class='kw'>=</span> <span class='fl'>0.01</span>)</div><div class='output co'>#&gt;               PrMS6A1.165 PrMS6A1.168 Pr9C3A1.216 Pr9C3A1.226 PrMS39A1.130
#&gt; Nursery_CA      0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; Nursery_OR      0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; JHallCr_OR      0.6166667   0.3833333   0.6166667   0.3833333          0.5
#&gt; NFChetHigh_OR   0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; Coast_OR        0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; HunterCr_OR     0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; Winchuck_OR     0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; ChetcoMain_OR   0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt; PistolRSF_OR    0.5000000   0.5000000   0.5000000   0.5000000          0.5
#&gt;               PrMS39A1.213 PrMS39A1.214 PrMS39A1.242 PrMS39A1.246 PrMS39A1.250
#&gt; Nursery_CA            0.01         0.01   0.01000000   0.35000000   0.15000000
#&gt; Nursery_OR            0.01         0.01   0.03571429   0.07142857   0.35714286
#&gt; JHallCr_OR            0.01         0.01   0.01000000   0.01923077   0.48076923
#&gt; NFChetHigh_OR         0.01         0.02   0.01000000   0.04000000   0.42000000
#&gt; Coast_OR              0.01         0.01   0.01000000   0.40909091   0.09090909
#&gt; HunterCr_OR           0.01         0.01   0.01000000   0.33333333   0.16666667
#&gt; Winchuck_OR           0.01         0.01   0.01000000   0.01000000   0.50000000
#&gt; ChetcoMain_OR         0.01         0.01   0.01000000   0.20000000   0.20000000
#&gt; PistolRSF_OR          0.01         0.01   0.01000000   0.01000000   0.50000000
#&gt;               PrMS39A1.254 PrMS45A1.154 PrMS45A1.166 PrMS45A1.186 PrMS43A1.213
#&gt; Nursery_CA      0.01000000         0.01     0.500000     0.500000         0.01
#&gt; Nursery_OR      0.03571429         0.01     0.500000     0.500000         0.01
#&gt; JHallCr_OR      0.01000000         0.01     0.537037     0.462963         0.01
#&gt; NFChetHigh_OR   0.02000000         0.01     0.500000     0.500000         0.01
#&gt; Coast_OR        0.01000000         0.01     0.500000     0.500000         0.01
#&gt; HunterCr_OR     0.01000000         0.01     0.500000     0.500000         0.01
#&gt; Winchuck_OR     0.01000000         0.01     0.500000     0.500000         0.01
#&gt; ChetcoMain_OR   0.10000000         0.01     0.500000     0.500000         0.01
#&gt; PistolRSF_OR    0.01000000         0.01     0.500000     0.500000         0.01
#&gt;               PrMS43A1.281 PrMS43A1.285 PrMS43A1.345 PrMS43A1.349 PrMS43A1.357
#&gt; Nursery_CA            0.01         0.01         0.01         0.01         0.01
#&gt; Nursery_OR            0.01         0.01         0.01         0.01         0.01
#&gt; JHallCr_OR            0.01         0.01         0.01         0.01         0.01
#&gt; NFChetHigh_OR         0.01         0.01         0.01         0.01         0.01
#&gt; Coast_OR              0.01         0.01         0.01         0.01         0.01
#&gt; HunterCr_OR           0.01         0.01         0.01         0.01         0.01
#&gt; Winchuck_OR           0.01         0.01         0.01         0.01         0.01
#&gt; ChetcoMain_OR         0.01         0.01         0.01         0.01         0.01
#&gt; PistolRSF_OR          0.01         0.01         0.01         0.01         0.01
#&gt;               PrMS43A1.360 PrMS43A1.364 PrMS43A1.368 PrMS43A1.372 PrMS43A1.376
#&gt; Nursery_CA            0.01        0.010    0.1666667   0.33333333   0.01000000
#&gt; Nursery_OR            0.01        0.125    0.1250000   0.25000000   0.01000000
#&gt; JHallCr_OR            0.01        0.010    0.0100000   0.01000000   0.42857143
#&gt; NFChetHigh_OR         0.01        0.010    0.1111111   0.05555556   0.05555556
#&gt; Coast_OR              0.01        0.010    0.2500000   0.01000000   0.01000000
#&gt; HunterCr_OR           0.01        0.010    0.5000000   0.01000000   0.01000000
#&gt; Winchuck_OR           0.01        0.010    0.0100000   0.01000000   0.33333333
#&gt; ChetcoMain_OR         0.01        0.010    0.0100000   0.01000000   0.50000000
#&gt; PistolRSF_OR          0.01        0.010    0.0100000   0.01000000   0.50000000
#&gt;               PrMS43A1.380 PrMS43A1.384 PrMS43A1.388 PrMS43A1.465 PrMS43A1.469
#&gt; Nursery_CA       0.0100000   0.01000000         0.01         0.01         0.01
#&gt; Nursery_OR       0.0100000   0.01000000         0.01         0.01         0.01
#&gt; JHallCr_OR       0.0100000   0.07142857         0.01         0.01         0.01
#&gt; NFChetHigh_OR    0.1111111   0.16666667         0.01         0.01         0.01
#&gt; Coast_OR         0.0100000   0.25000000         0.01         0.01         0.01
#&gt; HunterCr_OR      0.0100000   0.01000000         0.01         0.01         0.01
#&gt; Winchuck_OR      0.1666667   0.01000000         0.01         0.01         0.01
#&gt; ChetcoMain_OR    0.0100000   0.01000000         0.01         0.01         0.01
#&gt; PistolRSF_OR     0.0100000   0.01000000         0.01         0.01         0.01
#&gt;               PrMS43A1.473 PrMS43A1.477 PrMS43A1.481 PrMS43A1.485 PrMS43A1.489
#&gt; Nursery_CA            0.01    0.0100000    0.0100000    0.3333333   0.16666667
#&gt; Nursery_OR            0.01    0.0100000    0.0100000    0.3750000   0.12500000
#&gt; JHallCr_OR            0.01    0.0100000    0.0100000    0.4285714   0.07142857
#&gt; NFChetHigh_OR         0.01    0.0100000    0.1666667    0.2777778   0.05555556
#&gt; Coast_OR              0.01    0.0100000    0.0100000    0.2500000   0.25000000
#&gt; HunterCr_OR           0.01    0.0100000    0.0100000    0.0100000   0.01000000
#&gt; Winchuck_OR           0.01    0.0100000    0.5000000    0.0100000   0.01000000
#&gt; ChetcoMain_OR         0.01    0.1666667    0.1666667    0.1666667   0.01000000
#&gt; PistolRSF_OR          0.01    0.0100000    0.0100000    0.5000000   0.01000000
#&gt;               PrMS43A1.493 PrMS43A1.497 PrMS43A1.505
#&gt; Nursery_CA            0.01         0.01         0.01
#&gt; Nursery_OR            0.01         0.01         0.01
#&gt; JHallCr_OR            0.01         0.01         0.01
#&gt; NFChetHigh_OR         0.01         0.01         0.01
#&gt; Coast_OR              0.01         0.01         0.01
#&gt; HunterCr_OR           0.50         0.01         0.01
#&gt; Winchuck_OR           0.01         0.01         0.01
#&gt; ChetcoMain_OR         0.01         0.01         0.01
#&gt; PistolRSF_OR          0.01         0.01         0.01</div><div class='input'>
# }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


