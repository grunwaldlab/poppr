<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform a bootstrap analysis on diversity statistics — diversity_boot • poppr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform a bootstrap analysis on diversity statistics — diversity_boot" />
<meta property="og:description" content="This function is intended to perform bootstrap statistics on a matrix of
multilocus genotype counts in different populations. Results from this
function should be interpreted carefully as the default statistics are known
to have a downward bias. See the details for more information." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poppr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform a bootstrap analysis on diversity statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/grunwaldlab/poppr/blob/master/R/bootstraping.R'><code>R/bootstraping.R</code></a></small>
    <div class="hidden name"><code>diversity_boot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is intended to perform bootstrap statistics on a matrix of
multilocus genotype counts in different populations. Results from this
function should be interpreted carefully as the default statistics are known
to have a downward bias. See the details for more information.</p>
    </div>

    <pre class="usage"><span class='fu'>diversity_boot</span><span class='op'>(</span>
  <span class='va'>tab</span>,
  <span class='va'>n</span>,
  n.boot <span class='op'>=</span> <span class='fl'>1L</span>,
  n.rare <span class='op'>=</span> <span class='cn'>NULL</span>,
  H <span class='op'>=</span> <span class='cn'>TRUE</span>,
  G <span class='op'>=</span> <span class='cn'>TRUE</span>,
  lambda <span class='op'>=</span> <span class='cn'>TRUE</span>,
  E5 <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tab</th>
      <td><p>a table produced from the <span class="pkg">poppr</span> function
<code><a href='mlg.html'>mlg.table()</a></code>. MLGs in columns and populations in rows</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>an integer &gt; 0 specifying the number of bootstrap replicates to
perform (corresponds to <code>R</code> in the function <code><a href='https://rdrr.io/pkg/boot/man/boot.html'>boot::boot()</a></code>.</p></td>
    </tr>
    <tr>
      <th>n.boot</th>
      <td><p>an integer specifying the number of samples to be drawn in each
bootstrap replicate. If <code>n.boot</code> &lt; 2 (default), the number of samples
drawn for each bootstrap replicate will be equal to the number of samples in
the data set.</p></td>
    </tr>
    <tr>
      <th>n.rare</th>
      <td><p>a sample size at which all resamplings should be performed.
This should be no larger than the smallest sample size. Defaults to
<code>NULL</code>, indicating that each population will be sampled at its own
size.</p></td>
    </tr>
    <tr>
      <th>H</th>
      <td><p>logical whether or not to calculate Shannon's index</p></td>
    </tr>
    <tr>
      <th>G</th>
      <td><p>logical whether or not to calculate Stoddart and Taylor's index (aka
inverse Simpson's index).</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>logical whether or not to calculate Simpson's index</p></td>
    </tr>
    <tr>
      <th>E5</th>
      <td><p>logical whether or not to calculate Evenness</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other parameters passed on to <code><a href='https://rdrr.io/pkg/boot/man/boot.html'>boot::boot()</a></code> and
<code><a href='diversity_stats.html'>diversity_stats()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of objects of class "boot".</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Bootstrapping is performed in three ways:</p><ul>
<li><p>if <code>n.rare</code> is a number greater than zero, then bootstrapping
is performed by randomly sampling without replacement <em>n.rare</em>
samples from the data.</p><pre>\item if `n.boot` is greater than 1, bootstrapping is performed by
sampling n.boot samples from a multinomial distribution weighted by the
proportion of each MLG in the data.

\item if `n.boot` is less than 2, bootstrapping is performed by 
sampling N samples from a multinomial distribution weighted by the
proportion of each MLG in the data.
</pre></li>
</ul>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Downward Bias</h3>
<p>When sampling with replacement, the diversity statistics here present a
downward bias partially due to the small number of samples in the data.
The result is that the mean of the bootstrapped samples will often be
much lower than the observed value. Alternatively, you can increase the
sample size of the bootstrap by increasing the size of <code>n.boot</code>. Both
of these methods should be taken with caution in interpretation. There
are several R packages freely available that will calculate and perform
bootstrap estimates of Shannon and Simpson diversity metrics (eg.
<span class="pkg">entropart</span>, <span class="pkg">entropy</span>, <span class="pkg">simboot</span>, and
<span class="pkg">EntropyEstimation</span>. These packages also offer unbiased estimators of
Shannon and Simpson diversity. Please take care when attempting to
interpret the results of this function.</p>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='diversity_stats.html'>diversity_stats()</a></code> for basic statistic calculation,
<code><a href='diversity_ci.html'>diversity_ci()</a></code> for confidence intervals and plotting, and
<code><a href='poppr.html'>poppr()</a></code>. For bootstrap sampling:
<code><a href='https://rdrr.io/r/stats/Multinom.html'>stats::rmultinom()</a></code> <code><a href='https://rdrr.io/pkg/boot/man/boot.html'>boot::boot()</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Zhian N. Kamvar</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://grunwaldlab.github.io/poppr/'>poppr</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Pinf</span><span class='op'>)</span>
<span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mlg.html'>mlg.table</a></span><span class='op'>(</span><span class='va'>Pinf</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>diversity_boot</span><span class='op'>(</span><span class='va'>tab</span>, <span class='fl'>10L</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $`South America`
#&gt; 
#&gt; PARAMETRIC BOOTSTRAP
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", 
#&gt;     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;       original       bias    std. error
#&gt; t1*  3.2679442 -0.408150065 0.105434202
#&gt; t2* 23.2903226 -7.827538789 1.622159350
#&gt; t3*  0.9570637 -0.022437673 0.007467245
#&gt; t4*  0.8825297 -0.007866368 0.040895129
#&gt; 
#&gt; $`North America`
#&gt; 
#&gt; PARAMETRIC BOOTSTRAP
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", 
#&gt;     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;       original        bias    std. error
#&gt; t1*  3.6870132 -5.005028e-01  0.11329447
#&gt; t2* 34.9090909 -1.351801e+01  2.93476936
#&gt; t3*  0.9713542 -1.909722e-02  0.00816362
#&gt; t4*  0.8711297 -4.199509e-04  0.04615188
#&gt; </div><div class='input'><span class='co'># \dontrun{</span>
<span class='co'># This can be done in a parallel fashion (OSX uses "multicore", Windows uses "snow")</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='fu'>diversity_boot</span><span class='op'>(</span><span class='va'>tab</span>, <span class='fl'>10000L</span>, parallel <span class='op'>=</span> <span class='st'>"multicore"</span>, ncpus <span class='op'>=</span> <span class='fl'>4L</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   5.996   2.586   3.976 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='fu'>diversity_boot</span><span class='op'>(</span><span class='va'>tab</span>, <span class='fl'>10000L</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   4.111   0.056   4.181 </div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


