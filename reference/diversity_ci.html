<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function is for calculating bootstrap statistics and their confidence
intervals. It is important to note that the calculation of confidence
intervals is not perfect (See Details). Please be cautious when interpreting
the results."><title>Perform bootstrap statistics, calculate, and plot confidence intervals. — diversity_ci • poppr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform bootstrap statistics, calculate, and plot confidence intervals. — diversity_ci"><meta property="og:description" content="This function is for calculating bootstrap statistics and their confidence
intervals. It is important to note that the calculation of confidence
intervals is not perfect (See Details). Please be cautious when interpreting
the results."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">poppr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    <a class="dropdown-item" href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Perform bootstrap statistics, calculate, and plot confidence intervals.</h1>
      <small class="dont-index">Source: <a href="https://github.com/grunwaldlab/poppr/blob/HEAD/R/bootstraping.R" class="external-link"><code>R/bootstraping.R</code></a></small>
      <div class="d-none name"><code>diversity_ci.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is for calculating bootstrap statistics and their confidence
intervals. It is important to note that the calculation of confidence
intervals is not perfect (See Details). Please be cautious when interpreting
the results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">diversity_ci</span><span class="op">(</span></span>
<span>  <span class="va">tab</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  n.boot <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  ci <span class="op">=</span> <span class="fl">95</span>,</span>
<span>  total <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rarefy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n.rare <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  raw <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tab</dt>
<dd><p>a <code><a href="https://rdrr.io/pkg/adegenet/man/new.genind.html" class="external-link">genind()</a></code>, <code><a href="genclone-class.html">genclone()</a></code>,
<code><a href="genclone-class.html">snpclone()</a></code>, OR a matrix produced from
<code><a href="mlg.html">mlg.table()</a></code>.</p></dd>


<dt>n</dt>
<dd><p>an integer defining the number of bootstrap replicates (defaults to
1000).</p></dd>


<dt>n.boot</dt>
<dd><p>an integer specifying the number of samples to be drawn in each
bootstrap replicate. If <code>n.boot</code> &lt; 2 (default), the number of samples
drawn for each bootstrap replicate will be equal to the number of samples
in the data set. See Details.</p></dd>


<dt>ci</dt>
<dd><p>the percent for confidence interval.</p></dd>


<dt>total</dt>
<dd><p>argument to be passed on to <code><a href="mlg.html">mlg.table()</a></code> if
<code>tab</code> is a genind object.</p></dd>


<dt>rarefy</dt>
<dd><p>if <code>TRUE</code>, bootstrapping will be performed on the smallest
population size or the value of <code>n.rare</code>, whichever is larger.
Defaults to <code>FALSE</code>, indicating that bootstrapping will be performed
respective to each population size.</p></dd>


<dt>n.rare</dt>
<dd><p>an integer specifying the smallest size at which to resample
data. This is only used if <code>rarefy = TRUE</code>.</p></dd>


<dt>plot</dt>
<dd><p>If <code>TRUE</code> (default), boxplots will be produced for each
population, grouped by statistic. Colored dots will indicate the observed
value.This plot can be retrieved by using <code>p &lt;- last_plot()</code> from the
<span class="pkg">ggplot2</span> package.</p></dd>


<dt>raw</dt>
<dd><p>if <code>TRUE</code> (default) a list containing three elements will be
returned</p></dd>


<dt>center</dt>
<dd><p>if <code>TRUE</code> (default), the confidence interval will be
centered around the observed statistic. Otherwise, if <code>FALSE</code>, the
confidence interval will be bias-corrected normal CI as reported from
<code><a href="https://rdrr.io/pkg/boot/man/boot.ci.html" class="external-link">boot::boot.ci()</a></code></p></dd>


<dt>...</dt>
<dd><p>parameters to be passed on to <code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot()</a></code> and
<code><a href="diversity_stats.html">diversity_stats()</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<div class="section">
<h3 id="raw-true">raw = TRUE<a class="anchor" aria-label="anchor" href="#raw-true"></a></h3>

<ul><li><p><strong>obs</strong> a matrix with observed statistics in columns,
populations in rows</p></li>
<li><p><strong>est</strong> a matrix with estimated statistics in columns,
populations in rows</p></li>
<li><p><strong>CI</strong> an array of 3 dimensions giving the lower and upper
bound, the index measured, and the population.</p></li>
<li><p><strong>boot</strong> a list containing the output of
<code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot()</a></code> for each population.</p></li>
</ul></div>



<div class="section">
<h3 id="raw-false">raw = FALSE<a class="anchor" aria-label="anchor" href="#raw-false"></a></h3>
<p>a data frame with the statistic observations,
estimates, and confidence intervals in columns, and populations in rows. Note
that the confidence intervals are converted to characters and rounded to
three decimal places.</p>
</div>


    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<div class="section">
<h3 id="bootstrapping">Bootstrapping<a class="anchor" aria-label="anchor" href="#bootstrapping"></a></h3>
<p>For details on the bootstrapping procedures, see
<code><a href="diversity_boot.html">diversity_boot()</a></code>. Default bootstrapping is performed by
sampling <strong>N</strong> samples from a multinomial distribution weighted by the
relative multilocus genotype abundance per population where <strong>N</strong> is
equal to the number of samples in the data set. If <strong>n.boot</strong> &gt; 2,
then <strong>n.boot</strong> samples are taken at each bootstrap replicate. When
<code>rarefy = TRUE</code>, then samples are taken at the smallest population
size without replacement. This will provide confidence intervals for all
but the smallest population.</p>
</div>
<div class="section">
<h3 id="confidence-intervals">Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a></h3>
<p>Confidence intervals are derived from the function
<code><a href="https://rdrr.io/pkg/boot/man/norm.ci.html" class="external-link">boot::norm.ci()</a></code>. This function will attempt to correct for bias
between the observed value and the bootstrapped estimate. When <code>center = TRUE</code> (default), the confidence interval is calculated from the
bootstrapped distribution and centered around the bias-corrected estimate
as prescribed in Marcon (2012). This method can lead to undesirable
properties, such as the confidence interval lying outside of the maximum
possible value. For rarefaction, the confidence interval is simply
determined by calculating the percentiles from the bootstrapped
distribution. If you want to calculate your own confidence intervals, you
can use the results of the permutations stored in the <code>$boot</code> element
of the output.</p>
</div>
<div class="section">
<h3 id="rarefaction">Rarefaction<a class="anchor" aria-label="anchor" href="#rarefaction"></a></h3>
<p>Rarefaction in the sense of this function is simply sampling a subset of
the data at size <strong>n.rare</strong>. The estimates derived from this method
have straightforward interpretations and allow you to compare diversity
across populations since you are controlling for sample size.</p>
</div>
<div class="section">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a></h3>
<p>Results are plotted as boxplots with point
estimates. If there is no rarefaction applied, confidence intervals are
displayed around the point estimates. The boxplots represent the actual
values from the bootstrapping and will often appear below the estimates and
confidence intervals.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    
<div class="section">
<h3 id="confidence-interval-calculation">Confidence interval calculation<a class="anchor" aria-label="anchor" href="#confidence-interval-calculation"></a></h3>
<p>Almost all of the statistics
supplied here have a maximum when all genotypes are equally represented.
This means that bootstrapping the samples will always be downwardly biased.
In many cases, the confidence intervals from the bootstrapped distribution
will fall outside of the observed statistic. The reported confidence
intervals here are reported by assuming the variance of the bootstrapped
distribution is the same as the variance around the observed statistic. As
different statistics have different properties, there will not always be
one clear method for calculating confidence intervals. A suggestion for
correction in Shannon's index is to center the CI around the observed
statistic (Marcon, 2012), but there are theoretical limitations to this.
For details, see <a href="https://stats.stackexchange.com/q/156235/49413" class="external-link">https://stats.stackexchange.com/q/156235/49413</a>.</p>
</div>

<div class="section">
<h3 id="user-defined-functions">User-defined functions<a class="anchor" aria-label="anchor" href="#user-defined-functions"></a></h3>
<p>While it is possible to use custom functions with this, there are three
important things to remember when using these functions:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fl">1.</span> The <span class="cf">function</span> must return a single value. </span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fl">2.</span> The <span class="cf">function</span> must allow <span class="cf">for</span> both matrix and vector inputs </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fl">3.</span> The <span class="cf">function</span> name cannot match or partially match any arguments </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>from [boot<span class="sc">::</span><span class="fu">boot</span>()]</span></code></pre><p></p></div>
<p>Anonymous functions are okay <br>(e.g. <code>function(x) vegan::rarefy(t(as.matrix(x)), 10)</code>).</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition
of Shannon’s Entropy and a Confidence Interval for Beta Diversity.
<em>Oikos</em> 121(4): 516-522.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="diversity_boot.html">diversity_boot()</a></code> <code><a href="diversity_stats.html">diversity_stats()</a></code>
<code><a href="poppr.html">poppr()</a></code> <code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot()</a></code> <code><a href="https://rdrr.io/pkg/boot/man/norm.ci.html" class="external-link">boot::norm.ci()</a></code>
<code><a href="https://rdrr.io/pkg/boot/man/boot.ci.html" class="external-link">boot::boot.ci()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Zhian N. Kamvar</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://grunwaldlab.github.io/poppr/" class="external-link">poppr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">diversity_ci</span><span class="op">(</span><span class="va">Pinf</span>, n <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Confidence Intervals have been centered around observed statistic.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Please see ?diversity_ci for details.</span>
<span class="r-plt img"><img src="diversity_ci-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pop                    H        G    lambda       E.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   South America 3.267944 23.29032 0.9570637 0.8825297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   North America 3.687013 34.90909 0.9713542 0.8711297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total         4.188215 57.78125 0.9826933 0.8748360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pop                    H        G    lambda       E.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   South America 2.810714 14.50911 0.9293629 0.8545902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   North America 3.197910 21.22096 0.9521007 0.8553062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total         3.723559 35.49926 0.9715603 0.8504923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Pop = South America</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI              H        G    lambda       E.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.5 %  3.015398 18.99547 0.9339777 0.7946645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   97.5 % 3.520490 27.58517 0.9801498 0.9703949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Pop = North America</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI              H        G    lambda       E.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.5 %  3.508988 29.77002 0.9587624 0.7726727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   97.5 % 3.865038 40.04816 0.9839460 0.9695868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Pop = Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI              H        G    lambda       E.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.5 %  4.053701 51.09567 0.9770752 0.7956329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   97.5 % 4.322728 64.46683 0.9883115 0.9540391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $boot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $boot$`South America`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PARAMETRIC BOOTSTRAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap Statistics :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       original      bias    std. error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t1*  3.2679442 -0.45723059  0.12885234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t2* 23.2903226 -8.78121073  2.19128951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t3*  0.9570637 -0.02770083  0.01177882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t4*  0.8825297 -0.02793955  0.04483001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $boot$`North America`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PARAMETRIC BOOTSTRAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap Statistics :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       original       bias    std. error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t1*  3.6870132  -0.48910283 0.090830659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t2* 34.9090909 -13.68813373 2.622024383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t3*  0.9713542  -0.01925347 0.006424512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t4*  0.8711297  -0.01582350 0.050234108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $boot$Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PARAMETRIC BOOTSTRAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap Statistics :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       original       bias    std. error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t1*  4.1882146  -0.46465576 0.068630576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t2* 57.7812500 -22.28198749 3.411071183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t3*  0.9826933  -0.01113304 0.002866475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t4*  0.8748360  -0.02434370 0.040410486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># With pretty results</span></span></span>
<span class="r-in"><span><span class="fu">diversity_ci</span><span class="op">(</span><span class="va">Pinf</span>, n <span class="op">=</span> <span class="fl">100L</span>, raw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Confidence Intervals have been centered around observed statistic.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Please see ?diversity_ci for details.</span>
<span class="r-plt img"><img src="diversity_ci-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  H H.est           H.ci    G G.est             G.ci lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> South America 3.27  2.84 (3.065, 3.471) 23.3  14.8 (19.394, 27.186)  0.957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> North America 3.69  3.18 (3.492, 3.882) 34.9  20.9  (29.778, 40.04)  0.971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         4.19  3.71 (4.024, 4.353) 57.8  35.0 (49.827, 65.736)  0.983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               lambda.est      lambda.ci   E.5 E.5.est         E.5.ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> South America      0.931 (0.938, 0.976) 0.883   0.851 (0.787, 0.978)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> North America      0.951 (0.956, 0.986) 0.871   0.857 (0.781, 0.961)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total              0.971 (0.976, 0.989) 0.875   0.849 (0.794, 0.955)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This can be done in a parallel fasion (OSX uses "multicore", Windows uses "snow")</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">diversity_ci</span><span class="op">(</span><span class="va">Pinf</span>, <span class="fl">10000L</span>, parallel <span class="op">=</span> <span class="st">"multicore"</span>, ncpus <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Confidence Intervals have been centered around observed statistic.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Please see ?diversity_ci for details.</span>
<span class="r-plt img"><img src="diversity_ci-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5.553   2.171   3.259 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">diversity_ci</span><span class="op">(</span><span class="va">Pinf</span>, <span class="fl">10000L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Confidence Intervals have been centered around observed statistic.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Please see ?diversity_ci for details.</span>
<span class="r-plt img"><img src="diversity_ci-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3.543   0.126   3.848 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We often get many requests for a clonal fraction statistic. As this is </span></span></span>
<span class="r-in"><span><span class="co"># simply the number of observed MLGs over the number of samples, we </span></span></span>
<span class="r-in"><span><span class="co"># recommended that people calculate it themselves. With this function, you</span></span></span>
<span class="r-in"><span><span class="co"># can add it in:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CF</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># Show pretty results</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">diversity_ci</span><span class="op">(</span><span class="va">Pinf</span>, <span class="fl">1000L</span>, CF <span class="op">=</span> <span class="va">CF</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, raw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Confidence Intervals have been centered around observed statistic.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Please see ?diversity_ci for details.</span>
<span class="r-plt img"><img src="diversity_ci-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  H H.est           H.ci    G G.est             G.ci lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> South America 3.27  2.84 (3.043, 3.493) 23.3  15.0 (19.182, 27.399)  0.957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> North America 3.69  3.18  (3.49, 3.884) 34.9  20.9  (29.449, 40.37)  0.971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         4.19  3.71 (4.039, 4.337) 57.8  35.2 (50.814, 64.748)  0.983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               lambda.est      lambda.ci   E.5 E.5.est         E.5.ci    CF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> South America      0.932 (0.937, 0.977) 0.883   0.856 (0.792, 0.973) 0.763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> North America      0.951 (0.958, 0.985) 0.871   0.852 (0.777, 0.965) 0.896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total              0.971 (0.977, 0.989) 0.875   0.850 (0.804, 0.945) 0.837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               CF.est          CF.ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> South America  0.528 (0.665, 0.862)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> North America  0.583 (0.808, 0.984)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          0.558 (0.771, 0.903)</span>
<span class="r-in"><span><span class="fu">diversity_ci</span><span class="op">(</span><span class="va">Pinf</span>, <span class="fl">1000L</span>, CF <span class="op">=</span> <span class="va">CF</span>, rarefy <span class="op">=</span> <span class="cn">TRUE</span>, raw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Samples for rarefaction: 38</span>
<span class="r-plt img"><img src="diversity_ci-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  H H.est           H.ci    G G.est             G.ci lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> South America 3.27  3.27           &lt;NA&gt; 23.3  23.3             &lt;NA&gt;  0.957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> North America 3.69  3.48 (3.405, 3.565) 34.9  29.5 (25.786, 34.381)  0.971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         4.19  3.50 (3.355, 3.601) 57.8  31.5   (25.786, 36.1)  0.983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               lambda.est      lambda.ci   E.5 E.5.est         E.5.ci    CF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> South America      0.957           &lt;NA&gt; 0.883   0.883           &lt;NA&gt; 0.763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> North America      0.966 (0.961, 0.971) 0.871   0.904 (0.851, 0.972) 0.896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total              0.968 (0.961, 0.972) 0.875   0.944 (0.873, 0.985) 0.837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               CF.est          CF.ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> South America  0.763           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> North America  0.906 (0.868, 0.947)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          0.909 (0.816, 0.974)</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

