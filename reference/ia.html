<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate the Index of Association and Standardized Index of Association."><title>Index of Association — ia • poppr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Index of Association — ia"><meta property="og:description" content="Calculate the Index of Association and Standardized Index of Association."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">poppr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    <a class="dropdown-item" href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Index of Association</h1>
      <small class="dont-index">Source: <a href="https://github.com/grunwaldlab/poppr/blob/HEAD/R/Index_calculations.r" class="external-link"><code>R/Index_calculations.r</code></a>, <a href="https://github.com/grunwaldlab/poppr/blob/HEAD/R/ia_jackknife.R" class="external-link"><code>R/ia_jackknife.R</code></a></small>
      <div class="d-none name"><code>ia.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate the Index of Association and Standardized Index of Association.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ia</span><span class="op">(</span></span>
<span>  <span class="va">gid</span>,</span>
<span>  sample <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  method <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  missing <span class="op">=</span> <span class="st">"ignore"</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hist <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  index <span class="op">=</span> <span class="st">"rbarD"</span>,</span>
<span>  valuereturn <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pair.ia</span><span class="op">(</span></span>
<span>  <span class="va">gid</span>,</span>
<span>  sample <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  low <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  high <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  index <span class="op">=</span> <span class="st">"rbarD"</span>,</span>
<span>  method <span class="op">=</span> <span class="fl">1L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">resample.ia</span><span class="op">(</span><span class="va">gid</span>, n <span class="op">=</span> <span class="cn">NULL</span>, reps <span class="op">=</span> <span class="fl">999</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span>, use_psex <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">jack.ia</span><span class="op">(</span><span class="va">gid</span>, n <span class="op">=</span> <span class="cn">NULL</span>, reps <span class="op">=</span> <span class="fl">999</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>gid</dt>
<dd><p>a <code><a href="https://rdrr.io/pkg/adegenet/man/new.genind.html" class="external-link">adegenet::genind()</a></code> or <code><a href="genclone-class.html">genclone()</a></code> object.</p></dd>


<dt>sample</dt>
<dd><p>an integer indicating the number of permutations desired
(eg 999).</p></dd>


<dt>method</dt>
<dd><p>an integer from 1 to 4 indicating the sampling method desired.
see <code><a href="shufflepop.html">shufflepop()</a></code> for details.</p></dd>


<dt>quiet</dt>
<dd><p>Should the function print anything to the screen while it is
performing calculations?
<code>TRUE</code> prints nothing.
<code>FALSE</code> (default) will print the population name and progress bar.</p></dd>


<dt>missing</dt>
<dd><p>a character string. see <code><a href="missingno.html">missingno()</a></code> for details.</p></dd>


<dt>plot</dt>
<dd><p>When <code>TRUE</code> (default), a heatmap of the values per locus pair
will be plotted (for <code>pair.ia()</code>). When <code>sampling &gt; 0</code>, different things
happen with <code>ia()</code> and <code>pair.ia()</code>. For <code>ia()</code>, a histogram for the data
set is plotted. For <code>pair.ia()</code>, p-values are added as text on the
heatmap.</p></dd>


<dt>hist</dt>
<dd><p><code>logical</code> Deprecated. Use plot.</p></dd>


<dt>index</dt>
<dd><p><code>character</code> either "Ia" or "rbarD". If <code>hist = TRUE</code>,
this indicates which index you want represented in the plot (default:
"rbarD").</p></dd>


<dt>valuereturn</dt>
<dd><p><code>logical</code> if <code>TRUE</code>, the index values from the
reshuffled data is returned. If <code>FALSE</code> (default), the index is
returned with associated p-values in a 4 element numeric vector.</p></dd>


<dt>low</dt>
<dd><p>(for pair.ia) a color to use for low values when `plot =
TRUE`</p></dd>


<dt>high</dt>
<dd><p>(for pair.ia) a color to use for low values when `plot =
TRUE`</p></dd>


<dt>limits</dt>
<dd><p>(for pair.ia) the limits to be used for the color scale. 
Defaults to `NULL`. If you want to use a custom range, supply two
numbers between -1 and 1, (e.g. `limits = c(-0.15, 1)`)</p></dd>


<dt>n</dt>
<dd><p>an integer specifying the number of samples to be drawn. Defaults to
<code>NULL</code>, which then uses the number of multilocus genotypes.</p></dd>


<dt>reps</dt>
<dd><p>an integer specifying the number of replicates to perform. 
Defaults to 999.</p></dd>


<dt>use_psex</dt>
<dd><p>a logical. If <code>TRUE</code>, the samples will be weighted by the value 
of psex. Defaults to <code>FALSE</code>.</p></dd>


<dt>...</dt>
<dd><p>arguments passed on to <code><a href="psex.html">psex</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<div class="section">
<h3 id="for-pair-ia-">for <code>pair.ia()</code><a class="anchor" aria-label="anchor" href="#for-pair-ia-"></a></h3>


<p>A matrix with two columns and choose(nLoc(gid), 2) rows representing the
values for Ia and rbarD per locus pair.</p>
</div>



<div class="section">
<h3 id="if-no-sampling-has-occurred-">If no sampling has occurred:<a class="anchor" aria-label="anchor" href="#if-no-sampling-has-occurred-"></a></h3>


<p>A named number vector of length 2 giving the Index of Association, "Ia";
and the Standardized Index of Association, "rbarD"</p>
</div>



<div class="section">
<h3 id="if-there-is-sampling-">If there is sampling:<a class="anchor" aria-label="anchor" href="#if-there-is-sampling-"></a></h3>


<p>A a named numeric vector of length 4 with the following values:</p><ul><li><p>Ia - numeric. The index of association.</p></li>
<li><p>p.Ia - A number indicating the p-value resulting from a one-sided
permutation test based on the number of samples indicated in the
original call.</p></li>
<li><p>rbarD - numeric. The standardized index of association.</p></li>
<li><p>p.rD - A factor indicating the p-value resulting from a
one-sided permutation test based on the number of samples indicated in
the original call.</p></li>
</ul></div>



<div class="section">
<h3 id="if-there-is-sampling-and-valureturn-true">If there is sampling and <code>valureturn = TRUE</code><a class="anchor" aria-label="anchor" href="#if-there-is-sampling-and-valureturn-true"></a></h3>


<p>A list with the following elements:</p><ul><li><p>index The above vector</p></li>
<li><p>samples A data frame with s by 2 column data frame where s is the
number of samples defined. The columns are for the values of Ia and
rbarD, respectively.</p></li>
</ul></div>



<div class="section">
<h3 id="resample-ia-">resample.ia()<a class="anchor" aria-label="anchor" href="#resample-ia-"></a></h3>
<p>a data frame with the index of association and standardized index of
association in columns. Number of rows represents the number of reps.</p>
</div>


    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<ul><li><p><code>ia()</code> calculates the index of association over all loci in the data set.</p></li>
<li><p><code>pair.ia()</code> calculates the index of association in a pairwise manner
among all loci.</p></li>
<li><p><code>resample.ia()</code> calculates the index of association on a reduced data set
multiple times to create a distribution, showing the variation of values
observed at a given sample size (previously <code>jack.ia()</code>).</p></li>
</ul><p>The index of association was originally developed by A.H.D. Brown analyzing
population structure of wild barley (Brown, 1980). It has been widely used
as a tool to detect clonal reproduction within populations . Populations
whose members are undergoing sexual reproduction, whether it be selfing or
out-crossing, will produce gametes via meiosis, and thus have a chance to
shuffle alleles in the next generation. Populations whose members are
undergoing clonal reproduction, however, generally do so via mitosis. This
means that the most likely mechanism for a change in genotype is via
mutation. The rate of mutation varies from species to species, but it is
rarely sufficiently high to approximate a random shuffling of alleles. The
index of association is a calculation based on the ratio of the variance of
the raw number of differences between individuals and the sum of those
variances over each locus . You can also think of it as the observed
variance over the expected variance. If they  are the same, then the index
is zero after subtracting one (from Maynard-Smith, 1993):
$$I_A = \frac{V_O}{V_E}-1$$</p>
<p>Since the distance is more or less a binary distance, any sort of marker can
be used for this analysis. In the calculation, phase is not considered, and
any difference increases the distance between two individuals. Remember that
each column represents a different allele and that each entry in the table
represents the fraction of the genotype made up by that allele at that
locus. Notice also that the sum of the rows all equal one. Poppr uses this
to calculate distances by simply taking the sum of the absolute values of
the differences between rows.</p>
<p>The calculation for the distance between two individuals at a single locus
with <em>a</em> allelic states and a ploidy of <em>k</em> is as follows (except
for Presence/Absence data):</p>
<p>$$ d = \displaystyle \frac{k}{2}\sum_{i=1}^{a} \mid A_{i} - B_{i}\mid$$</p>
<p>To find the total number of differences between two individuals over all
loci, you just take <em>d</em> over <em>m</em> loci, a value we'll call
<em>D</em>:</p>
<p>$$D = \displaystyle \sum_{i=1}^{m} d_i $$</p>
<p>These values are calculated over all possible combinations of individuals
in the data set, \({n \choose 2}\) after which you end up
with \({n \choose 2}\cdot{}m\) values of <em>d</em> and
\({n \choose 2}\) values of <em>D</em>. Calculating the
observed variances is fairly straightforward (modified from Agapow and
Burt, 2001):</p>
<p>$$ V_O = \frac{\displaystyle \sum_{i=1}^{n \choose 2} D_{i}^2 - 
\frac{(\displaystyle\sum_{i=1}^{n \choose 2} D_{i})^2}{{n \choose 2}}}{{n 
\choose 2}}$$</p>
<p>Calculating the expected variance is the sum of each of the variances of the
individual loci. The calculation at a single locus, <em>j</em> is the same as
the previous equation, substituting values of <em>D</em> for <em>d</em>:</p>
<p>$$ var_j = \frac{\displaystyle \sum_{i=1}^{n \choose 2} d_{i}^2 - 
\frac{(\displaystyle\sum_{i=1}^{n \choose 2} d_i)^2}{{n \choose 2}}}{{n 
\choose 2}} $$</p>
<p>The expected variance is then the sum of all the variances over all <em>m</em>
loci:</p>
<p>$$ V_E = \displaystyle \sum_{j=1}^{m} var_j $$</p>
<p>Agapow and Burt showed that \(I_A\) increases steadily with the number
of loci, so they came up with an approximation that is widely used,
\(\bar r_d\). For the derivation, see the manual for
<em>multilocus</em>.</p>
<p>$$ \bar r_d = \frac{V_O - V_E} {2\displaystyle 
\sum_{j=1}^{m}\displaystyle \sum_{k \neq j}^{m}\sqrt{var_j\cdot{}var_k}} 
$$</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><code>jack.ia()</code> is deprecated as the name was misleading. Please use
<code>resample.ia()</code></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Paul-Michael Agapow and Austin Burt. Indices of multilocus
linkage disequilibrium. <em>Molecular Ecology Notes</em>, 1(1-2):101-102,
2001</p>
<p>A.H.D. Brown, M.W. Feldman, and E. Nevo. Multilocus structure of natural
populations of <em>Hordeum spontaneum</em>. <em>Genetics</em>, 96(2):523-536, 1980.</p>
<p>J M Smith, N H Smith, M O'Rourke, and B G Spratt. How clonal are bacteria?
Proceedings of the National Academy of Sciences, 90(10):4384-4388, 1993.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="poppr.html">poppr()</a></code>, <code><a href="missingno.html">missingno()</a></code>,
<code><a href="https://rdrr.io/pkg/adegenet/man/import2genind.html" class="external-link">import2genind()</a></code>, <code><a href="read.genalex.html">read.genalex()</a></code>,
<code><a href="clonecorrect.html">clonecorrect()</a></code>, <code><a href="win.ia.html">win.ia()</a></code>, <code><a href="samp.ia.html">samp.ia()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Zhian N. Kamvar</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">nancycats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ia</span><span class="op">(</span><span class="va">nancycats</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.17207262 0.02178965 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pairwise over all loci:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">partial_clone</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pair.ia</span><span class="op">(</span><span class="va">partial_clone</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ia-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"green"</span>, index <span class="op">=</span> <span class="st">"Ia"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ia-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Resampling</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">resample.ia</span><span class="op">(</span><span class="va">Pinf</span>, reps <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Ia      rbarD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.6501982 0.07093833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.8256286 0.09057133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.4231684 0.04623043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.6277631 0.06854268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.7032604 0.07697910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.6764791 0.07411652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.7627602 0.08376810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.6389609 0.06977151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.7841983 0.08570989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.6195379 0.06812260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.7605239 0.08751298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 0.7942110 0.08701043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 0.6059280 0.06675097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 0.6299434 0.06923696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 0.5638179 0.06169467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 0.6379127 0.07007583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 0.6960176 0.07630673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 0.7248024 0.07939282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 0.7008263 0.07667522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 0.4658464 0.05324204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 0.5385327 0.05893106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 0.5825171 0.06370222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 0.6904987 0.07549761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 0.6820235 0.07817614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 0.7170443 0.07867977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 0.7454600 0.08233780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 0.5887406 0.06441081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 0.6312326 0.06897246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 0.6593338 0.07259843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 0.5476437 0.05981975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 0.6912756 0.07928548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 0.7823573 0.08621459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 0.6800208 0.07426381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 0.7542653 0.08258429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 0.7014704 0.07703452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 0.6013052 0.06573002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 0.6833382 0.07467048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 0.5814739 0.06347431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 0.6779095 0.07404344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 0.7512745 0.08220176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 0.6809989 0.07811553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 0.6902944 0.07606066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 0.6111562 0.06714608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 0.7768184 0.08522498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 0.8038261 0.08789452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 0.6519288 0.07106003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 0.6015505 0.06595567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 0.7307723 0.08011669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 0.7786746 0.08914556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 0.6405280 0.07014232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51 0.5461233 0.06019438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52 0.7789662 0.08533309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53 0.6231572 0.06804370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54 0.6506544 0.07150263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55 0.6572602 0.07574286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56 0.6775073 0.07427077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57 0.7315283 0.08022850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58 0.6429697 0.07043269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59 0.6858775 0.07858277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60 0.7788526 0.08975278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61 0.5810050 0.06378772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62 0.7646678 0.08367388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63 0.5923618 0.06438076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64 0.6377337 0.06984813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65 0.7351625 0.08469701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66 0.6729850 0.07367359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67 0.6730470 0.07376535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68 0.6628730 0.07253585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69 0.6429248 0.07001100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70 0.6977442 0.07603908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71 0.5948796 0.06497293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72 0.6957663 0.07623048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73 0.7108436 0.07780428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74 0.6202232 0.06828203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75 0.6192190 0.06760712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76 0.5960247 0.06515301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77 0.7035341 0.08045609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78 0.7169920 0.07916178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79 0.6357226 0.06987920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80 0.8864959 0.10157407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81 0.7207755 0.07877351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82 0.6256714 0.06835729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83 0.6528963 0.07503376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84 0.5997759 0.06541564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85 0.6834416 0.07857675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86 0.6098177 0.07023320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87 0.6764721 0.07385135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88 0.6675123 0.07364553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89 0.8096862 0.08858310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90 0.5652613 0.06194018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91 0.6005300 0.06599025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92 0.5854640 0.06417910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93 0.6862173 0.07531431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94 0.7341306 0.08065948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 0.7370794 0.08091394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96 0.6610314 0.07226520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97 0.5200685 0.05694612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98 0.6360764 0.07258663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99 0.7294001 0.07977655</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pairwise IA with p-values (this will take about a minute)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pair.ia</span><span class="op">(</span><span class="va">partial_clone</span>, sample <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ia-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           Ia  p.Ia       rbarD  p.rD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Locus_1:Locus_2 -0.007935313 0.498 -0.00827841 0.499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Locus_1:Locus_3  0.269326856 0.001  0.27484539 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Locus_1:Locus_4  0.320892032 0.001  0.33749005 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Locus_1:Locus_5 -0.003553671 0.503 -0.00375937 0.503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Locus_1:Locus_6  0.133939476 0.032  0.13782217 0.030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Locus_1:Locus_7  0.504438856 0.001  0.54150373 0.001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the results of resampling rbarD. </span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Pinf.resamp</span> <span class="op">&lt;-</span> <span class="fu">resample.ia</span><span class="op">(</span><span class="va">Pinf</span>, reps <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pinf.resamp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rbarD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu">ia</span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu">ia</span><span class="op">(</span><span class="fu"><a href="clonecorrect.html">clonecorrect</a></span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">bar</span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">[</span><span class="va">d</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="r-plt img"><img src="ia-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the indices back and plot the distributions.</span></span></span>
<span class="r-in"><span><span class="va">nansamp</span> <span class="op">&lt;-</span> <span class="fu">ia</span><span class="op">(</span><span class="va">nancycats</span>, sample <span class="op">=</span> <span class="fl">999</span>, valuereturn <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ia-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nansamp</span>, index <span class="op">=</span> <span class="st">"Ia"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ia-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nansamp</span>, index <span class="op">=</span> <span class="st">"rbarD"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ia-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can also adjust the parameters for how large to display the text</span></span></span>
<span class="r-in"><span><span class="co"># so that it's easier to export it for publication/presentations.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nansamp</span>, labsize <span class="op">=</span> <span class="fl">5</span>, linesize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>                                      <span class="co"># adding a theme</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>       <span class="co"># changing text size</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># changing title size</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Index of Association of nancycats"</span><span class="op">)</span>      <span class="co"># adding a new title</span></span></span>
<span class="r-plt img"><img src="ia-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the index for each population.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/seppop.html" class="external-link">seppop</a></span><span class="op">(</span><span class="va">nancycats</span><span class="op">)</span>, <span class="va">ia</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.16564272 0.02105965 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.18176676 0.02301615 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.35461940 0.04517282 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.44944509 0.05634184 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Ia        rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.047539953 -0.006004254 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.33370148 0.04261598 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.25691744 0.03259883 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.23877871 0.03012163 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ia     rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.0845196 0.2636454 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.59550982 0.07627372 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ia     rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2846571 0.0362703 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.48988697 0.06428403 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ia     rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1855035 0.0236618 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ia     rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2210061 0.0282276 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.69325774 0.08726678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia      rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.23450449 0.02950446 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Ia       rbarD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.09055833 -0.01378538 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># With sampling</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/seppop.html" class="external-link">seppop</a></span><span class="op">(</span><span class="va">nancycats</span><span class="op">)</span>, <span class="va">ia</span>, sample <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ia-9.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-10.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-11.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-12.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-13.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-14.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-15.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-16.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-17.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-18.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-19.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-20.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-21.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-22.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-23.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-24.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-25.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.16564272 0.24100000 0.02105965 0.24100000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.18176676 0.06900000 0.02301615 0.06400000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.35461940 0.04200000 0.04517282 0.04200000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.44944509 0.00100000 0.05634184 0.00100000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Ia         p.Ia        rbarD         p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.047539953  0.567000000 -0.006004254  0.566000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.33370148 0.05100000 0.04261598 0.05100000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.25691744 0.10100000 0.03259883 0.10100000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.23877871 0.14700000 0.03012163 0.14700000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ia      p.Ia     rbarD      p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.0845196 0.0010000 0.2636454 0.0010000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.59550982 0.00400000 0.07627372 0.00300000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ia      p.Ia     rbarD      p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2846571 0.3230000 0.0362703 0.3250000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.48988697 0.01200000 0.06428403 0.01200000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ia      p.Ia     rbarD      p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1855035 0.1660000 0.0236618 0.1640000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ia      p.Ia     rbarD      p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2210061 0.0700000 0.0282276 0.0700000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.69325774 0.00500000 0.08726678 0.00500000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ia       p.Ia      rbarD       p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.23450449 0.11800000 0.02950446 0.11800000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $P17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Ia        p.Ia       rbarD        p.rD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.09055833  0.66300000 -0.01378538  0.66500000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot pairwise ia for all populations in a grid with cowplot</span></span></span>
<span class="r-in"><span><span class="co"># Set up the library and data</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://wilkelab.org/cowplot/" class="external-link">"cowplot"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">monpop</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/strata-methods.html" class="external-link">splitStrata</a></span><span class="op">(</span><span class="va">monpop</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">~</span><span class="va">Tree</span><span class="op">/</span><span class="va">Year</span><span class="op">/</span><span class="va">Symptom</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/population-methods.html" class="external-link">setPop</a></span><span class="op">(</span><span class="va">monpop</span><span class="op">)</span>      <span class="op">&lt;-</span> <span class="op">~</span><span class="va">Tree</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Need to set up a list in which to store the plots.</span></span></span>
<span class="r-in"><span><span class="va">plotlist</span>        <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">nPop</a></span><span class="op">(</span><span class="va">monpop</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">plotlist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">popNames</a></span><span class="op">(</span><span class="va">monpop</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Loop throgh the populations, calculate pairwise ia, plot, and then</span></span></span>
<span class="r-in"><span><span class="co"># capture the plot in the list</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">popNames</a></span><span class="op">(</span><span class="va">monpop</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">pair.ia</span><span class="op">(</span><span class="va">monpop</span><span class="op">[</span>pop <span class="op">=</span> <span class="va">i</span><span class="op">]</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.15</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># subset, calculate, and plot</span></span></span>
<span class="r-in"><span>  <span class="va">plotlist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># save the last plot</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="ia-26.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-27.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-28.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="ia-29.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the plot_grid function to plot.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plotlist</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Tree"</span>, <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">popNames</a></span><span class="op">(</span><span class="va">monpop</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ia-30.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

