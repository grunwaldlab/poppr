<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function is intended to perform bootstrap statistics on a matrix of
multilocus genotype counts in different populations. Results from this
function should be interpreted carefully as the default statistics are known
to have a downward bias. See the details for more information."><title>Perform a bootstrap analysis on diversity statistics — diversity_boot • poppr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform a bootstrap analysis on diversity statistics — diversity_boot"><meta property="og:description" content="This function is intended to perform bootstrap statistics on a matrix of
multilocus genotype counts in different populations. Results from this
function should be interpreted carefully as the default statistics are known
to have a downward bias. See the details for more information."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">poppr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    <a class="dropdown-item" href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Perform a bootstrap analysis on diversity statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/grunwaldlab/poppr/blob/HEAD/R/bootstraping.R" class="external-link"><code>R/bootstraping.R</code></a></small>
      <div class="d-none name"><code>diversity_boot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is intended to perform bootstrap statistics on a matrix of
multilocus genotype counts in different populations. Results from this
function should be interpreted carefully as the default statistics are known
to have a downward bias. See the details for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">diversity_boot</span><span class="op">(</span></span>
<span>  <span class="va">tab</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  n.boot <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  n.rare <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  H <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  G <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  E5 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tab</dt>
<dd><p>a table produced from the <span class="pkg">poppr</span> function
<code><a href="mlg.html">mlg.table()</a></code>. MLGs in columns and populations in rows</p></dd>


<dt>n</dt>
<dd><p>an integer &gt; 0 specifying the number of bootstrap replicates to
perform (corresponds to <code>R</code> in the function <code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot()</a></code>.</p></dd>


<dt>n.boot</dt>
<dd><p>an integer specifying the number of samples to be drawn in each
bootstrap replicate. If <code>n.boot</code> &lt; 2 (default), the number of samples
drawn for each bootstrap replicate will be equal to the number of samples in
the data set.</p></dd>


<dt>n.rare</dt>
<dd><p>a sample size at which all resamplings should be performed.
This should be no larger than the smallest sample size. Defaults to
<code>NULL</code>, indicating that each population will be sampled at its own
size.</p></dd>


<dt>H</dt>
<dd><p>logical whether or not to calculate Shannon's index</p></dd>


<dt>G</dt>
<dd><p>logical whether or not to calculate Stoddart and Taylor's index (aka
inverse Simpson's index).</p></dd>


<dt>lambda</dt>
<dd><p>logical whether or not to calculate Simpson's index</p></dd>


<dt>E5</dt>
<dd><p>logical whether or not to calculate Evenness</p></dd>


<dt>...</dt>
<dd><p>other parameters passed on to <code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot()</a></code> and
<code><a href="diversity_stats.html">diversity_stats()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a list of objects of class "boot".</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Bootstrapping is performed in three ways:</p><ul><li><p>if <code>n.rare</code> is a number greater than zero, then bootstrapping
is performed by randomly sampling without replacement <em>n.rare</em>
samples from the data.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>\item <span class="cf">if</span> <span class="st">`</span><span class="at">n.boot</span><span class="st">`</span> is greater than <span class="dv">1</span>, bootstrapping is performed by</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>sampling n.boot samples from a multinomial distribution weighted by the</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>proportion of each MLG <span class="cf">in</span> the data.</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>\item <span class="cf">if</span> <span class="st">`</span><span class="at">n.boot</span><span class="st">`</span> is less than <span class="dv">2</span>, bootstrapping is performed by </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sampling N samples from a multinomial distribution weighted by the</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>proportion of each MLG <span class="cf">in</span> the data.</span></code></pre><p></p></div></li>
</ul><div class="section">
<h3 id="downward-bias">Downward Bias<a class="anchor" aria-label="anchor" href="#downward-bias"></a></h3>
<p>When sampling with replacement, the diversity statistics here present a
downward bias partially due to the small number of samples in the data.
The result is that the mean of the bootstrapped samples will often be
much lower than the observed value. Alternatively, you can increase the
sample size of the bootstrap by increasing the size of <code>n.boot</code>. Both
of these methods should be taken with caution in interpretation. There
are several R packages freely available that will calculate and perform
bootstrap estimates of Shannon and Simpson diversity metrics (eg.
<span class="pkg">entropart</span>, <span class="pkg">entropy</span>, <span class="pkg">simboot</span>, and
<span class="pkg">EntropyEstimation</span>. These packages also offer unbiased estimators of
Shannon and Simpson diversity. Please take care when attempting to
interpret the results of this function.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="diversity_stats.html">diversity_stats()</a></code> for basic statistic calculation,
<code><a href="diversity_ci.html">diversity_ci()</a></code> for confidence intervals and plotting, and
<code><a href="poppr.html">poppr()</a></code>. For bootstrap sampling:
<code><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">stats::rmultinom()</a></code> <code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Zhian N. Kamvar</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://grunwaldlab.github.io/poppr/" class="external-link">poppr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="mlg.html">mlg.table</a></span><span class="op">(</span><span class="va">Pinf</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">diversity_boot</span><span class="op">(</span><span class="va">tab</span>, <span class="fl">10L</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`South America`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PARAMETRIC BOOTSTRAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap Statistics :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       original       bias    std. error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t1*  3.2679442 -0.408150065 0.105434202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t2* 23.2903226 -7.827538789 1.622159350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t3*  0.9570637 -0.022437673 0.007467245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t4*  0.8825297 -0.007866368 0.040895129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`North America`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PARAMETRIC BOOTSTRAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap Statistics :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       original        bias    std. error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t1*  3.6870132 -5.005028e-01  0.11329447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t2* 34.9090909 -1.351801e+01  2.93476936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t3*  0.9713542 -1.909722e-02  0.00816362</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t4*  0.8711297 -4.199509e-04  0.04615188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># This can be done in a parallel fashion (OSX uses "multicore", Windows uses "snow")</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">diversity_boot</span><span class="op">(</span><span class="va">tab</span>, <span class="fl">10000L</span>, parallel <span class="op">=</span> <span class="st">"multicore"</span>, ncpus <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3.955   2.159   3.277 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">diversity_boot</span><span class="op">(</span><span class="va">tab</span>, <span class="fl">10000L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.269   0.088   2.389 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

