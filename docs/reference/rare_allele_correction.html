<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Correcting rare allele frequencies — rare_allele_correction • poppr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Correcting rare allele frequencies — rare_allele_correction" />

<meta property="og:description" content="The following is a set of arguments for use in rraf, 
pgen, and psex to correct rare allele frequencies
that were lost in estimating round-robin allele frequencies." />
<meta name="twitter:card" content="summary" />
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">poppr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Correcting rare allele frequencies</h1>
    <small>Source: <a href='https:/github.com/grunwaldlab/poppr/blob/master/R/round_robin.R'><code>R/round_robin.R</code></a></small>
    </div>

    
    <p>The following is a set of arguments for use in <code><a href='rraf.html'>rraf</a></code>, 
<code><a href='pgen.html'>pgen</a></code>, and <code><a href='psex.html'>psex</a></code> to correct rare allele frequencies
that were lost in estimating round-robin allele frequencies.</p>
    

    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>e</th>
      <td><p>a numeric epsilon value to use for all missing allele frequencies.</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>the unit by which to take the reciprocal. <code>div = "sample"</code> will
be 1/(n samples), <code>d = "mlg"</code> will be 1/(n mlg), and <code>d = 
"rrmlg"</code> will be 1/(n mlg at that locus). This is overridden by <code>e</code>.</p></td>
    </tr>
    <tr>
      <th>mul</th>
      <td><p>a multiplier for div. Default is <code>mul = 1</code>. This parameter 
is overridden by <code>e</code></p></td>
    </tr>
    <tr>
      <th>sum_to_one</th>
      <td><p>when <code>TRUE</code>, the original frequencies will be reduced 
so that all allele frequencies will sum to one. <strong>Default: 
<code>FALSE</code></strong></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>By default (<code>d = "sample", e = NULL, sum_to_one = FALSE, mul =
1</code>), this will add 1/(n samples) to all zero-value alleles. The basic formula
is <strong>1/(d * m)</strong> unless <strong>e</strong> is specified. If <code>sum_to_one = 
TRUE</code>, then the frequencies will be scaled as x/sum(x) AFTER correction, 
indicating that the allele frequencies will be reduced. See the examples for 
details. The general pattern of correction is that the value of the MAF will 
be <em>rrmlg &gt; mlg &gt; sample</em></p>
    
    <h2 class="hasAnchor" id="motivation"><a class="anchor" href="#motivation"></a>Motivation</h2>

    
    <p>When <a href='rraf.html'>calculating allele frequencies from a round-robin
approach</a>, rare alleles are often lost resulting in zero-valued allele
frequencies (Arnaud-Haond et al. 2007, Parks and Werth 1993). This can be
problematic when calculating values for <code><a href='pgen.html'>pgen</a></code> and
<code><a href='psex.html'>psex</a></code> because frequencies of zero will result in undefined
values for samples that contain those rare alleles. The solution to this
problem is to give an estimate for the frequency of those rare alleles, but
the question of HOW to do that arises. These arguments provide a way to
define how rare alleles are to be estimated/corrected.</p>
    
    <h2 class="hasAnchor" id="using-these-arguments"><a class="anchor" href="#using-these-arguments"></a>Using these arguments</h2>

    
    <p>These arguments are for use in the functions <code><a href='rraf.html'>rraf</a></code>, 
<code><a href='pgen.html'>pgen</a></code>, and <code><a href='psex.html'>psex</a></code>. They will replace the dots (...) 
that appear at the end of the function call. For example, if you want to set 
the minor allele frequencies to a specific value (let's say 0.001),
regardless of locus, you can insert <code>e = 0.001</code> along with any other 
arguments (note, position is not specific):</p><pre>
pgen(my_data, e = 0.001, log = FALSE) 
psex(my_data, method = "multiple", e = 0.001)</pre>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Arnaud-Haond, S., Duarte, C. M., Alberto, F., &amp; Serrão, E. A. 2007.
Standardizing methods to address clonality in population studies.
<em>Molecular Ecology</em>, 16(24), 5115-5139.</p>
<p>Parks, J. C., &amp; Werth, C. R. 1993. A study of spatial features of clones in a
population of bracken fern, <em>Pteridium aquilinum</em> (Dennstaedtiaceae).
<em>American Journal of Botany</em>, 537-544.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='rraf.html'>rraf</a></code>, 
  <code><a href='pgen.html'>pgen</a></code>, 
  <code><a href='psex.html'>psex</a></code>, 
  <code><a href='rrmlg.html'>rrmlg</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'>data</span>(<span class='no'>Pram</span>)
<span class='co'>#-------------------------------------</span>

<span class='co'># If you set correction = FALSE, you'll notice the zero-valued alleles</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># By default, however, the data will be corrected by 1/n</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>)

<span class='co'># Of course, this is a diploid organism, we might want to set 1/2n</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>)

<span class='co'># To set MAF = 1/2mlg</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='st'>"mlg"</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>)

<span class='co'># Another way to think about this is, since these allele frequencies were</span>
<span class='co'># derived at each locus with different sample sizes, it's only appropriate to</span>
<span class='co'># correct based on those sample sizes.</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='st'>"rrmlg"</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>)

<span class='co'># If we were going to use these frequencies for simulations, we might want to</span>
<span class='co'># ensure that they all sum to one. </span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='st'>"mlg"</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>, <span class='kw'>sum_to_one</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>#-------------------------------------</span>
<span class='co'># When we calculate these frequencies based on population, they are heavily</span>
<span class='co'># influenced by the number of observed mlgs. </span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='st'>"rrmlg"</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>)

<span class='co'># This can be fixed by specifying a specific value</span>

<span class='fu'><a href='rraf.html'>rraf</a></span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>e</span> <span class='kw'>=</span> <span class='fl'>0.01</span>)

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#motivation">Motivation</a></li>

      <li><a href="#using-these-arguments">Using these arguments</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Zhian N. Kamvar

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

