<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Index of Association — ia • poppr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Index of Association — ia" />
<meta property="og:description" content="Calculate the Index of Association and Standardized Index of Association.
ia() calculates the index of association over all loci in
  the data set.
pair.ia() calculates the index of association in a pairwise
  manner among all loci.
resample.ia() calculates the index of association on a
  reduced data set multiple times to create a distribution, showing the
  variation of values observed at a given sample size (previously 
  jack.ia).

" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poppr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Index of Association</h1>
    <small class="dont-index">Source: <a href='https://github.com/grunwaldlab/poppr/blob/master/R/Index_calculations.r'><code>R/Index_calculations.r</code></a>, <a href='https://github.com/grunwaldlab/poppr/blob/master/R/ia_jackknife.R'><code>R/ia_jackknife.R</code></a></small>
    <div class="hidden name"><code>ia.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the Index of Association and Standardized Index of Association.</p><ul>
<li><p><code>ia()</code> calculates the index of association over all loci in
  the data set.</p></li>
<li><p><code>pair.ia()</code> calculates the index of association in a pairwise
  manner among all loci.</p></li>
<li><p><code>resample.ia()</code> calculates the index of association on a
  reduced data set multiple times to create a distribution, showing the
  variation of values observed at a given sample size (previously 
  <code>jack.ia</code>).</p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>ia</span><span class='op'>(</span>
  <span class='va'>gid</span>,
  sample <span class='op'>=</span> <span class='fl'>0</span>,
  method <span class='op'>=</span> <span class='fl'>1</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  missing <span class='op'>=</span> <span class='st'>"ignore"</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  hist <span class='op'>=</span> <span class='cn'>TRUE</span>,
  index <span class='op'>=</span> <span class='st'>"rbarD"</span>,
  valuereturn <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'>pair.ia</span><span class='op'>(</span>
  <span class='va'>gid</span>,
  sample <span class='op'>=</span> <span class='fl'>0L</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  low <span class='op'>=</span> <span class='st'>"blue"</span>,
  high <span class='op'>=</span> <span class='st'>"red"</span>,
  limits <span class='op'>=</span> <span class='cn'>NULL</span>,
  index <span class='op'>=</span> <span class='st'>"rbarD"</span>,
  method <span class='op'>=</span> <span class='fl'>1L</span>
<span class='op'>)</span>

<span class='fu'>resample.ia</span><span class='op'>(</span><span class='va'>gid</span>, n <span class='op'>=</span> <span class='cn'>NULL</span>, reps <span class='op'>=</span> <span class='fl'>999</span>, quiet <span class='op'>=</span> <span class='cn'>FALSE</span>, use_psex <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>jack.ia</span><span class='op'>(</span><span class='va'>gid</span>, n <span class='op'>=</span> <span class='cn'>NULL</span>, reps <span class='op'>=</span> <span class='fl'>999</span>, quiet <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gid</th>
      <td><p>a <code>genind</code> or <code><a href='genclone-class.html'>genclone</a></code> object.</p></td>
    </tr>
    <tr>
      <th>sample</th>
      <td><p>an integer indicating the number of permutations desired (eg 
999).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>an integer from 1 to 4 indicating the sampling method desired. 
see <code><a href='shufflepop.html'>shufflepop</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>Should the function print anything to the screen while it is 
performing calculations?</p>
<p><code>TRUE</code> prints nothing.</p>
<p><code>FALSE</code> (default) will print the population name and progress bar.</p></td>
    </tr>
    <tr>
      <th>missing</th>
      <td><p>a character string. see <code><a href='missingno.html'>missingno</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>When <code>TRUE</code> (default), a heatmap of the values per locus
pair will be plotted (for <code>pair.ia()</code>). When <code>sampling &gt; 0</code>, 
different things happen with <code>ia()</code> and <code>pair.ia()</code>. For 
<code>ia()</code>, a histogram for the data set is plotted. For <code>pair.ia()</code>,
p-values are added as text on the heatmap.</p></td>
    </tr>
    <tr>
      <th>hist</th>
      <td><p><code>logical</code> Deprecated. Use plot.</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p><code>character</code> either "Ia" or "rbarD". If <code>hist = TRUE</code>, 
this indicates which index you want represented in the plot (default:
"rbarD").</p></td>
    </tr>
    <tr>
      <th>valuereturn</th>
      <td><p><code>logical</code> if <code>TRUE</code>, the index values from the 
reshuffled data is returned. If <code>FALSE</code> (default), the index is 
returned with associated p-values in a 4 element numeric vector.</p></td>
    </tr>
    <tr>
      <th>low</th>
      <td><p>(for pair.ia) a color to use for low values when <code>plot =
TRUE</code></p></td>
    </tr>
    <tr>
      <th>high</th>
      <td><p>(for pair.ia) a color to use for low values when <code>plot =
TRUE</code></p></td>
    </tr>
    <tr>
      <th>limits</th>
      <td><p>(for pair.ia) the limits to be used for the color scale. 
Defaults to <code>NULL</code>. If you want to use a custom range, supply two
numbers between -1 and 1, (e.g. <code>limits = c(-0.15, 1)</code>)</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>an integer specifying the number of samples to be drawn. Defaults to
<code>NULL</code>, which then uses the number of multilocus genotypes.</p></td>
    </tr>
    <tr>
      <th>reps</th>
      <td><p>an integer specifying the number of replicates to perform. 
Defaults to 999.</p></td>
    </tr>
    <tr>
      <th>use_psex</th>
      <td><p>a logical. If <code>TRUE</code>, the samples will be weighted by the value 
of psex. Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed on to <code><a href='psex.html'>psex</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>for <code>pair.ia</code></h3>
<p>A matrix with two columns and choose(nLoc(gid), 2) rows representing the
  values for Ia and rbarD per locus pair.</p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>If no sampling has occurred:</h3>
<p>A named number vector of length 2 giving the Index of Association, "Ia";
  and the Standardized Index of Association, "rbarD"</p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>If there is sampling:</h3>
<p>A a named number vector of length 4
  with the following values:</p><ul>
<li><p>Ia - numeric. The index of association.</p></li>
<li><p>p.Ia - A number indicating the p-value resulting from a
    one-sided permutation test based on the number of samples indicated in
    the original call.</p></li>
<li><p>rbarD - numeric. The standardized index of association.</p></li>
<li><p>p.rD - A factor indicating the p-value resulting from a
    one-sided permutation test based on the number of samples indicated in
    the original call.</p></li>
</ul><p></p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>If there is sampling and valureturn = TRUE</h3>
<p>A list with the following elements:</p><ul>
<li><p>index The above vector</p></li>
<li><p>samples A data frame with s by 2 column data frame where s is the
    number of samples defined. The columns are for the values of Ia and
    rbarD, respectively.</p></li>
</ul><p></p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>resample.ia()</h3>
<p>a data frame with the index of association and standardized index of
association in columns. Number of rows represents the number of reps.</p>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The index of association was originally developed by A.H.D. Brown 
  analyzing population structure of wild barley (Brown, 1980). It has been widely 
  used as a tool to detect clonal reproduction within populations . 
  Populations whose members are undergoing sexual reproduction, whether it be
  selfing or out-crossing, will produce gametes via meiosis, and thus have a 
  chance to shuffle alleles in the next generation. Populations whose members
  are undergoing clonal reproduction, however, generally do so via mitosis. 
  This means that the most likely mechanism for a change in genotype is via 
  mutation. The rate of mutation varies from species to species, but it is 
  rarely sufficiently high to approximate a random shuffling of alleles. The 
  index of association is a calculation based on the ratio of the variance of
  the raw number of differences between individuals and the sum of those 
  variances over each locus . You can also think of it as the observed 
  variance over the expected variance. If they  are the same, then the index 
  is zero after subtracting one (from Maynard-Smith, 1993): $$I_A = 
  \frac{V_O}{V_E}-1$$ Since the distance is more or less a binary 
  distance, any sort of marker can be used for this analysis. In the 
  calculation, phase is not considered, and any difference increases the 
  distance between two individuals. Remember that each column represents a 
  different allele and that each entry in the table represents the fraction 
  of the genotype made up by that allele at that locus. Notice also that the 
  sum of the rows all equal one. Poppr uses this to calculate distances by 
  simply taking the sum of the absolute values of the differences between 
  rows.</p>  
<p>The calculation for the distance between two individuals at a single locus 
  with <em>a</em> allelic states and a ploidy of <em>k</em> is as follows (except
  for Presence/Absence data): $$ d = \displaystyle 
  \frac{k}{2}\sum_{i=1}^{a} \mid A_{i} - B_{i}\mid $$ 
  To find the total number of differences 
  between two individuals over all loci, you just take <em>d</em> over <em>m</em>
  loci, a value we'll call <em>D</em>:</p>  
<p>$$D = \displaystyle \sum_{i=1}^{m} d_i $$</p>  
<p>These values are calculated over all possible combinations of individuals 
  in the data set, \({n \choose 2}\) after which you end up 
  with \({n \choose 2}\cdot{}m\) values of <em>d</em> and 
  \({n \choose 2}\) values of <em>D</em>. Calculating the 
  observed variances is fairly straightforward (modified from Agapow and 
  Burt, 2001):</p>  
<p>$$ V_O = \frac{\displaystyle \sum_{i=1}^{n \choose 2} D_{i}^2 - 
  \frac{(\displaystyle\sum_{i=1}^{n \choose 2} D_{i})^2}{{n \choose 2}}}{{n 
  \choose 2}}$$</p>  
<p>Calculating the expected variance is the sum of each of the variances of 
  the individual loci. The calculation at a single locus, <em>j</em> is the 
  same as the previous equation, substituting values of <em>D</em> for 
  <em>d</em>:</p>  
<p>$$ var_j = \frac{\displaystyle \sum_{i=1}^{n \choose 2} d_{i}^2 - 
  \frac{(\displaystyle\sum_{i=1}^{n \choose 2} d_i)^2}{{n \choose 2}}}{{n 
  \choose 2}} $$</p>  
<p>The expected variance is then the sum of all the variances over all 
  <em>m</em> loci:</p>  
<p>$$ V_E = \displaystyle \sum_{j=1}^{m} var_j $$</p>  
<p>Agapow and Burt showed that \(I_A\) increases steadily with the
  number of loci, so they came up with an approximation that is widely used,
  \(\bar r_d\). For the derivation, see the manual for
  <em>multilocus</em>.</p>  
<p>$$ \bar r_d = \frac{V_O - V_E} {2\displaystyle 
  \sum_{j=1}^{m}\displaystyle \sum_{k \neq j}^{m}\sqrt{var_j\cdot{}var_k}} 
  $$</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>jack.ia()</code> is deprecated as the name was misleading. Please use
  <code>resample.ia()</code></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Paul-Michael Agapow and Austin Burt. Indices of multilocus 
  linkage disequilibrium. <em>Molecular Ecology Notes</em>, 1(1-2):101-102, 
  2001</p>  
<p>A.H.D. Brown, M.W. Feldman, and E. Nevo. Multilocus structure of natural 
  populations of <em>Hordeum spontaneum</em>. <em>Genetics</em>, 96(2):523-536, 1980.</p>  
<p>J M Smith, N H Smith, M O'Rourke, and B G Spratt. How clonal are bacteria? 
  Proceedings of the National Academy of Sciences, 90(10):4384-4388, 1993.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='poppr.html'>poppr</a></code>, <code><a href='missingno.html'>missingno</a></code>, 
  <code>import2genind</code>, <code><a href='read.genalex.html'>read.genalex</a></code>, 
  <code><a href='clonecorrect.html'>clonecorrect</a></code>, <code><a href='win.ia.html'>win.ia</a></code>, <code><a href='samp.ia.html'>samp.ia</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Zhian N. Kamvar</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>nancycats</span><span class='op'>)</span>
<span class='fu'>ia</span><span class='op'>(</span><span class='va'>nancycats</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         Ia      rbarD 
#&gt; 0.17207262 0.02178965 </div><div class='input'>
<span class='co'># Pairwise over all loci:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>partial_clone</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>pair.ia</span><span class='op'>(</span><span class='va'>partial_clone</span><span class='op'>)</span>
</div><div class='img'><img src='ia-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span>, low <span class='op'>=</span> <span class='st'>"black"</span>, high <span class='op'>=</span> <span class='st'>"green"</span>, index <span class='op'>=</span> <span class='st'>"Ia"</span><span class='op'>)</span>
</div><div class='img'><img src='ia-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Resampling</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Pinf</span><span class='op'>)</span>
<span class='fu'>resample.ia</span><span class='op'>(</span><span class='va'>Pinf</span>, reps <span class='op'>=</span> <span class='fl'>99</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           Ia      rbarD
#&gt; 1  0.6501982 0.07093833
#&gt; 2  0.8256286 0.09057133
#&gt; 3  0.4231684 0.04623043
#&gt; 4  0.6277631 0.06854268
#&gt; 5  0.7032604 0.07697910
#&gt; 6  0.6764791 0.07411652
#&gt; 7  0.7627602 0.08376810
#&gt; 8  0.6389609 0.06977151
#&gt; 9  0.7841983 0.08570989
#&gt; 10 0.6195379 0.06812260
#&gt; 11 0.7605239 0.08751298
#&gt; 12 0.7942110 0.08701043
#&gt; 13 0.6059280 0.06675097
#&gt; 14 0.6299434 0.06923696
#&gt; 15 0.5638179 0.06169467
#&gt; 16 0.6379127 0.07007583
#&gt; 17 0.6960176 0.07630673
#&gt; 18 0.7248024 0.07939282
#&gt; 19 0.7008263 0.07667522
#&gt; 20 0.4658464 0.05324204
#&gt; 21 0.5385327 0.05893106
#&gt; 22 0.5825171 0.06370222
#&gt; 23 0.6904987 0.07549761
#&gt; 24 0.6820235 0.07817614
#&gt; 25 0.7170443 0.07867977
#&gt; 26 0.7454600 0.08233780
#&gt; 27 0.5887406 0.06441081
#&gt; 28 0.6312326 0.06897246
#&gt; 29 0.6593338 0.07259843
#&gt; 30 0.5476437 0.05981975
#&gt; 31 0.6912756 0.07928548
#&gt; 32 0.7823573 0.08621459
#&gt; 33 0.6800208 0.07426381
#&gt; 34 0.7542653 0.08258429
#&gt; 35 0.7014704 0.07703452
#&gt; 36 0.6013052 0.06573002
#&gt; 37 0.6833382 0.07467048
#&gt; 38 0.5814739 0.06347431
#&gt; 39 0.6779095 0.07404344
#&gt; 40 0.7512745 0.08220176
#&gt; 41 0.6809989 0.07811553
#&gt; 42 0.6902944 0.07606066
#&gt; 43 0.6111562 0.06714608
#&gt; 44 0.7768184 0.08522498
#&gt; 45 0.8038261 0.08789452
#&gt; 46 0.6519288 0.07106003
#&gt; 47 0.6015505 0.06595567
#&gt; 48 0.7307723 0.08011669
#&gt; 49 0.7786746 0.08914556
#&gt; 50 0.6405280 0.07014232
#&gt; 51 0.5461233 0.06019438
#&gt; 52 0.7789662 0.08533309
#&gt; 53 0.6231572 0.06804370
#&gt; 54 0.6506544 0.07150263
#&gt; 55 0.6572602 0.07574286
#&gt; 56 0.6775073 0.07427077
#&gt; 57 0.7315283 0.08022850
#&gt; 58 0.6429697 0.07043269
#&gt; 59 0.6858775 0.07858277
#&gt; 60 0.7788526 0.08975278
#&gt; 61 0.5810050 0.06378772
#&gt; 62 0.7646678 0.08367388
#&gt; 63 0.5923618 0.06438076
#&gt; 64 0.6377337 0.06984813
#&gt; 65 0.7351625 0.08469701
#&gt; 66 0.6729850 0.07367359
#&gt; 67 0.6730470 0.07376535
#&gt; 68 0.6628730 0.07253585
#&gt; 69 0.6429248 0.07001100
#&gt; 70 0.6977442 0.07603908
#&gt; 71 0.5948796 0.06497293
#&gt; 72 0.6957663 0.07623048
#&gt; 73 0.7108436 0.07780428
#&gt; 74 0.6202232 0.06828203
#&gt; 75 0.6192190 0.06760712
#&gt; 76 0.5960247 0.06515301
#&gt; 77 0.7035341 0.08045609
#&gt; 78 0.7169920 0.07916178
#&gt; 79 0.6357226 0.06987920
#&gt; 80 0.8864959 0.10157407
#&gt; 81 0.7207755 0.07877351
#&gt; 82 0.6256714 0.06835729
#&gt; 83 0.6528963 0.07503376
#&gt; 84 0.5997759 0.06541564
#&gt; 85 0.6834416 0.07857675
#&gt; 86 0.6098177 0.07023320
#&gt; 87 0.6764721 0.07385135
#&gt; 88 0.6675123 0.07364553
#&gt; 89 0.8096862 0.08858310
#&gt; 90 0.5652613 0.06194018
#&gt; 91 0.6005300 0.06599025
#&gt; 92 0.5854640 0.06417910
#&gt; 93 0.6862173 0.07531431
#&gt; 94 0.7341306 0.08065948
#&gt; 95 0.7370794 0.08091394
#&gt; 96 0.6610314 0.07226520
#&gt; 97 0.5200685 0.05694612
#&gt; 98 0.6360764 0.07258663
#&gt; 99 0.7294001 0.07977655</div><div class='input'>
<span class='co'># \dontrun{</span>

<span class='co'># Pairwise IA with p-values (this will take about a minute)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>pair.ia</span><span class='op'>(</span><span class='va'>partial_clone</span>, sample <span class='op'>=</span> <span class='fl'>999</span><span class='op'>)</span>
</div><div class='img'><img src='ia-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                           Ia  p.Ia       rbarD  p.rD
#&gt; Locus_1:Locus_2 -0.007935313 0.498 -0.00827841 0.499
#&gt; Locus_1:Locus_3  0.269326856 0.001  0.27484539 0.001
#&gt; Locus_1:Locus_4  0.320892032 0.001  0.33749005 0.001
#&gt; Locus_1:Locus_5 -0.003553671 0.503 -0.00375937 0.503
#&gt; Locus_1:Locus_6  0.133939476 0.032  0.13782217 0.030
#&gt; Locus_1:Locus_7  0.504438856 0.001  0.54150373 0.001</div><div class='input'>
<span class='co'># Plot the results of resampling rbarD. </span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://ggplot2.tidyverse.org'>"ggplot2"</a></span><span class='op'>)</span>
<span class='va'>Pinf.resamp</span> <span class='op'>&lt;-</span> <span class='fu'>resample.ia</span><span class='op'>(</span><span class='va'>Pinf</span>, reps <span class='op'>=</span> <span class='fl'>999</span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>Pinf.resamp</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>rbarD</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fu'>ia</span><span class='op'>(</span><span class='va'>Pinf</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fu'>ia</span><span class='op'>(</span><span class='fu'><a href='clonecorrect.html'>clonecorrect</a></span><span class='op'>(</span><span class='va'>Pinf</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, linetype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>bar</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>)</span><span class='op'>[</span><span class='va'>d</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><div class='img'><img src='ia-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Get the indices back and plot the distributions.</span>
<span class='va'>nansamp</span> <span class='op'>&lt;-</span> <span class='fu'>ia</span><span class='op'>(</span><span class='va'>nancycats</span>, sample <span class='op'>=</span> <span class='fl'>999</span>, valuereturn <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='ia-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>nansamp</span>, index <span class='op'>=</span> <span class='st'>"Ia"</span><span class='op'>)</span>
</div><div class='img'><img src='ia-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>nansamp</span>, index <span class='op'>=</span> <span class='st'>"rbarD"</span><span class='op'>)</span>
</div><div class='img'><img src='ia-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># You can also adjust the parameters for how large to display the text</span>
<span class='co'># so that it's easier to export it for publication/presentations.</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://ggplot2.tidyverse.org'>"ggplot2"</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>nansamp</span>, labsize <span class='op'>=</span> <span class='fl'>5</span>, linesize <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>                                      <span class='co'># adding a theme</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>       <span class='co'># changing text size</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># changing title size</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Index of Association of nancycats"</span><span class='op'>)</span>      <span class='co'># adding a new title</span>
</div><div class='img'><img src='ia-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Get the index for each population.</span>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'>seppop</span><span class='op'>(</span><span class='va'>nancycats</span><span class='op'>)</span>, <span class='va'>ia</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $P01
#&gt;         Ia      rbarD 
#&gt; 0.16564272 0.02105965 
#&gt; 
#&gt; $P02
#&gt;         Ia      rbarD 
#&gt; 0.18176676 0.02301615 
#&gt; 
#&gt; $P03
#&gt;         Ia      rbarD 
#&gt; 0.35461940 0.04517282 
#&gt; 
#&gt; $P04
#&gt;         Ia      rbarD 
#&gt; 0.44944509 0.05634184 
#&gt; 
#&gt; $P05
#&gt;           Ia        rbarD 
#&gt; -0.047539953 -0.006004254 
#&gt; 
#&gt; $P06
#&gt;         Ia      rbarD 
#&gt; 0.33370148 0.04261598 
#&gt; 
#&gt; $P07
#&gt;         Ia      rbarD 
#&gt; 0.25691744 0.03259883 
#&gt; 
#&gt; $P08
#&gt;         Ia      rbarD 
#&gt; 0.23877871 0.03012163 
#&gt; 
#&gt; $P09
#&gt;        Ia     rbarD 
#&gt; 2.0845196 0.2636454 
#&gt; 
#&gt; $P10
#&gt;         Ia      rbarD 
#&gt; 0.59550982 0.07627372 
#&gt; 
#&gt; $P11
#&gt;        Ia     rbarD 
#&gt; 0.2846571 0.0362703 
#&gt; 
#&gt; $P12
#&gt;         Ia      rbarD 
#&gt; 0.48988697 0.06428403 
#&gt; 
#&gt; $P13
#&gt;        Ia     rbarD 
#&gt; 0.1855035 0.0236618 
#&gt; 
#&gt; $P14
#&gt;        Ia     rbarD 
#&gt; 0.2210061 0.0282276 
#&gt; 
#&gt; $P15
#&gt;         Ia      rbarD 
#&gt; 0.69325774 0.08726678 
#&gt; 
#&gt; $P16
#&gt;         Ia      rbarD 
#&gt; 0.23450449 0.02950446 
#&gt; 
#&gt; $P17
#&gt;          Ia       rbarD 
#&gt; -0.09055833 -0.01378538 
#&gt; </div><div class='input'><span class='co'># With sampling</span>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'>seppop</span><span class='op'>(</span><span class='va'>nancycats</span><span class='op'>)</span>, <span class='va'>ia</span>, sample <span class='op'>=</span> <span class='fl'>999</span><span class='op'>)</span>
</div><div class='img'><img src='ia-9.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-10.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-11.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-12.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-13.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-14.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-15.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-16.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-17.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-18.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-19.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-20.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-21.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-22.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-23.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-24.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-25.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; $P01
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.16564272 0.24100000 0.02105965 0.24100000 
#&gt; 
#&gt; $P02
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.18176676 0.06900000 0.02301615 0.06400000 
#&gt; 
#&gt; $P03
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.35461940 0.04200000 0.04517282 0.04200000 
#&gt; 
#&gt; $P04
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.44944509 0.00100000 0.05634184 0.00100000 
#&gt; 
#&gt; $P05
#&gt;           Ia         p.Ia        rbarD         p.rD 
#&gt; -0.047539953  0.567000000 -0.006004254  0.566000000 
#&gt; 
#&gt; $P06
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.33370148 0.05100000 0.04261598 0.05100000 
#&gt; 
#&gt; $P07
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.25691744 0.10100000 0.03259883 0.10100000 
#&gt; 
#&gt; $P08
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.23877871 0.14700000 0.03012163 0.14700000 
#&gt; 
#&gt; $P09
#&gt;        Ia      p.Ia     rbarD      p.rD 
#&gt; 2.0845196 0.0010000 0.2636454 0.0010000 
#&gt; 
#&gt; $P10
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.59550982 0.00400000 0.07627372 0.00300000 
#&gt; 
#&gt; $P11
#&gt;        Ia      p.Ia     rbarD      p.rD 
#&gt; 0.2846571 0.3230000 0.0362703 0.3250000 
#&gt; 
#&gt; $P12
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.48988697 0.01200000 0.06428403 0.01200000 
#&gt; 
#&gt; $P13
#&gt;        Ia      p.Ia     rbarD      p.rD 
#&gt; 0.1855035 0.1660000 0.0236618 0.1640000 
#&gt; 
#&gt; $P14
#&gt;        Ia      p.Ia     rbarD      p.rD 
#&gt; 0.2210061 0.0700000 0.0282276 0.0700000 
#&gt; 
#&gt; $P15
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.69325774 0.00500000 0.08726678 0.00500000 
#&gt; 
#&gt; $P16
#&gt;         Ia       p.Ia      rbarD       p.rD 
#&gt; 0.23450449 0.11800000 0.02950446 0.11800000 
#&gt; 
#&gt; $P17
#&gt;          Ia        p.Ia       rbarD        p.rD 
#&gt; -0.09055833  0.66300000 -0.01378538  0.66500000 
#&gt; </div><div class='input'>
<span class='co'># Plot pairwise ia for all populations in a grid with cowplot</span>
<span class='co'># Set up the library and data</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://wilkelab.org/cowplot/'>"cowplot"</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span>
<span class='fu'>splitStrata</span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='op'>~</span><span class='va'>Tree</span><span class='op'>/</span><span class='va'>Year</span><span class='op'>/</span><span class='va'>Symptom</span>
<span class='fu'>setPop</span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span>      <span class='op'>&lt;-</span> <span class='op'>~</span><span class='va'>Tree</span>

<span class='co'># Need to set up a list in which to store the plots.</span>
<span class='va'>plotlist</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span>mode <span class='op'>=</span> <span class='st'>"list"</span>, length <span class='op'>=</span> <span class='fu'>nPop</span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>plotlist</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'>popNames</span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span>

<span class='co'># Loop throgh the populations, calculate pairwise ia, plot, and then</span>
<span class='co'># capture the plot in the list</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'>popNames</span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>pair.ia</span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>[</span>pop <span class='op'>=</span> <span class='va'>i</span><span class='op'>]</span>, limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.15</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># subset, calculate, and plot</span>
  <span class='va'>plotlist</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/last_plot.html'>last_plot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='co'># save the last plot</span>
<span class='op'>}</span>
</div><div class='img'><img src='ia-26.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-27.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-28.png' alt='' width='700' height='433' /></div><div class='img'><img src='ia-29.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Use the plot_grid function to plot.</span>
<span class='fu'><a href='https://wilkelab.org/cowplot/reference/plot_grid.html'>plot_grid</a></span><span class='op'>(</span>plotlist <span class='op'>=</span> <span class='va'>plotlist</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Tree"</span>, <span class='fu'>popNames</span><span class='op'>(</span><span class='va'>monpop</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='ia-30.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


