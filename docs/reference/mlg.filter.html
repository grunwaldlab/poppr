<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>MLG definitions based on genetic distance — mlg.filter • poppr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="MLG definitions based on genetic distance — mlg.filter" />

<meta property="og:description" content="Multilocus genotypes are initially defined by naive string matching, but this
definition does not take into account missing data or genotyping error,
casting these as unique genotypes. Defining multilocus genotypes by genetic
distance allows you to incorporate genotypes that have missing data o
genotyping error into their parent clusters." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poppr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MLG definitions based on genetic distance</h1>
    <small>Source: <a href='https://github.com/grunwaldlab/poppr/blob/master/R/methods.r'><code>R/methods.r</code></a></small>
    </div>

    
    <p>Multilocus genotypes are initially defined by naive string matching, but this
definition does not take into account missing data or genotyping error,
casting these as unique genotypes. Defining multilocus genotypes by genetic
distance allows you to incorporate genotypes that have missing data o
genotyping error into their parent clusters.</p>
    

    <pre class="usage"><span class='fu'>mlg.filter</span>(<span class='no'>pop</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>missing</span> <span class='kw'>=</span> <span class='st'>"asis"</span>, <span class='kw'>memory</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='st'>"farthest_neighbor"</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='st'>"diss.dist"</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>stats</span> <span class='kw'>=</span> <span class='st'>"MLGs"</span>, <span class='no'>...</span>)

<span class='fu'>mlg.filter</span>(<span class='no'>pop</span>, <span class='kw'>missing</span> <span class='kw'>=</span> <span class='st'>"asis"</span>, <span class='kw'>memory</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='st'>"farthest_neighbor"</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='st'>"diss.dist"</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='no'>...</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span></pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pop</th>
      <td><p>a <code><a href='genclone-class.html'>genclone</a></code>, <code><a href='genclone-class.html'>snpclone</a></code>, or
<code>genind</code> object.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>a number indicating the minimum distance two MLGs must be
separated by to be considered different. Defaults to 0, which will reflect
the original (naive) MLG definition.</p></td>
    </tr>
    <tr>
      <th>missing</th>
      <td><p>any method to be used by <code><a href='missingno.html'>missingno</a></code>: "mean", 
"zero", "loci", "genotype", or "asis" (default).</p></td>
    </tr>
    <tr>
      <th>memory</th>
      <td><p>whether this function should remember the last distance matrix 
it generated. TRUE will attempt to reuse the last distance matrix if the 
other parameters are the same. (default) FALSE will ignore any stored 
matrices and not store any it generates.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>determines the type of clustering to be done.</p><dl class='dl-horizontal'>
  <dt>"farthest_neighbor"</dt><dd><p><em> (default) </em>merges clusters based on the 
  maximum distance between points in either cluster. This is the strictest of
  the three.</p></dd>
  <dt>"nearest_neighbor"</dt><dd><p>merges clusters based on the minimum distance
  between points in either cluster. This is the loosest of the three.</p></dd>
  <dt>"average_neighbor"</dt><dd><p>merges clusters based on the average distance
  between every pair of points between clusters.</p></dd>
</dl></td>
    </tr>
    <tr>
      <th>distance</th>
      <td><p>a character or function defining the distance to be applied 
to pop. Defaults to <code><a href='diss.dist.html'>diss.dist</a></code> for genclone objects and
<code><a href='bitwise.dist.html'>bitwise.dist</a></code> for snpclone objects. A matrix or table
containing distances between individuals (such as the output of 
<code><a href='genetic_distance.html'>rogers.dist</a></code>) is also accepted for this parameter.</p></td>
    </tr>
    <tr>
      <th>threads</th>
      <td><p>(unused) Previously, this was the maximum number of parallel 
threads to be used within this function. Default is 1 indicating that this
function will run serially. Any other number will result in a warning.</p></td>
    </tr>
    <tr>
      <th>stats</th>
      <td><p>a character vector specifying which statistics should be
returned (details below). Choices are "MLG", "THRESHOLDS", "DISTANCES",
"SIZES", or "ALL". If choosing "ALL" or more than one, a named list will be
returned.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>any parameters to be passed off to the distance method.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>the threshold at which genotypes should be collapsed.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Default, a vector of collapsed multilocus genotypes. Otherwise, any
  combination of the following:</p><h3>MLGs</h3>

  a numeric vector defining the multilocus genotype cluster of each
  individual in the dataset. Each genotype cluster is separated from every
  other genotype cluster by at least the defined threshold value, as 
  calculated by the selected algorithm.

<h3>THRESHOLDS</h3>

  A numeric vector representing the thresholds <strong>beyond</strong> which clusters
  of multilocus genotypes were collapsed. 

<h3>DISTANCES</h3>

  A square matrix representing the distances between each cluster.

<h3>SIZES</h3>

 The sizes of the multilocus genotype clusters in order. 


    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function will take in any distance matrix or function and
collapse multilocus genotypes below a given threshold. If you use this
function as the assignment method (mlg.filter(myData, distance = myDist) &lt;-
0.5), the distance function or matrix will be remembered by the object. This
means that if you define your own distance matrix or function, you must keep
it in memory to further utilize mlg.filter.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>mlg.vector</code> makes use of <code>mlg.vector</code> grouping prior to 
  applying the given threshold. Genotype numbers returned by
  <code>mlg.vector</code> represent the lowest numbered genotype (as returned by
  <code>mlg.vector</code>) in in each new multilocus genotype. Therefore
  <strong><code>mlg.filter</code> and <code>mlg.vector</code> return the same vector when
  threshold is set to 0 or less</strong>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='filter_stats.html'>filter_stats</a></code>, 
  <code><a href='cutoff_predictor.html'>cutoff_predictor</a></code>, 
  <code><a href='mll-method.html'>mll</a></code>, 
  <code><a href='genclone-class.html'>genclone</a></code>, 
  <code><a href='genclone-class.html'>snpclone</a></code>, 
  <code><a href='diss.dist.html'>diss.dist</a></code>, 
  <code><a href='bruvo.dist.html'>bruvo.dist</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>data</span>(<span class='no'>partial_clone</span>)
<span class='no'>pc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='coercion-methods.html'>as.genclone</a></span>(<span class='no'>partial_clone</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1L</span>) <span class='co'># convert to genclone object</span>

<span class='co'># Basic Use ---------------------------------------------------------------</span>


<span class='co'># Show MLGs at threshold 0.05</span>
<span class='fu'>mlg.filter</span>(<span class='no'>pc</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='st'>"nei.dist"</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1L</span>)</div><div class='output co'>#&gt;  [1]  8  7 23 24 22 21 10  3 22 11 24  7 25  4 12  2 14  1  7  7  7 26  7 13 23
#&gt; [26]  3 17 22  6 20 22 12  5 25 13 21 15 13 13 13  2 19 18 13 23 16  1 11 25  4</div><div class='input'><span class='no'>pc</span> <span class='co'># 26 mlgs</span></div><div class='output co'>#&gt; 
#&gt; This is a genclone object
#&gt; -------------------------
#&gt; Genotype information:
#&gt; 
#&gt;    26 original multilocus genotypes 
#&gt;    50 diploid individuals
#&gt;    10 codominant loci
#&gt; 
#&gt; Population information:
#&gt; 
#&gt;     0 strata. 
#&gt;     4 populations defined - 1, 2, 3, 4</div><div class='input'>
<span class='co'># Set MLGs at threshold 0.05</span>
<span class='fu'>mlg.filter</span>(<span class='no'>pc</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='st'>"nei.dist"</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1L</span>) <span class='kw'>&lt;-</span> <span class='fl'>0.05</span>
<span class='no'>pc</span> <span class='co'># 25 mlgs</span></div><div class='output co'>#&gt; 
#&gt; This is a genclone object
#&gt; -------------------------
#&gt; Genotype information:
#&gt; 
#&gt;    25 contracted multilocus genotypes
#&gt;       (0.05) [t], (nei.dist) [d], (farthest) [a] 
#&gt;    50 diploid individuals
#&gt;    10 codominant loci
#&gt; 
#&gt; Population information:
#&gt; 
#&gt;     0 strata. 
#&gt;     4 populations defined - 1, 2, 3, 4</div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># The distance definition is persistant</span>
<span class='fu'>mlg.filter</span>(<span class='no'>pc</span>) <span class='kw'>&lt;-</span> <span class='fl'>0.1</span>
<span class='no'>pc</span> <span class='co'># 24 mlgs</span>

<span class='co'># But you can still change the definition</span>
<span class='fu'>mlg.filter</span>(<span class='no'>pc</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='st'>"diss.dist"</span>, <span class='kw'>percent</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='kw'>&lt;-</span> <span class='fl'>0.1</span>
<span class='no'>pc</span>

<span class='co'># Choosing a threshold ----------------------------------------------------</span>


<span class='co'># Thresholds for collapsing multilocus genotypes should not be arbitrary. It</span>
<span class='co'># is important to consider what threshold is suitable. One method of choosing</span>
<span class='co'># a threshold is to find a gap in the distance distribution that represents</span>
<span class='co'># clonal groups. You can look at this by analyzing the distribution of all</span>
<span class='co'># possible thresholds with the function "cutoff_predictor".</span>

<span class='co'># For this example, we'll use Bruvo's distance to predict the cutoff for</span>
<span class='co'># P. infestans.</span>

<span class='fu'>data</span>(<span class='no'>Pinf</span>)
<span class='no'>Pinf</span>
<span class='co'># Repeat lengths are necessary for Bruvo's distance</span>
(<span class='no'>pinfreps</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fix_replen.html'>fix_replen</a></span>(<span class='no'>Pinf</span>, <span class='fu'>c</span>(<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>6</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>2</span>)))

<span class='co'># Now we can collect information of the thresholds. We can set threshold = 1</span>
<span class='co'># because we know that this will capture the maximum possible distance:</span>
(<span class='no'>thresholds</span> <span class='kw'>&lt;-</span> <span class='fu'>mlg.filter</span>(<span class='no'>Pinf</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='no'>bruvo.dist</span>, <span class='kw'>stats</span> <span class='kw'>=</span> <span class='st'>"THRESHOLDS"</span>,
                          <span class='kw'>replen</span> <span class='kw'>=</span> <span class='no'>pinfreps</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>1</span>))
<span class='co'># We can use these thresholds to find an appropriate cutoff</span>
(<span class='no'>pcut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cutoff_predictor.html'>cutoff_predictor</a></span>(<span class='no'>thresholds</span>))
<span class='fu'>mlg.filter</span>(<span class='no'>Pinf</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='no'>bruvo.dist</span>, <span class='kw'>replen</span> <span class='kw'>=</span> <span class='no'>pinfreps</span>) <span class='kw'>&lt;-</span> <span class='no'>pcut</span>
<span class='no'>Pinf</span>

<span class='co'># This can also be visualized with the "filter_stats" function.</span>

<span class='co'># Special case: threshold = 0 ---------------------------------------------</span>


<span class='co'># It's important to remember that a threshold of 0 is equal to the original</span>
<span class='co'># MLG definition. This example will show a data set that contains genotypes</span>
<span class='co'># with missing data that share all alleles with other genotypes except for </span>
<span class='co'># the missing one.</span>

<span class='fu'>data</span>(<span class='no'>monpop</span>)
<span class='no'>monpop</span> <span class='co'># 264 mlg</span>
<span class='fu'>mlg.filter</span>(<span class='no'>monpop</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='fu'><a href='mll-method.html'>nmll</a></span>(<span class='no'>monpop</span>) <span class='co'># 264 mlg</span>

<span class='co'># In order to merge these genotypes with missing data, we should set the </span>
<span class='co'># threshold to be slightly higher than 0. We will use the smallest fraction </span>
<span class='co'># the computer can store.</span>

<span class='fu'>mlg.filter</span>(<span class='no'>monpop</span>) <span class='kw'>&lt;-</span> <span class='no'>.Machine</span>$<span class='no'>double.eps</span> ^ <span class='fl'>0.5</span>
<span class='fu'><a href='mll-method.html'>nmll</a></span>(<span class='no'>monpop</span>) <span class='co'># 236 mlg</span>

<span class='co'># Custom distance ---------------------------------------------------------</span>

<span class='co'># Custom genetic distances can be used either in functions from other</span>
<span class='co'># packages or user-defined functions</span>

<span class='fu'>data</span>(<span class='no'>Pinf</span>)
<span class='no'>Pinf</span>
<span class='fu'>mlg.filter</span>(<span class='no'>Pinf</span>, <span class='kw'>distance</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>dist</span>(<span class='fu'>tab</span>(<span class='no'>x</span>))) <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>Pinf</span>
<span class='fu'>mlg.filter</span>(<span class='no'>Pinf</span>) <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>Pinf</span>

<span class='co'># genlight / snpclone objects ---------------------------------------------</span>


<span class='fu'>set.seed</span>(<span class='fl'>999</span>)
<span class='no'>gc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='snpclone-coercion-methods.html'>as.snpclone</a></span>(<span class='fu'>glSim</span>(<span class='fl'>100</span>, <span class='fl'>0</span>, <span class='kw'>n.snp.struc</span> <span class='kw'>=</span> <span class='fl'>1e3</span>, <span class='kw'>ploidy</span> <span class='kw'>=</span> <span class='fl'>2</span>))
<span class='no'>gc</span> <span class='co'># 100 mlgs</span>
<span class='fu'>mlg.filter</span>(<span class='no'>gc</span>) <span class='kw'>&lt;-</span> <span class='fl'>0.25</span>
<span class='no'>gc</span> <span class='co'># 82 mlgs</span>

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

