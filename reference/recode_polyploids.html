<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="As the genind object requires ploidy to be consistent across loci, a 
workaround to importing polyploid data was to code missing alleles as &quot;0&quot; 
(for microsatellite data sets). The advantage of this is that users would be 
able to calculate Bruvo's distance, the index of association, and genotypic 
diversity statistics. The tradeoff was the fact that this broke all other 
analyses as they relied on allele frequencies and the missing alleles are 
treated as extra alleles. This function removes those alleles and returns a 
genclone or genind object where 
allele frequencies are coded based on the number of alleles observed at a 
single locus per individual. See the examples for more details."><title>Recode polyploid microsatellite data for use in frequency based statistics. — recode_polyploids • poppr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Recode polyploid microsatellite data for use in frequency based statistics. — recode_polyploids"><meta property="og:description" content="As the genind object requires ploidy to be consistent across loci, a 
workaround to importing polyploid data was to code missing alleles as &quot;0&quot; 
(for microsatellite data sets). The advantage of this is that users would be 
able to calculate Bruvo's distance, the index of association, and genotypic 
diversity statistics. The tradeoff was the fact that this broke all other 
analyses as they relied on allele frequencies and the missing alleles are 
treated as extra alleles. This function removes those alleles and returns a 
genclone or genind object where 
allele frequencies are coded based on the number of alleles observed at a 
single locus per individual. See the examples for more details."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">poppr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    <a class="dropdown-item" href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Recode polyploid microsatellite data for use in frequency based statistics.</h1>
      <small class="dont-index">Source: <a href="https://github.com/grunwaldlab/poppr/blob/HEAD/R/data_subset.r" class="external-link"><code>R/data_subset.r</code></a></small>
      <div class="d-none name"><code>recode_polyploids.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>As the genind object requires ploidy to be consistent across loci, a 
workaround to importing polyploid data was to code missing alleles as "0" 
(for microsatellite data sets). The advantage of this is that users would be 
able to calculate Bruvo's distance, the index of association, and genotypic 
diversity statistics. The tradeoff was the fact that this broke all other 
analyses as they relied on allele frequencies and the missing alleles are 
treated as extra alleles. This function removes those alleles and returns a 
<code><a href="genclone-class.html">genclone</a></code> or <code><a href="https://rdrr.io/pkg/adegenet/man/genind.html" class="external-link">genind</a></code> object where 
allele frequencies are coded based on the number of alleles observed at a 
single locus per individual. See the examples for more details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">recode_polyploids</span><span class="op">(</span><span class="va">poly</span>, newploidy <span class="op">=</span> <span class="cn">FALSE</span>, addzero <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>poly</dt>
<dd><p>a <code><a href="genclone-class.html">genclone</a></code>, <code><a href="https://rdrr.io/pkg/adegenet/man/genind.html" class="external-link">genind</a></code>, or 
<code><a href="https://rdrr.io/pkg/adegenet/man/genpop.html" class="external-link">genpop</a></code> object that has a ploidy of &gt; 2</p></dd>


<dt>newploidy</dt>
<dd><p>for genind or genclone objects: if <code>FALSE</code> (default),
the user-defined ploidy will stay constant. if <code>TRUE</code>, the ploidy for
each sample will be determined by the maximum ploidy observed for each
genotype.</p></dd>


<dt>addzero</dt>
<dd><p>add zeroes onto genind or genclone objects with uneven ploidy?
if <code>TRUE</code>, objects with uneven ploidies will have zeroes appended to all
loci to allow conversion to genpop objects. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a <code><a href="genclone-class.html">genclone</a></code>, <code><a href="https://rdrr.io/pkg/adegenet/man/genind.html" class="external-link">genind</a></code>, or</p>
<p></p>
<p><code><a href="https://rdrr.io/pkg/adegenet/man/genpop.html" class="external-link">genpop</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The genind object has two caveats that make it difficult to work 
  with polyploid data sets:</p><ol><li><p>ploidy must be constant throughout the data set</p></li>
<li><p>missing data is treated as "all-or-none"</p></li>
</ol><p>In an ideal world, polyploid genotypes would be just as unambiguous as 
  diploid or haploid genotypes. Unfortunately, the world we live in is far 
  from ideal and a genotype of AB in a tetraploid organism could be AAAB, 
  AABB, or ABBB. In order to get polyploid data in to <span class="pkg">adegenet</span> or 
  <span class="pkg">poppr</span>, we must code all loci to have the same number of allelic 
  states as the ploidy or largest observed heterozygote (if ploidy is 
  unknown). The way to do this is to insert zeroes to pad the alleles. So, to
  import two genotypes of:</p>
<table class="table table"><tr><td>NA</td><td>20</td><td>23</td><td>24</td></tr><tr><td>20</td><td>24</td><td>26</td><td>43</td></tr></table><p>they should be coded as:</p><table class="table table"><tr><td>0</td><td>20</td><td>23</td><td>24</td></tr><tr><td>20</td><td>24</td><td>26</td><td>43</td></tr></table><p>This zero is treated as an extra allele and is represented in the genind object as so:</p><table class="table table"><tr><td><strong>0</strong></td><td><strong>20</strong></td><td><strong>23</strong></td><td><strong>24</strong></td><td><strong>26</strong></td><td><strong>43</strong></td></tr><tr><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td></tr><tr><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td></tr></table><p>This function remedies this problem by removing the zero column.
  The above table would become:</p>
<table class="table table"><tr><td><strong>20</strong></td><td><strong>23</strong></td><td><strong>24</strong></td><td><strong>26</strong></td><td><strong>43</strong></td></tr><tr><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td></tr><tr><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td></tr></table><p>With this, the user is able to calculate frequency based statistics on the
data set.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This is an approximation, and a bad one at that. <span class="pkg">Poppr</span> was not
originally intended for polyploids, but with the inclusion of Bruvo's
distance, it only made sense to attempt something beyond single use.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Zhian N. Kamvar</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iPinf</span> <span class="op">&lt;-</span> <span class="fu">recode_polyploids</span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that the difference between the number of alleles.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">nAll</a></span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pi02  D13 Pi33 Pi04 Pi4B Pi16  G11 Pi56 Pi63 Pi70 Pi89 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11   26    3    5    8    7   22    4    4    4   12 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">nAll</a></span><span class="op">(</span><span class="va">iPinf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pi02  D13 Pi33 Pi04 Pi4B Pi16  G11 Pi56 Pi63 Pi70 Pi89 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10   25    2    4    7    6   21    3    3    3   11 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://ape-package.ird.fr/" class="external-link">"ape"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Removing missing data. </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/population-methods.html" class="external-link">setPop</a></span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">~</span><span class="va">Country</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculating Rogers' distance. </span></span></span>
<span class="r-in"><span><span class="va">rog</span> <span class="op">&lt;-</span> <span class="fu"><a href="genetic_distance.html">rogers.dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/genind2genpop.html" class="external-link">genind2genpop</a></span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Converting data from a genind to a genpop object... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">irog</span> <span class="op">&lt;-</span> <span class="fu"><a href="genetic_distance.html">rogers.dist</a></span><span class="op">(</span><span class="fu">recode_polyploids</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/genind2genpop.html" class="external-link">genind2genpop</a></span><span class="op">(</span><span class="va">Pinf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Converting data from a genind to a genpop object... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We will now plot neighbor joining trees. Note the decreased distance in the</span></span></span>
<span class="r-in"><span><span class="co"># original data.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nj.html" class="external-link">nj</a></span><span class="op">(</span><span class="va">rog</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"unrooted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/add.scale.bar.html" class="external-link">add.scale.bar</a></span><span class="op">(</span>lcol <span class="op">=</span> <span class="st">"red"</span>, length <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="recode_polyploids-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nj.html" class="external-link">nj</a></span><span class="op">(</span><span class="va">irog</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"unrooted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/add.scale.bar.html" class="external-link">add.scale.bar</a></span><span class="op">(</span>lcol <span class="op">=</span> <span class="st">"red"</span>, length <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="recode_polyploids-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

