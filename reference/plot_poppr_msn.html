<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function allows you to take the output of poppr.msn and bruvo.msn and 
customize the plot by labeling groups of individuals, size of nodes, and 
adjusting the palette and scale bar."><title>Plot minimum spanning networks produced in poppr. — plot_poppr_msn • poppr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot minimum spanning networks produced in poppr. — plot_poppr_msn"><meta property="og:description" content="This function allows you to take the output of poppr.msn and bruvo.msn and 
customize the plot by labeling groups of individuals, size of nodes, and 
adjusting the palette and scale bar."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">poppr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    <a class="dropdown-item" href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot minimum spanning networks produced in poppr.</h1>
      <small class="dont-index">Source: <a href="https://github.com/grunwaldlab/poppr/blob/HEAD/R/visualizations.r" class="external-link"><code>R/visualizations.r</code></a></small>
      <div class="d-none name"><code>plot_poppr_msn.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows you to take the output of poppr.msn and bruvo.msn and 
customize the plot by labeling groups of individuals, size of nodes, and 
adjusting the palette and scale bar.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_poppr_msn</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">poppr_msn</span>,</span>
<span>  gscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  gadj <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  mlg.compute <span class="op">=</span> <span class="st">"original"</span>,</span>
<span>  glim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  gweight <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  wscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nodescale <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nodebase <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nodelab <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  inds <span class="op">=</span> <span class="st">"ALL"</span>,</span>
<span>  mlg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quantiles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  palette <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layfun <span class="op">=</span> <span class="va">layout.auto</span>,</span>
<span>  beforecut <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pop.leg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  size.leg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale.leg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a <code><a href="https://rdrr.io/pkg/adegenet/man/genind.html" class="external-link">genind</a></code>, <code><a href="genclone-class.html">genclone</a></code>,
<code><a href="https://rdrr.io/pkg/adegenet/man/genlight.html" class="external-link">genlight</a></code>, or <code><a href="genclone-class.html">snpclone</a></code> object from
which <code>poppr_msn</code> was derived.</p></dd>


<dt>poppr_msn</dt>
<dd><p>a <code>list</code> produced from either <code><a href="poppr.msn.html">poppr.msn</a></code> 
or <code><a href="bruvo.msn.html">bruvo.msn</a></code>. This list should contain a graph, a vector of 
population names and a vector of hexadecimal color definitions for each 
population.</p></dd>


<dt>gscale</dt>
<dd><p>"grey scale". If this is <code>TRUE</code>, this will scale the color
of the edges proportional to the observed distance, with the lines becoming
darker for more related nodes. See <code><a href="greycurve.html">greycurve</a></code> for details.</p></dd>


<dt>gadj</dt>
<dd><p>"grey adjust". a positive <code>integer</code> greater than zero that
will serve as the exponent to the edge weight to scale the grey value to
represent that weight.</p></dd>


<dt>mlg.compute</dt>
<dd><p>if the multilocus genotypes are set to "custom" (see 
<code><a href="mll.custom.html">mll.custom</a></code> for details) in your genclone object, this will 
specify which mlg level to calculate the nodes from. See details.</p></dd>


<dt>glim</dt>
<dd><p>"grey limit". Two numbers between zero and one. They determine 
the upper and lower limits for the <code><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></code> function. Default is 0
(black) and 0.8 (20% black).</p></dd>


<dt>gweight</dt>
<dd><p>"grey weight". an <code>integer</code>. If it's 1, the grey scale
will be weighted to emphasize the differences between closely related nodes.
If it is 2, the grey scale will be weighted to emphasize the differences
between more distantly related nodes.</p></dd>


<dt>wscale</dt>
<dd><p>"width scale". If this is <code>TRUE</code>, the edge widths will be 
scaled proportional to the inverse of the observed distance , with the 
lines becoming thicker for more related nodes.</p></dd>


<dt>nodescale</dt>
<dd><p>a <code>numeric</code> indicating how to scale the node sizes (scales by area).</p></dd>


<dt>nodebase</dt>
<dd><p><strong>deprecated</strong> a <code>numeric</code> indicating what base logarithm should be
used to scale the node sizes. Defaults to 1.15. See details.</p></dd>


<dt>nodelab</dt>
<dd><p>an <code>integer</code> specifying the smallest size of node to 
label. See details.</p></dd>


<dt>inds</dt>
<dd><p>a <code>character</code> or <code>numeric</code> vector indicating which
samples or multilocus genotypes to label on the graph. See details.</p></dd>


<dt>mlg</dt>
<dd><p><code>logical</code> When <code>TRUE</code>, the nodes will be labeled by
multilocus genotype. When <code>FALSE</code> (default), nodes will be labeled by
sample names.</p></dd>


<dt>quantiles</dt>
<dd><p><code>logical</code>. When set to <code>TRUE</code> (default), the scale
bar will be composed of the quantiles from the observed edge weights. When 
set to <code>FALSE</code>, the scale bar will be composed of a smooth gradient 
from the minimum edge weight to the maximum edge weight.</p></dd>


<dt>cutoff</dt>
<dd><p>a number indicating the longest distance to display in your 
graph. This is performed by removing edges with weights greater than this 
number.</p></dd>


<dt>palette</dt>
<dd><p>a function or character corresponding to a specific palette 
you want to use to delimit your populations. The default is whatever 
palette was used to produce the original graph.</p></dd>


<dt>layfun</dt>
<dd><p>a function specifying the layout of nodes in your graph. It 
defaults to <code><a href="https://r.igraph.org/reference/layout_nicely.html" class="external-link">layout.auto</a></code>.</p></dd>


<dt>beforecut</dt>
<dd><p>if <code>TRUE</code>, the layout of the graph will be computed 
before any edges are removed with <code>cutoff</code>. If <code>FALSE</code> (Default),
the layout will be computed after any edges are removed.</p></dd>


<dt>pop.leg</dt>
<dd><p>if <code>TRUE</code>, a legend indicating the populations will
appear in the top right corner of the graph, but will not overlap. Setting
<code>pop.leg = FALSE</code> disables this legend. See details.</p></dd>


<dt>size.leg</dt>
<dd><p>if <code>TRUE</code>, a legend displyaing the number of samples per
node will appear either below the population legend or in the top right
corner of the graph. Setting <code>size.leg = FALSE</code> disables this legend.</p></dd>


<dt>scale.leg</dt>
<dd><p>if <code>TRUE</code>, a scale bar indicating the distance will
appear under the graph. Setting <code>scale.leg = FALSE</code> suppresses this
bar. See details.</p></dd>


<dt>...</dt>
<dd><p>any other parameters to be passed on to 
<code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">plot.igraph</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>the modified msn list, invisibly.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The previous incarnation of msn plotting in poppr simply plotted the
  minimum spanning network with the legend of populations, but did not 
  provide a scale bar and it did not provide the user a simple way of 
  manipulating the layout or labels. This function allows the user to 
  manipulate many facets of graph creation, making the creation of minimum 
  spanning networks ever so slightly more user friendly.</p>  
<p>This function must have both the source data and the output msn to work. 
  The source data must contain the same population structure as the graph. 
  Every other parameter has a default setting.</p>  
<p></p><div class="section">
<h3 id="parameter-details">Parameter details<a class="anchor" aria-label="anchor" href="#parameter-details"></a></h3>
<p></p><ul><li><p><code>inds</code> By default, the graph will label each node (circle) with
  all of the samples (individuals) that are contained within that node. As
  each node represents a single multilocus genotype (MLG) or individuals (n
  &gt;= 1), this argument is designed to allow you to selectively label the
  nodes based on query of sample name or MLG number. If the option <code>mlg
  = TRUE</code>, the multilocus genotype assignment will be used to label the node.
  If you do not want to label the nodes by individual or multilocus genotype,
  simply set this to a name that doesn't exist in your data.</p></li>
<li><p><code>nodescale</code> The nodes (circles) on the graph represent different
  multilocus genotypes. The area of the nodes represent the number of
  individuals. Setting nodescale will scale the area of the nodes.</p></li>
<li><p><code>nodelab</code> If a node is not labeled by individual, this will
  label the size of the nodes greater than or equal to this value. If you
  don't want to label the size of the nodes, simply set this to a very high
  number.</p></li>
<li><p><code>cutoff</code> This is useful for when you want to investigate groups
  of multilocus genotypes separated by a specific distance or if you have two
  distinct populations and you want to physically separate them in your
  network.</p></li>
<li><p><code>beforecut</code> This is an indicator useful if you want to maintain
  the same position of the nodes before and after removing edges with the
  <code>cutoff</code> argument. This works best if you set a seed before you run
  the function.</p></li>
</ul></div>
  
<p></p><div class="section">
<h3 id="mlg-compute">mlg.compute<a class="anchor" aria-label="anchor" href="#mlg-compute"></a></h3>
<p>Each node on the graph represents a different multilocus genotype. 
  The edges on the graph represent genetic distances that connect the
  multilocus genotypes. In genclone objects, it is possible to set the
  multilocus genotypes to a custom definition. This creates a problem for
  clone correction, however, as it is very possible to define custom lineages
  that are not monophyletic. When clone correction is performed on these
  definitions, information is lost from the graph. To circumvent this, The
  clone correction will be done via the computed multilocus genotypes, either
  "original" or "contracted". This is specified in the <code>mlg.compute</code>
  argument, above.</p>
</div>
  
<p></p><div class="section">
<h3 id="legends">legends<a class="anchor" aria-label="anchor" href="#legends"></a></h3>
<p>To avoid drawing the legend over the graph, legends 
  are separated by different plotting areas. This means that if legends are 
  included, you cannot plot multiple MSNs in a single plot. The scale bar (to
  be added in manually) can be obtained from <code><a href="greycurve.html">greycurve</a></code> and the
  legend can be plotted with <code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></code>.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://r.igraph.org/reference/layout_nicely.html" class="external-link">layout.auto</a></code> <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">plot.igraph</a></code>
<code><a href="poppr.msn.html">poppr.msn</a></code> <code><a href="bruvo.msn.html">bruvo.msn</a></code> <code><a href="greycurve.html">greycurve</a></code>
<code><a href="https://r.igraph.org/reference/delete_edges.html" class="external-link">delete_edges</a></code> <code><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Zhian N. Kamvar</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Using a data set of the Aphanomyces eutieches root rot pathogen.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Aeut</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adist</span> <span class="op">&lt;-</span> <span class="fu"><a href="diss.dist.html">diss.dist</a></span><span class="op">(</span><span class="va">Aeut</span>, percent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">amsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="poppr.msn.html">poppr.msn</a></span><span class="op">(</span><span class="va">Aeut</span>, <span class="va">adist</span>, showplot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r.igraph.org/" class="external-link">"igraph"</a></span><span class="op">)</span> <span class="co"># To get all the layouts.</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘igraph’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:ape’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     degree, edges, mst, ring</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     decompose, spectrum</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     union</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">Aeut</span>, <span class="va">amsn</span>, gadj <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Different layouts (from igraph) can be used by supplying the function name.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">Aeut</span>, <span class="va">amsn</span>, gadj <span class="op">=</span> <span class="fl">15</span>, layfun <span class="op">=</span> <span class="va">layout_with_kk</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Removing link between populations (cutoff = 0.2) and labelling no individuals</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">Aeut</span>, <span class="va">amsn</span>, inds <span class="op">=</span> <span class="st">"none"</span>, gadj <span class="op">=</span> <span class="fl">15</span>, beforecut <span class="op">=</span> <span class="cn">TRUE</span>, cutoff <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Labelling individual #57 because it is an MLG that crosses populations</span></span></span>
<span class="r-in"><span><span class="co"># Showing clusters of MLGS with at most 5% variation</span></span></span>
<span class="r-in"><span><span class="co"># Notice that the Mt. Vernon population appears to be more clonal</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">Aeut</span>, <span class="va">amsn</span>, gadj <span class="op">=</span> <span class="fl">15</span>, cutoff <span class="op">=</span> <span class="fl">0.05</span>, inds <span class="op">=</span> <span class="st">"057"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">partial_clone</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcmsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="bruvo.msn.html">bruvo.msn</a></span><span class="op">(</span><span class="va">partial_clone</span>, replen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can plot using a color palette or a vector of named colors</span></span></span>
<span class="r-in"><span><span class="co"># Here's a way to define the colors beforehand</span></span></span>
<span class="r-in"><span><span class="va">pc_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">nPop</a></span><span class="op">(</span><span class="va">partial_clone</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="st">"Set2"</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">popNames</a></span><span class="op">(</span><span class="va">partial_clone</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pc_colors</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1         2         3         4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "#66C2A5" "#FC8D62" "#8DA0CB" "#E78AC3" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Labelling the samples contained in multilocus genotype 9</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">partial_clone</span>, <span class="va">pcmsn</span>, palette <span class="op">=</span> <span class="va">pc_colors</span>, inds <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Doing the same thing, but using one of the sample names as input.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">partial_clone</span>, <span class="va">pcmsn</span>, palette <span class="op">=</span> <span class="va">pc_colors</span>, inds <span class="op">=</span> <span class="st">"sim 20"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that this is case sensitive. Nothing is labeled. </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">partial_clone</span>, <span class="va">pcmsn</span>, palette <span class="op">=</span> <span class="va">pc_colors</span>, inds <span class="op">=</span> <span class="st">"Sim 20"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Something pretty</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">microbov</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="diss.dist.html">diss.dist</a></span><span class="op">(</span><span class="va">microbov</span>, percent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">micmsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="poppr.msn.html">poppr.msn</a></span><span class="op">(</span><span class="va">microbov</span>, <span class="va">mdist</span>, showplot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">microbov</span>, <span class="va">micmsn</span>, palette <span class="op">=</span> <span class="st">"terrain.colors"</span>, inds <span class="op">=</span> <span class="st">"n"</span>, </span></span>
<span class="r-in"><span>  quantiles <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">microbov</span>, <span class="va">micmsn</span>, palette <span class="op">=</span> <span class="st">"terrain.colors"</span>, inds <span class="op">=</span> <span class="st">"n"</span>, </span></span>
<span class="r-in"><span>  cutoff <span class="op">=</span> <span class="fl">0.3</span>, quantiles <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">### Utilizing vectors for palettes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Pram</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Pram_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="popsub.html">popsub</a></span><span class="op">(</span><span class="va">Pram</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nursery_CA"</span>, <span class="st">"Nursery_OR"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Creating the network for the forest</span></span></span>
<span class="r-in"><span><span class="va">min_span_net_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="bruvo.msn.html">bruvo.msn</a></span><span class="op">(</span><span class="va">Pram_sub</span>, replen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">other</a></span><span class="op">(</span><span class="va">Pram</span><span class="op">)</span><span class="op">$</span><span class="va">REPLEN</span>, </span></span>
<span class="r-in"><span>                              add <span class="op">=</span> <span class="cn">TRUE</span>, loss <span class="op">=</span> <span class="cn">TRUE</span>, showplot <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>                              include.ties <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>                              </span></span>
<span class="r-in"><span><span class="co"># Creating the network with nurseries</span></span></span>
<span class="r-in"><span><span class="va">min_span_net</span>     <span class="op">&lt;-</span> <span class="fu"><a href="bruvo.msn.html">bruvo.msn</a></span><span class="op">(</span><span class="va">Pram</span>, replen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">other</a></span><span class="op">(</span><span class="va">Pram</span><span class="op">)</span><span class="op">$</span><span class="va">REPLEN</span>, </span></span>
<span class="r-in"><span>                              add <span class="op">=</span> <span class="cn">TRUE</span>, loss <span class="op">=</span> <span class="cn">TRUE</span>, showplot <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>                              include.ties <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Only forest genotypes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">Pram</span>,</span></span>
<span class="r-in"><span>               <span class="va">min_span_net_sub</span>,</span></span>
<span class="r-in"><span>               inds <span class="op">=</span> <span class="st">"ALL"</span>,</span></span>
<span class="r-in"><span>               mlg <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               gadj <span class="op">=</span> <span class="fl">9</span>,</span></span>
<span class="r-in"><span>               nodescale <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>               palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">other</a></span><span class="op">(</span><span class="va">Pram</span><span class="op">)</span><span class="op">$</span><span class="va">comparePal</span>,</span></span>
<span class="r-in"><span>               cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>               quantiles <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>               beforecut <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With Nurseries</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_poppr_msn</span><span class="op">(</span><span class="va">Pram</span>,</span></span>
<span class="r-in"><span>               <span class="va">min_span_net</span>,</span></span>
<span class="r-in"><span>               inds <span class="op">=</span> <span class="st">"ALL"</span>,</span></span>
<span class="r-in"><span>               mlg <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               gadj <span class="op">=</span> <span class="fl">9</span>,</span></span>
<span class="r-in"><span>               nodescale <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>               palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">other</a></span><span class="op">(</span><span class="va">Pram</span><span class="op">)</span><span class="op">$</span><span class="va">comparePal</span>,</span></span>
<span class="r-in"><span>               cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>               quantiles <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>               beforecut <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_poppr_msn-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks, David Folarin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

