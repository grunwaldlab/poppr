<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform a bootstrap analysis on diversity statistics — diversity_boot • poppr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">poppr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform a bootstrap analysis on diversity statistics</h1>
    </div>

    
    <p>This function is intended to perform bootstrap statistics on a matrix of
multilocus genotype counts in different populations. Results from this 
function should be interpreted carefully as the default statistics are known
to have a downward bias. See the details for more information.</p>
    

    <pre class="usage"><span class='fu'>diversity_boot</span>(<span class='no'>tab</span>, <span class='no'>n</span>, <span class='kw'>n.boot</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>n.rare</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>H</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>G</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>E5</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tab</th>
      <td><p>a table produced from the <span class="pkg">poppr</span> function 
<code><a href='mlg.html'>mlg.table</a></code>. MLGs in columns and populations in rows</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>an integer &gt; 0 specifying the number of bootstrap replicates to 
perform (corresponds to <code>R</code> in the function <code><a href='http://www.rdocumentation.org/packages/boot/topics/boot'>boot</a></code>.</p></td>
    </tr>
    <tr>
      <th>n.boot</th>
      <td><p>an integer specifying the number of samples to be drawn in each
bootstrap replicate. If <code>n.boot</code> &lt; 2 (default), the number of samples 
drawn for each bootstrap replicate will be equal to the number of samples in
the data set.</p></td>
    </tr>
    <tr>
      <th>n.rare</th>
      <td><p>a sample size at which all resamplings should be performed. 
This should be no larger than the smallest sample size. Defaults to 
<code>NULL</code>, indicating that each population will be sampled at its own 
size.</p></td>
    </tr>
    <tr>
      <th>H</th>
      <td><p>logical whether or not to calculate Shannon's index</p></td>
    </tr>
    <tr>
      <th>G</th>
      <td><p>logical whether or not to calculate Stoddart and Taylor's index (aka
inverse Simpson's index).</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>logical whether or not to calculate Simpson's index</p></td>
    </tr>
    <tr>
      <th>E5</th>
      <td><p>logical whether or not to calculate Evenness</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other parameters passed on to <code><a href='http://www.rdocumentation.org/packages/boot/topics/boot'>boot</a></code> and 
<code><a href='diversity_stats.html'>diversity_stats</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of objects of class "boot".</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Bootstrapping is performed in three ways:</p><ul>
<li><p>if <code>n.rare</code> is a number greater than zero, then bootstrapping
    is performed by randomly sampling without replacement <em>n.rare</em>
    samples from the data.</p></li>
<li><p>if <code>n.boot</code> is greater than 1, bootstrapping is performed by
    sampling n.boot samples from a multinomial distribution weighted by the
    proportion of each MLG in the data.</p></li>
<li><p>if <code>n.boot</code> is less than 2, bootstrapping is performed by 
    sampling N samples from a multinomial distribution weighted by the
    proportion of each MLG in the data.</p></li>
</ul><p></p><h3>Downward Bias</h3>
    When sampling with replacement, the diversity statistics here present a 
    downward bias partially due to the small number of samples in the data. 
    The result is that the mean of the bootstrapped samples will often be 
    much lower than the observed value. Alternatively, you can increase the
    sample size of the bootstrap by increasing the size of <code>n.boot</code>. Both
    of these methods should be taken with caution in interpretation. There
    are several R packages freely available that will calculate and perform
    bootstrap estimates of Shannon and Simpson diversity metrics (eg.
    <span class="pkg">entropart</span>, <span class="pkg">entropy</span>, <span class="pkg">simboot</span>, and
    <span class="pkg">EntropyEstimation</span>. These packages also offer unbiased estimators of
    Shannon and Simpson diversity. Please take care when attempting to
    interpret the results of this function.
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='diversity_stats.html'>diversity_stats</a></code> for basic statistic calculation, 
   <code><a href='diversity_ci.html'>diversity_ci</a></code> for confidence intervals and plotting, and 
   <code><a href='poppr.html'>poppr</a></code>. For bootstrap sampling:
   <code><a href='http://www.rdocumentation.org/packages/stats/topics/Multinom'>rmultinom</a></code> <code><a href='http://www.rdocumentation.org/packages/boot/topics/boot'>boot</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>poppr</span>)
<span class='fu'>data</span>(<span class='no'>Pinf</span>)
<span class='no'>tab</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mlg.html'>mlg.table</a></span>(<span class='no'>Pinf</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>diversity_boot</span>(<span class='no'>tab</span>, <span class='fl'>10L</span>)</div><div class='output co'>#&gt; $`South America`
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", 
#&gt;     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;       original      bias    std. error
#&gt; t1*  3.2679442 -0.38804962 0.106133408
#&gt; t2* 23.2903226 -7.86903032 1.798596030
#&gt; t3*  0.9570637 -0.02271468 0.007703289
#&gt; t4*  0.8825297 -0.03006253 0.029065273
#&gt; 
#&gt; $`North America`
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = xi, statistic = boot_stats, R = n, sim = "parametric", 
#&gt;     ran.gen = rg, mle = mle, H = H, G = G, lambda = lambda, E5 = E5)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;       original        bias    std. error
#&gt; t1*  3.6870132  -0.526620822 0.053199706
#&gt; t2* 34.9090909 -14.140516563 1.727063543
#&gt; t3*  0.9713542  -0.019791667 0.003856095
#&gt; t4*  0.8711297   0.002207739 0.037392011
#&gt; </div><div class='input'><span class='fu'>not_run</span>({
  <span class='co'># This can be done in a parallel fashion (OSX uses "multicore", Windows uses "snow")</span>
  <span class='fu'>system.time</span>(<span class='fu'>diversity_boot</span>(<span class='no'>tab</span>, <span class='fl'>10000L</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='st'>"multicore"</span>, <span class='kw'>ncpus</span> <span class='kw'>=</span> <span class='fl'>4L</span>))
  <span class='fu'>system.time</span>(<span class='fu'>diversity_boot</span>(<span class='no'>tab</span>, <span class='fl'>10000L</span>))
})</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Zhian N. Kamvar

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
