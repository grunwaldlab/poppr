<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Probability of encountering a genotype more than once by chance — psex • poppr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Probability of encountering a genotype more than once by chance — psex" />

<meta property="og:description" content="Probability of encountering a genotype more than once by chance" />
<meta name="twitter:card" content="summary" />
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">poppr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Probability of encountering a genotype more than once by chance</h1>
    <small>Source: <a href='https:/github.com/grunwaldlab/poppr/blob/master/R/round_robin.R'><code>R/round_robin.R</code></a></small>
    </div>

    
    <p>Probability of encountering a genotype more than once by chance</p>
    

    <pre class="usage"><span class='fu'>psex</span>(<span class='no'>gid</span>, <span class='kw'>pop</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>freq</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>G</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"single"</span>, <span class='st'>"multiple"</span>), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gid</th>
      <td><p>a genind or genclone object.</p></td>
    </tr>
    <tr>
      <th>pop</th>
      <td><p>either a formula to set the population factor from the 
<code>strata</code> slot or a vector specifying the population factor for 
each sample. Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>by_pop</th>
      <td><p>When this is <code>TRUE</code> (default), the calculation will be
done by population.</p></td>
    </tr>
    <tr>
      <th>freq</th>
      <td><p>a vector or matrix of allele frequencies. This defaults to 
<code>NULL</code>, indicating that the frequencies will be determined via 
round-robin approach in <code><a href='rraf.html'>rraf</a></code>. <strong>If this matrix or 
vector is not provided, zero-value allele frequencies will automatically be
corrected.</strong> For details, please see the documentation on
<a href='rare_allele_correction.html'>correcting rare alleles</a>.</p></td>
    </tr>
    <tr>
      <th>G</th>
      <td><p>an integer vector specifying the number of observed genets. If NULL,
this will be the number of original multilocus genotypes for 
<code>method = "single"</code> and the number of populations for 
<code>method = "multiple"</code>. <code>G</code> can also be a <strong>named</strong> integer 
vector for each population if <code>by_pop = TRUE</code>. Unnamed vectors with
a lengths greater than 1 will throw an error.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>which method of calculating psex should be used? Using 
<code>method = "single"</code> (default) indicates that the calculation for psex 
should reflect the probability of encountering a second genotype. Using 
<code>method = "multiple"</code> gives the probability of encountering multiple 
samples of the same genotype (see details).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>options from <a href='rare_allele_correction.html'>correcting rare
alleles</a>. The default is to correct allele frequencies to 1/n</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a vector of Psex for each sample.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <h3>single encounter:</h3>
    Psex is the probability of encountering a given genotype more than 
  once by chance. The basic equation from Parks and Werth (1993) is
    $$p_{sex} = 1 - (1 - p_{gen})^{G})$$
    where <em>G</em> is the number of multilocus genotypes and <em>pgen</em> is the
  probability of a given genotype (see
  <code><a href='pgen.html'>pgen</a></code> for its calculation). For a given value of alpha (e.g.
  alpha = 0.05), genotypes with psex &lt; alpha can be thought of as a single
  genet whereas genotypes with psex &gt; alpha do not have strong evidence that
  members belong to the same genet (Parks and Werth, 1993).
    <h3>multiple encounters:</h3>
    When <code>method = "multiple"</code>, the method from Arnaud-Haond et al. (1997)
  is used where the sum of the binomial density is taken.
    $$
  p_{sex} = \sum_{i = n}^N {N \choose i} \left(p_{gen}\right)^i\left(1 - p_{gen}\right)^{N - i}
  $$
    where <em>N</em> is the number of sampling units <em>i</em> is the ith - 1 
  encounter of a given genotype, and <em>pgen</em> is the value of pgen for 
  that genotype. This procedure is performed for all samples in the data.
  For example, if you have a genotype whose pgen value was 0.0001, with 5 
  observations out of 100 samples, the value of psex is computed like so:
  <pre>
  dbinom(0:4, 100, 0.0001)</pre>
    <h3>using by_pop = TRUE and modifying G:</h3>
    It is possible to modify <code>G</code> for single or multiple encounters. With
  <code>method = "single"</code>, <code>G</code> takes place of the exponent, whereas 
  with <code>method = "multiple"</code>, <code>G</code> replaces <code>N</code> (see above). 
  If you supply a named vector for <code>G</code> with the population names and
  <code>by_pop = TRUE</code>, then the value of <code>G</code> will be different for each
  population.
    For example, in the case of <code>method = "multiple"</code>, let's say you have
  two populations that share a genotype between them. The size of population
  A and B are 25 and 75, respectively, The values of pgen for that genotype
  in population A and B are 0.005 and 0.0001, respectively, and the number of
  samples with the genotype in popualtions A and B are 4 and 6, respectively.
  In this case psex for this genotype would be calculated for each population
  separately if we don't specify <code>G</code>:
  <pre>
  psexA = dbinom(0:3, 25, 0.005)
  psexB = dbinom(0:5, 75, 0.0001)</pre>
  If we specify <code>G = 100</code>, then it changes to:
  <pre>
  psexA = dbinom(0:3, 100, 0.005)
  psexB = dbinom(0:5, 100, 0.0001)</pre>
  We could also specify G to be the number of genotypes observed in the 
  population (let's say A = 10, B = 20)
  <pre>
  psexA = dbinom(0:3, 10, 0.005)
  psexB = dbinom(0:5, 20, 0.0001)</pre>
<p>Unless <code>freq</code> is supplied, the function will automatically calculate
  the round-robin allele frequencies with <code><a href='rraf.html'>rraf</a></code> and <em>G</em>
  with <code><a href='mll-method.html'>nmll</a></code>.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The values of Psex represent the value for each multilocus genotype. 
  Additionally, when the argument <code>pop</code> is not <code>NULL</code>, 
  <code>by_pop</code> is automatically <code>TRUE</code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Arnaud-Haond, S., Duarte, C. M., Alberto, F., &amp; Serrão, E. A. 2007. 
Standardizing methods to address clonality in population studies. 
<em>Molecular Ecology</em>, 16(24), 5115-5139.</p>
<p>Parks, J. C., &amp; Werth, C. R. 1993. A study of spatial features of clones in a
population of bracken fern, <em>Pteridium aquilinum</em> (Dennstaedtiaceae). 
<em>American Journal of Botany</em>, 537-544.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='pgen.html'>pgen</a></code>, <code><a href='rraf.html'>rraf</a></code>, <code><a href='rrmlg.html'>rrmlg</a></code>,
<code><a href='rare_allele_correction.html'>rare_allele_correction</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>Pram</span>)

<span class='co'># With multiple encounters</span>
<span class='no'>Pram_psex</span> <span class='kw'>&lt;-</span> <span class='fu'>psex</span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"multiple"</span>)
<span class='fu'>plot</span>(<span class='no'>Pram_psex</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='st'>"y"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>ifelse</span>(<span class='no'>Pram_psex</span> <span class='kw'>&gt;</span> <span class='fl'>0.05</span>, <span class='st'>"red"</span>, <span class='st'>"blue"</span>))</div><div class='input'><span class='fu'>abline</span>(<span class='kw'>h</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='input'><span class='fu'>title</span>(<span class='st'>"Probability of multiple encounters"</span>)</div><div class='img'><img src='psex-1.png' alt='' width='700' height='432.632880098887' /></div><span class='co'># NOT RUN {</span>
<span class='co'># For a single encounter (default)</span>
<span class='no'>Pram_psex</span> <span class='kw'>&lt;-</span> <span class='fu'>psex</span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>plot</span>(<span class='no'>Pram_psex</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='st'>"y"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>ifelse</span>(<span class='no'>Pram_psex</span> <span class='kw'>&gt;</span> <span class='fl'>0.05</span>, <span class='st'>"red"</span>, <span class='st'>"blue"</span>))
<span class='fu'>abline</span>(<span class='kw'>h</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>title</span>(<span class='st'>"Probability of second encounter"</span>)

<span class='co'># This can be also done assuming populations structure</span>
<span class='no'>Pram_psex</span> <span class='kw'>&lt;-</span> <span class='fu'>psex</span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"multiple"</span>)
<span class='fu'>plot</span>(<span class='no'>Pram_psex</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='st'>"y"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>ifelse</span>(<span class='no'>Pram_psex</span> <span class='kw'>&gt;</span> <span class='fl'>0.05</span>, <span class='st'>"red"</span>, <span class='st'>"blue"</span>))
<span class='fu'>abline</span>(<span class='kw'>h</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>title</span>(<span class='st'>"Probability of multiple encounters\nwith pop structure"</span>)

<span class='co'># The above, but correcting zero-value alleles by 1/(2*rrmlg) with no </span>
<span class='co'># population structure assumed</span>
<span class='co'># Type ?rare_allele_correction for details.</span>
<span class='no'>Pram_psex2</span> <span class='kw'>&lt;-</span> <span class='fu'>psex</span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='st'>"rrmlg"</span>, <span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>2</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"multiple"</span>)
<span class='fu'>plot</span>(<span class='no'>Pram_psex2</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='st'>"y"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>ifelse</span>(<span class='no'>Pram_psex2</span> <span class='kw'>&gt;</span> <span class='fl'>0.05</span>, <span class='st'>"red"</span>, <span class='st'>"blue"</span>))
<span class='fu'>abline</span>(<span class='kw'>h</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>title</span>(<span class='st'>"Probability of multiple encounters\nwith pop structure (1/(2*rrmlg))"</span>)

<span class='co'># We can also set G to the total population size</span>
(<span class='no'>G</span> <span class='kw'>&lt;-</span> <span class='fu'>nInd</span>(<span class='no'>Pram</span>))
<span class='no'>Pram_psex</span> <span class='kw'>&lt;-</span> <span class='fu'>psex</span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"multiple"</span>, <span class='kw'>G</span> <span class='kw'>=</span> <span class='no'>G</span>)
<span class='fu'>plot</span>(<span class='no'>Pram_psex</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='st'>"y"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>ifelse</span>(<span class='no'>Pram_psex</span> <span class='kw'>&gt;</span> <span class='fl'>0.05</span>, <span class='st'>"red"</span>, <span class='st'>"blue"</span>))
<span class='fu'>abline</span>(<span class='kw'>h</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>title</span>(<span class='st'>"Probability of multiple encounters\nwith pop structure G = 729"</span>)

<span class='co'># Or we can set G to the number of unique MLGs</span>
(<span class='no'>G</span> <span class='kw'>&lt;-</span> <span class='fu'>rowSums</span>(<span class='fu'><a href='mlg.html'>mlg.table</a></span>(<span class='no'>Pram</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>) <span class='kw'>&gt;</span> <span class='fl'>0</span>))
<span class='no'>Pram_psex</span> <span class='kw'>&lt;-</span> <span class='fu'>psex</span>(<span class='no'>Pram</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"multiple"</span>, <span class='kw'>G</span> <span class='kw'>=</span> <span class='no'>G</span>)
<span class='fu'>plot</span>(<span class='no'>Pram_psex</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='st'>"y"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>ifelse</span>(<span class='no'>Pram_psex</span> <span class='kw'>&gt;</span> <span class='fl'>0.05</span>, <span class='st'>"red"</span>, <span class='st'>"blue"</span>))
<span class='fu'>abline</span>(<span class='kw'>h</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>title</span>(<span class='st'>"Probability of multiple encounters\nwith pop structure G = nmll"</span>)

<span class='co'>## An example of supplying previously calculated frequencies and G</span>
<span class='co'># From Parks and Werth, 1993, using the first three genotypes.</span>

<span class='co'># The row names indicate the number of samples found with that genotype</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='st'>"
 Hk Lap Mdh2 Pgm1 Pgm2 X6Pgd2
54 12 12 12 23 22 11
36 22 22 11 22 33 11
10 23 22 11 33 13 13"</span>

<span class='co'># Since we aren't representing the whole data set here, we are defining the</span>
<span class='co'># allele frequencies before the analysis.</span>
<span class='no'>afreq</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='kw'>Hk.1</span> <span class='kw'>=</span> <span class='fl'>0.167</span>, <span class='kw'>Hk.2</span> <span class='kw'>=</span> <span class='fl'>0.795</span>, <span class='kw'>Hk.3</span> <span class='kw'>=</span> <span class='fl'>0.038</span>,
           <span class='kw'>Lap.1</span> <span class='kw'>=</span> <span class='fl'>0.190</span>, <span class='kw'>Lap.2</span> <span class='kw'>=</span> <span class='fl'>0.798</span>, <span class='kw'>Lap.3</span> <span class='kw'>=</span> <span class='fl'>0.012</span>,
           <span class='kw'>Mdh2.0</span> <span class='kw'>=</span> <span class='fl'>0.011</span>, <span class='kw'>Mdh2.1</span> <span class='kw'>=</span> <span class='fl'>0.967</span>, <span class='kw'>Mdh2.2</span> <span class='kw'>=</span> <span class='fl'>0.022</span>,
           <span class='kw'>Pgm1.2</span> <span class='kw'>=</span> <span class='fl'>0.279</span>, <span class='kw'>Pgm1.3</span> <span class='kw'>=</span> <span class='fl'>0.529</span>, <span class='kw'>Pgm1.4</span> <span class='kw'>=</span> <span class='fl'>0.162</span>, <span class='kw'>Pgm1.5</span> <span class='kw'>=</span> <span class='fl'>0.029</span>,
           <span class='kw'>Pgm2.1</span> <span class='kw'>=</span> <span class='fl'>0.128</span>, <span class='kw'>Pgm2.2</span> <span class='kw'>=</span> <span class='fl'>0.385</span>, <span class='kw'>Pgm2.3</span> <span class='kw'>=</span> <span class='fl'>0.487</span>,
           <span class='kw'>X6Pgd2.1</span> <span class='kw'>=</span> <span class='fl'>0.526</span>, <span class='kw'>X6Pgd2.2</span> <span class='kw'>=</span> <span class='fl'>0.051</span>, <span class='kw'>X6Pgd2.3</span> <span class='kw'>=</span> <span class='fl'>0.423</span>)

<span class='no'>xtab</span> <span class='kw'>&lt;-</span> <span class='fu'>read.table</span>(<span class='kw'>text</span> <span class='kw'>=</span> <span class='no'>x</span>, <span class='kw'>header</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'># Here we are expanding the number of samples to their observed values.</span>
<span class='co'># Since we have already defined the allele frequencies, this step is actually</span>
<span class='co'># not necessary. </span>
<span class='no'>all_samples</span> <span class='kw'>&lt;-</span> <span class='fu'>rep</span>(<span class='fu'>rownames</span>(<span class='no'>xtab</span>), <span class='fu'>as.integer</span>(<span class='fu'>rownames</span>(<span class='no'>xtab</span>)))
<span class='no'>xgid</span>        <span class='kw'>&lt;-</span> <span class='fu'>df2genind</span>(<span class='no'>xtab</span>[<span class='no'>all_samples</span>, ], <span class='kw'>ncode</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='no'>freqs</span> <span class='kw'>&lt;-</span> <span class='no'>afreq</span>[<span class='fu'>colnames</span>(<span class='fu'>tab</span>(<span class='no'>xgid</span>))] <span class='co'># only used alleles in the sample</span>
<span class='no'>pSex</span>  <span class='kw'>&lt;-</span> <span class='fu'>psex</span>(<span class='no'>xgid</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>freq</span> <span class='kw'>=</span> <span class='no'>freqs</span>, <span class='kw'>G</span> <span class='kw'>=</span> <span class='fl'>45</span>)

<span class='co'># Note, pgen returns log values for each locus, here we take the sum across</span>
<span class='co'># all loci and take the exponent to give us the value of pgen for each sample</span>
<span class='no'>pGen</span> <span class='kw'>&lt;-</span> <span class='fu'>exp</span>(<span class='fu'>rowSums</span>(<span class='fu'><a href='pgen.html'>pgen</a></span>(<span class='no'>xgid</span>, <span class='kw'>by_pop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>freq</span> <span class='kw'>=</span> <span class='no'>freqs</span>)))

<span class='no'>res</span>  <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fu'>unique</span>(<span class='no'>pGen</span>), <span class='fu'>unique</span>(<span class='no'>pSex</span>)), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>colnames</span>(<span class='no'>res</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"Pgen"</span>, <span class='st'>"Psex"</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>cbind</span>(<span class='no'>xtab</span>, <span class='kw'>nRamet</span> <span class='kw'>=</span> <span class='fu'>rownames</span>(<span class='no'>xtab</span>), <span class='fu'>round</span>(<span class='no'>res</span>, <span class='fl'>5</span>))
<span class='fu'>rownames</span>(<span class='no'>res</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='fl'>3</span>
<span class='no'>res</span> <span class='co'># Compare to the first three rows of Table 2 in Parks &amp; Werth, 1993</span>
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Zhian N. Kamvar, Jonah Brooks, Stacy A. Krueger-Hadfield, Erik Sotka

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

