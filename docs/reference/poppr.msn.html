<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a minimum spanning network of selected populations using a distance 
matrix. — poppr.msn • poppr</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Create a minimum spanning network of selected populations using a distance 
matrix. — poppr.msn" />

<meta property="og:description" content="Create a minimum spanning network of selected populations using a distance 
matrix." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poppr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/poppr-package.html#functions-in-poppr">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a minimum spanning network of selected populations using a distance 
matrix.</h1>
    <small class="dont-index">Source: <a href='https://github.com/grunwaldlab/poppr/blob/master/R/visualizations.r'><code>R/visualizations.r</code></a></small>
    <div class="hidden name"><code>poppr.msn.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Create a minimum spanning network of selected populations using a distance 
matrix.</p>
    
    </div>

    <pre class="usage"><span class='fu'>poppr.msn</span>(<span class='no'>gid</span>, <span class='no'>distmat</span>, <span class='kw'>palette</span> <span class='kw'>=</span> <span class='no'>topo.colors</span>,
  <span class='kw'>mlg.compute</span> <span class='kw'>=</span> <span class='st'>"original"</span>, <span class='kw'>sublist</span> <span class='kw'>=</span> <span class='st'>"All"</span>, <span class='kw'>blacklist</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>vertex.label</span> <span class='kw'>=</span> <span class='st'>"MLG"</span>, <span class='kw'>gscale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>glim</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0.8</span>), <span class='kw'>gadj</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>gweight</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>wscale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>showplot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>include.ties</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>clustering.algorithm</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gid</th>
      <td><p>a <code>genind</code>, <code><a href='genclone-class.html'>genclone</a></code>,
<code>genlight</code>, or <code><a href='genclone-class.html'>snpclone</a></code> object</p></td>
    </tr>
    <tr>
      <th>distmat</th>
      <td><p>a distance matrix that has been derived from your data set.</p></td>
    </tr>
    <tr>
      <th>palette</th>
      <td><p>a <code>vector</code> or <code>function</code> defining the color palette 
to be used to color the populations on the graph. It defaults to 
<code><a href='https://www.rdocumentation.org/packages/grDevices/topics/palettes'>topo.colors</a></code>. See examples for details.</p></td>
    </tr>
    <tr>
      <th>mlg.compute</th>
      <td><p>if the multilocus genotypes are set to "custom" (see 
<code><a href='mll.custom.html'>mll.custom</a></code> for details) in your genclone object, this will 
specify which mlg level to calculate the nodes from. See details.</p></td>
    </tr>
    <tr>
      <th>sublist</th>
      <td><p>a <code>vector</code> of population names or indexes that the user 
wishes to keep. Default to "ALL".</p></td>
    </tr>
    <tr>
      <th>blacklist</th>
      <td><p>a <code>vector</code> of population names or indexes that the user
wishes to discard. Default to <code>NULL</code></p></td>
    </tr>
    <tr>
      <th>vertex.label</th>
      <td><p>a <code>vector</code> of characters to label each vertex. There
are two defaults: <code>"MLG"</code> will label the nodes with the multilocus 
genotype from the original data set and <code>"inds"</code> will label the nodes 
with the representative individual names.</p></td>
    </tr>
    <tr>
      <th>gscale</th>
      <td><p>"grey scale". If this is <code>TRUE</code>, this will scale the color
of the edges proportional to the observed distance, with the lines becoming
darker for more related nodes. See <code><a href='greycurve.html'>greycurve</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>glim</th>
      <td><p>"grey limit". Two numbers between zero and one. They determine 
the upper and lower limits for the <code><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray'>gray</a></code> function. Default is 
0 (black) and 0.8 (20% black). See <code><a href='greycurve.html'>greycurve</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>gadj</th>
      <td><p>"grey adjust". a positive <code>integer</code> greater than zero that 
will serve as the exponent to the edge weight to scale the grey value to 
represent that weight. See <code><a href='greycurve.html'>greycurve</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>gweight</th>
      <td><p>"grey weight". an <code>integer</code>. If it's 1, the grey scale 
will be weighted to emphasize the differences between closely related 
nodes. If it is 2, the grey scale will be weighted to emphasize the 
differences between more distantly related nodes. See 
<code><a href='greycurve.html'>greycurve</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>wscale</th>
      <td><p>"width scale". If this is <code>TRUE</code>, the edge widths will be 
scaled proportional to the inverse of the observed distance , with the 
lines becoming thicker for more related nodes.</p></td>
    </tr>
    <tr>
      <th>showplot</th>
      <td><p>logical. If <code>TRUE</code>, the graph will be plotted. If 
<code>FALSE</code>, it will simply be returned.</p></td>
    </tr>
    <tr>
      <th>include.ties</th>
      <td><p>logical. If <code>TRUE</code>, the graph will include all edges
that were arbitrarily passed over in favor of another edge of equal weight.
If <code>FALSE</code>, which is the default, one edge will be arbitrarily 
selected when two or more edges are tied, resulting in a pure minimum
spanning network.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>numeric. By default, this is <code>NULL</code>, which will have no
effect. Any threshold value passed to this argument will be used in
<code><a href='mlg.filter.html'>mlg.filter</a></code> prior to creating the MSN. If you have a data set
that contains contracted MLGs, this argument will override the threshold in
the data set. See Details.</p></td>
    </tr>
    <tr>
      <th>clustering.algorithm</th>
      <td><p>string. By default, this is <code>NULL</code>. If
<code>threshold = NULL</code>, this argument will have no effect. When supplied
with either "farthest_neighbor", "average_neighbor", or "nearest_neighbor",
it will be passed to <code><a href='mlg.filter.html'>mlg.filter</a></code> prior to creating the MSN. If
you have a data set that contains contracted MLGs, this argument will
override the algorithm in the data set. See Details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>any other arguments that could go into plot.igraph</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>graph</dt><dd><p>a minimum spanning network with nodes corresponding to 
  MLGs within the data set. Colors of the nodes represent population 
  membership. Width and color of the edges represent distance.</p></dd> 
  <dt>populations</dt><dd><p>a vector of the population names corresponding to the 
  vertex colors</p></dd> <dt>colors</dt><dd><p>a vector of the hexadecimal representations of
  the colors used in the vertex colors</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The minimum spanning network generated by this function is generated
  via igraph's <code><a href='https://www.rdocumentation.org/packages/igraph/topics/mst'>minimum.spanning.tree</a></code>. The resultant
  graph produced can be plotted using igraph functions, or the entire object
  can be plotted using the function <code><a href='plot_poppr_msn.html'>plot_poppr_msn</a></code>, which will
  give the user a scale bar and the option to layout your data.</p><h3>node sizes</h3>
    The area of the nodes are representative of the number of samples. Because
  <span class="pkg">igraph</span> scales nodes by radius, the node sizes in the graph are 
  represented as the square root of the number of samples.<p></p><h3>mlg.compute</h3>
    Each node on the graph represents a different multilocus genotype. 
  The edges on the graph represent genetic distances that connect the
  multilocus genotypes. In genclone objects, it is possible to set the
  multilocus genotypes to a custom definition. This creates a problem for
  clone correction, however, as it is very possible to define custom lineages
  that are not monophyletic. When clone correction is performed on these
  definitions, information is lost from the graph. To circumvent this, The
  clone correction will be done via the computed multilocus genotypes, either
  "original" or "contracted". This is specified in the <code>mlg.compute</code>
  argument, above.<p></p><h3>contracted multilocus genotypes</h3>
    If your incoming data set is of the class <code><a href='genclone-class.html'>genclone</a></code>,
  and it contains contracted multilocus genotypes, this function will retain
  that information for creating the minimum spanning network. You can use the
  arguments <code>threshold</code> and <code>clustering.algorithm</code> to change the
  threshold or clustering algorithm used in the network. For example, if you
  have a data set that has a threshold of 0.1 and you wish to have a minimum
  spanning network without a threshold, you can simply add 
  <code>threshold = 0.0</code>, and no clustering will happen.
    The <code>threshold</code> and <code>clustering.algorithm</code> arguments can also be
  used to filter un-contracted data sets.
    All filtering will use the distance matrix supplied in the argument 
  <code>distmat</code>.
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The edges of these graphs may cross each other if the graph becomes too
  large.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot_poppr_msn.html'>plot_poppr_msn</a></code> <code>nancycats</code>,
  <code>upgma</code>, <code>nj</code>, <code>nodelabels</code>,
  <code>tab</code>, <code><a href='missingno.html'>missingno</a></code>, <code><a href='bruvo.msn.html'>bruvo.msn</a></code>,
  <code><a href='greycurve.html'>greycurve</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Load the data set and calculate the distance matrix for all individuals.</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>Aeut</span>)
<span class='no'>A.dist</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='diss.dist.html'>diss.dist</a></span>(<span class='no'>Aeut</span>)

<span class='co'># Graph it.</span>
<span class='no'>A.msn</span> <span class='kw'>&lt;-</span> <span class='fu'>poppr.msn</span>(<span class='no'>Aeut</span>, <span class='no'>A.dist</span>, <span class='kw'>gadj</span> <span class='kw'>=</span> <span class='fl'>15</span>, <span class='kw'>vertex.label</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</div><div class='img'><img src='poppr.msn-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Find the sizes of the nodes (number of individuals per MLL):</span>
<span class='kw pkg'>igraph</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/igraph/topics/vertex_attr'>vertex_attr</a></span>(<span class='no'>A.msn</span>$<span class='no'>graph</span>, <span class='st'>"size"</span>)^<span class='fl'>2</span></div><div class='output co'>#&gt;   [1]  2  1  2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  9  1  1  5  1  1
#&gt;  [26]  2  1  1  1  1  2  3  1  1  2  1  1  1  2  1  1  1  1  1  1  2  1  2  1  1
#&gt;  [51]  1  2  1  3  1  1  1  1  1  2  1  1  1  2  1  1  1  1  1  1  1  1  1  2  1
#&gt;  [76]  2  1  1 10  1  1  1  1  1  1  1  1  1  1  2  5  2  2  1  2  1  5  2  2  3
#&gt; [101]  1  4  1  1  2  1  1  1  1  2  3  1  2  2  1  1  2  1  4</div><div class='input'>
</div><div class='input'><span class='co'># Set subpopulation structure.</span>
<span class='no'>Aeut.sub</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='coercion-methods.html'>as.genclone</a></span>(<span class='no'>Aeut</span>)
<span class='fu'>setPop</span>(<span class='no'>Aeut.sub</span>) <span class='kw'>&lt;-</span> ~<span class='no'>Pop</span>/<span class='no'>Subpop</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Cannot set the population from an empty strata</span></div><div class='input'>
<span class='co'># Plot respective to the subpopulation structure</span>
<span class='no'>As.msn</span> <span class='kw'>&lt;-</span> <span class='fu'>poppr.msn</span>(<span class='no'>Aeut.sub</span>, <span class='no'>A.dist</span>, <span class='kw'>gadj</span><span class='kw'>=</span><span class='fl'>15</span>, <span class='kw'>vertex.label</span><span class='kw'>=</span><span class='fl'>NA</span>)</div><div class='img'><img src='poppr.msn-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Show only the structure of the Athena population.</span>
<span class='no'>As.msn</span> <span class='kw'>&lt;-</span> <span class='fu'>poppr.msn</span>(<span class='no'>Aeut.sub</span>, <span class='no'>A.dist</span>, <span class='kw'>gadj</span><span class='kw'>=</span><span class='fl'>15</span>, <span class='kw'>vertex.label</span><span class='kw'>=</span><span class='fl'>NA</span>, <span class='kw'>sublist</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>10</span>)</div><div class='img'><img src='poppr.msn-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Let's look at the structure of the microbov data set</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='st'>"igraph"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>microbov</span>)
<span class='no'>micro.dist</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='diss.dist.html'>diss.dist</a></span>(<span class='no'>microbov</span>, <span class='kw'>percent</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>micro.msn</span> <span class='kw'>&lt;-</span> <span class='fu'>poppr.msn</span>(<span class='no'>microbov</span>, <span class='no'>micro.dist</span>, <span class='kw'>vertex.label</span><span class='kw'>=</span><span class='fl'>NA</span>)</div><div class='img'><img src='poppr.msn-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Let's plot it and show where individuals have &lt; 15% of their genotypes </span>
<span class='co'># different.</span>

<span class='no'>edge_weight</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/igraph/topics/E'>E</a></span>(<span class='no'>micro.msn</span>$<span class='no'>graph</span>)$<span class='no'>weight</span>
<span class='no'>edge_labels</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/ifelse'>ifelse</a></span>(<span class='no'>edge_weight</span> <span class='kw'>&lt;</span> <span class='fl'>0.15</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>edge_weight</span>, <span class='fl'>3</span>), <span class='fl'>NA</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/igraph/topics/plot.igraph'>plot.igraph</a></span>(<span class='no'>micro.msn</span>$<span class='no'>graph</span>, <span class='kw'>edge.label</span> <span class='kw'>=</span> <span class='no'>edge_labels</span>, <span class='kw'>vertex.size</span> <span class='kw'>=</span> <span class='fl'>2</span>,
<span class='kw'>edge.label.color</span> <span class='kw'>=</span> <span class='st'>"red"</span>)</div><div class='img'><img src='poppr.msn-5.png' alt='' width='700' height='433' /></div><div class='input'>
</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Javier F. Tabima, Zhian N. Kamvar, Jonah C. Brooks</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

